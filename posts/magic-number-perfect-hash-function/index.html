<!doctype html><html lang="en" data-mode="dark"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="theme-color" media="(prefers-color-scheme: light)" content="#f7f7f7"><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1b1b1e"><meta name="mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="black-translucent"><meta name="viewport" content="width=device-width, user-scalable=no initial-scale=1, shrink-to-fit=no, viewport-fit=cover" ><meta name="generator" content="Jekyll v4.3.4" /><meta property="og:title" content="Magic Number Perfect Hash Function" /><meta property="og:locale" content="en" /><meta name="description" content="In this post we’ll look at how to use magic numbers to create a perfect hash function for a set of Key Value pairs with Integer keys that is known a ahead of time." /><meta property="og:description" content="In this post we’ll look at how to use magic numbers to create a perfect hash function for a set of Key Value pairs with Integer keys that is known a ahead of time." /><link rel="canonical" href="/posts/magic-number-perfect-hash-function/" /><meta property="og:url" content="/posts/magic-number-perfect-hash-function/" /><meta property="og:site_name" content="Node Security" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2023-08-15T20:08:48+10:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="Magic Number Perfect Hash Function" /><meta name="twitter:site" content="@todo" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2024-10-03T21:08:22+10:00","datePublished":"2023-08-15T20:08:48+10:00","description":"In this post we’ll look at how to use magic numbers to create a perfect hash function for a set of Key Value pairs with Integer keys that is known a ahead of time.","headline":"Magic Number Perfect Hash Function","mainEntityOfPage":{"@type":"WebPage","@id":"/posts/magic-number-perfect-hash-function/"},"url":"/posts/magic-number-perfect-hash-function/"}</script><title>Magic Number Perfect Hash Function | Node Security</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="Node Security"><meta name="application-name" content="Node Security"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="stylesheet" href="/assets/css/jekyll-theme-chirpy.css"><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.6.0/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/tocbot@4.29.0/dist/tocbot.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/loading-attribute-polyfill@2.1.1/dist/loading-attribute-polyfill.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/glightbox@3.3.0/dist/css/glightbox.min.css"><body><aside aria-label="Sidebar" id="sidebar" class="d-flex flex-column align-items-end"><header class="profile-wrapper"> <a href="/" id="avatar" class="rounded-circle"><img src="/assets/icon.webp" width="112" height="112" alt="avatar" onerror="this.style.display='none'"></a><h1 class="site-title"> <a href="/">Node Security</a></h1><p class="site-subtitle fst-italic mb-0">Security & Programming Guides</p></header><nav class="flex-column flex-grow-1 w-100 ps-0"><ul class="nav"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/tools/" class="nav-link"> <i class="fa-fw fas fa-tools"></i> <span>TOOLS</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tags"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle"></i> <span>ABOUT</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive"></i> <span>ARCHIVES</span> </a></ul></nav><div class="sidebar-bottom d-flex flex-wrap align-items-center w-100"> <a href="https://github.com/O1dMate" aria-label="github" target="_blank" rel="noopener noreferrer" > <i class="fab fa-github"></i> </a> <a href="https://twitter.com/todo" aria-label="twitter" target="_blank" rel="noopener noreferrer" > <i class="fa-brands fa-x-twitter"></i> </a> <a href="javascript:location.href = 'mailto:' + ['o1dmate','protonmail.com'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></aside><div id="main-wrapper" class="d-flex justify-content-center"><div class="container d-flex flex-column px-xxl-5"><header id="topbar-wrapper" aria-label="Top Bar"><div id="topbar" class="d-flex align-items-center justify-content-between px-lg-3 h-100" ><nav id="breadcrumb" aria-label="Breadcrumb"> <span> <a href="/">Home</a> </span> <span>Magic Number Perfect Hash Function</span></nav><button type="button" id="sidebar-trigger" class="btn btn-link"> <i class="fas fa-bars fa-fw"></i> </button><div id="topbar-title"> Post</div><button type="button" id="search-trigger" class="btn btn-link"> <i class="fas fa-search fa-fw"></i> </button> <search id="search" class="align-items-center ms-3 ms-lg-0"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..." > </search> <button type="button" class="btn btn-link text-decoration-none" id="search-cancel">Cancel</button></div></header><div class="row flex-grow-1"><main aria-label="Main Content" class="col-12 col-lg-11 col-xl-9 px-md-4"><article class="px-1"><header><h1 data-toc-skip>Magic Number Perfect Hash Function</h1><div class="post-meta text-muted"> <span> Posted <time data-ts="1692094128" data-df="ll" data-bs-toggle="tooltip" data-bs-placement="bottom" > Aug 15, 2023 </time> </span> <span> Updated <time data-ts="1727953702" data-df="ll" data-bs-toggle="tooltip" data-bs-placement="bottom" > Oct 3, 2024 </time> </span><div class="d-flex justify-content-between"> <span> By <em> <a href="https://twitter.com/todo">Alexander Wells</a> </em> </span><div> <span class="readtime" data-bs-toggle="tooltip" data-bs-placement="bottom" title="1936 words" > <em>10 min</em> read</span></div></div></div></header><div class="content"><p>In this post we’ll look at how to use magic numbers to create a perfect hash function for a set of Key Value pairs with Integer keys that is known a ahead of time.</p><p>We’ll assume that we are using 64-bit integers as the keys in our Key Value pairs.</p><ol><li><a href="#the-problem">The Problem</a><ul><li><a href="#standard-hash-table">Standard Hash Table</a><li><a href="#using-magic-numbers">Using Magic Numbers</a></ul><li><a href="#calculating-magic-numbers">Calculating Magic Numbers</a><ul><li><a href="#example">Example</a><li><a href="#searching-for-a-magic-number">Searching for a Magic Number</a><li><a href="#important-note">Important Note</a></ul><li><a href="#javascript-code">JavaScript Code</a><li><a href="#rust-multi-threaded-code">Rust Multi-Threaded Code</a></ol><p><br /></p><h1 id="the-problem">The Problem</h1><p>Our goal is to create a perfect hash function (no collisions) for a set of data that is known ahead of time and will not change. Put another way, we will insert the data into Hash Table at the start, and only ever perform lookups after that.</p><p>While standard Hash Table implementations can do this, the hash function they use needs to be general purpose. This isn’t ideal for when we care about performance.</p><p>We don’t want a general purpose hash function since we know all keys ahead of time. We want to avoid using an expensive and slow general purpose hash function.</p><h2 id="standard-hash-table"><span class="me-2">Standard Hash Table</span><a href="#standard-hash-table" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>Let’s say we have the following Key Value pair <code class="language-plaintext highlighter-rouge">(6019811509317997855, 20)</code>. Using a normal Hash Table the value retrieval process would look something like this behind the scenes:</p><ul><li>Hash the key using the general hash function.<li>Use the resulting Hash as an index for an Array that contains all the values.</ul><p>This example skips over the many ways the internals of a Hash Table can work and ways collisions are dealt with (Linear/Quadratic Probing, Double hashing, Separate Chaining, Cuckoo hashing, etc), but that isn’t important because we’ll avoid that with Magic Numbers.</p><h2 id="using-magic-numbers"><span class="me-2">Using Magic Numbers</span><a href="#using-magic-numbers" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>Here is how the value retrieval process would work if we used a Magic Number:</p><ul><li>Multiply the Key by the Magic Number and shift the result <code class="language-plaintext highlighter-rouge">N</code> bits to the right.<li>Use this value as an index for an Array that contains all the values.</ul><p>The new hash function now consists entirely of a single multiplication and shift operation.</p><p>However, the obvious question is what is the Magic Number and what is the value of <code class="language-plaintext highlighter-rouge">N</code>?</p><p>The answer is that they are values such that the above procedure works for every key in our known set of data and will never produce a collision. The rest of this post will explain how to calculate these values for a known set of data.</p><p><br /></p><h1 id="calculating-magic-numbers">Calculating Magic Numbers</h1><p>Below is a set of data with 5 Key Value pairs. Note that this can work perfectly fine for thousands of keys, although will require more memory and take longer to find better magic numbers.</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre>6019811509317997855 =&gt; 20
8863454925401798656 =&gt; 40
13735527195181205504 =&gt; 60
10620837929843658752 =&gt; 80
5503223162953909248 =&gt; 100
</pre></table></code></div></div><ul><li>Key =&gt; Value</ul><p>First off, let’s see how many bits we need to represent the index into our Array of values. As there are 5 keys, we’ll need 3-bits. More generally, we’ll need the smallest power of 2 that is larger than the number of keys we have.</p><ul><li>2^2 = 4, which is less than 5. Therefore 2 bits <strong>ISN’T</strong> enough<li>2^3 = 8, which is greater than or equal to 5. Therefore 3 bits <strong>IS</strong> enough.</ul><h2 id="example"><span class="me-2">Example</span><a href="#example" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>We said above that 3-bits is enough to represent all the indices into our Array of values. This means that said Array would be 2^3 = 8 elements in size.</p><p>So how do we go from the Key to a unique 3-bit value? Like this:</p><ul><li>Find a magic number such that the first 3-bits are unique for every (Key * Magic Number)</ul><p><code class="language-plaintext highlighter-rouge">15567010318032385463</code> is an example of such a magic number. Below is the result of each Key multiplied by the Magic Number. The result is shown in binary with the overflow truncated:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre>6019811509317997855  * 15567010318032385463 = 0000100110111101110000001101110010101000110010001000010000101001
8863454925401798656  * 15567010318032385463 = 1100010010111001011010110001100000111000110010011000100000000000
13735527195181205504 * 15567010318032385463 = 0011010111111001111111010010000001001000001011010111100000000000
10620837929843658752 * 15567010318032385463 = 1111000010111010101110110100010100110111100010111111000000000000
5503223162953909248  * 15567010318032385463 = 0101111000100000101000111101011101101110110001110001110000000000
</pre></table></code></div></div><p>Notice the first 3-bits of each result. They are all unique. Because we only care about these 3-bits, we’ll shift the result all the way to the right (64 - 3 = 61) so we only have these 3-bits left.</p><p>After right shifting by 61 we are left with the following:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre>(6019811509317997855  * 15567010318032385463) &gt;&gt; 61 = 000 = 0
(8863454925401798656  * 15567010318032385463) &gt;&gt; 61 = 110 = 6
(13735527195181205504 * 15567010318032385463) &gt;&gt; 61 = 001 = 1
(10620837929843658752 * 15567010318032385463) &gt;&gt; 61 = 111 = 7
(5503223162953909248  * 15567010318032385463) &gt;&gt; 61 = 010 = 2
</pre></table></code></div></div><p>The resulting values (0, 6, 1, 7, 2) are the indices we would use in the Array of values.</p><p>E.g. for the above Key <code class="language-plaintext highlighter-rouge">10620837929843658752</code> its value would be stored at the 7th position of the value Array.</p><p>If we want to perform a insert or lookup for a certain Key, this is what the pseudocode would look like:</p><div class="language-javascript highlighter-rouge"><div class="code-header"> <span data-label-text="JavaScript"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
</pre><td class="rouge-code"><pre><span class="kd">const</span> <span class="nx">MAGIC_NUMBER</span> <span class="o">=</span> <span class="mi">10620837929843658752</span><span class="p">;</span>
<span class="kd">const</span> <span class="nx">BITS_USED</span> <span class="o">=</span> <span class="mi">3</span><span class="p">;</span>
<span class="kd">const</span> <span class="nx">N</span> <span class="o">=</span> <span class="mi">64</span> <span class="o">-</span> <span class="nx">BITS_USED</span><span class="p">;</span>
<span class="kd">const</span> <span class="nx">VALUE_ARRAY</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Array</span><span class="p">(</span><span class="mi">2</span> <span class="o">**</span> <span class="nx">BITS_USED</span><span class="p">);</span>

<span class="kd">function</span> <span class="nf">InsertValue</span><span class="p">(</span><span class="nx">KEY</span><span class="p">,</span> <span class="nx">VALUE</span><span class="p">)</span> <span class="p">{</span>
	<span class="nx">VALUE_ARRAY</span><span class="p">[(</span><span class="nx">MAGIC_NUMBER</span> <span class="o">*</span> <span class="nx">KEY</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="nx">N</span><span class="p">]</span> <span class="o">=</span> <span class="nx">VALUE</span><span class="p">;</span>
<span class="p">}</span>

<span class="kd">function</span> <span class="nf">GetValueFromKey</span><span class="p">(</span><span class="nx">KEY</span><span class="p">)</span> <span class="p">{</span>
	<span class="k">return</span> <span class="nx">VALUE_ARRAY</span><span class="p">[(</span><span class="nx">MAGIC_NUMBER</span> <span class="o">*</span> <span class="nx">KEY</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="nx">N</span><span class="p">];</span>
<span class="p">}</span>
</pre></table></code></div></div><h2 id="searching-for-a-magic-number"><span class="me-2">Searching for a Magic Number</span><a href="#searching-for-a-magic-number" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>The final question is how the above magic number was found? The answer is simple. Brute Force search.</p><p>We need to generate and test random numbers until we find one that doesn’t produce collisions (duplicate indices after the multiplication and shift).</p><h2 id="important-note"><span class="me-2">Important Note</span><a href="#important-note" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>For the above example only 5 keys were used and 3-bits is the minimum amount needed. If instead we had 5000 keys, we would need a minimum of 13-bits (2^13 = 8192). Because there are so many keys, it’s very unlikely to find a magic number that gives unique 13-bit values. To get around this, it’s better to start by using many more bits than required, and once a valid magic number is found, search for another that is 1-bit less.</p><p>Ideally we want to use the least bits possible since it reduces the size of the value Array we need to create. Every bit less we use means the value Array is half the size.</p><p><br /></p><h1 id="javascript-code">JavaScript Code</h1><p>Some notes on the below code:</p><ul><li>Because there is no 64-bit integer in JavaScript we need to perform an AND operation after we perform the multiplication of the Key and Magic Number.<li>On line 16 a random prime number is generated for the magic number. This isn’t required, and a pseudo random number can be used.</ul><p>The code starts of by using 31 bits for the value Array, then progressively lowers it until a magic number using the minimum amount of bits is used, or until a certain amount of Iterations has passed.</p><div class="language-javascript highlighter-rouge"><div class="code-header"> <span data-label-text="JavaScript"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
</pre><td class="rouge-code"><pre><span class="kd">const</span> <span class="nx">crypto</span> <span class="o">=</span> <span class="nf">require</span><span class="p">(</span><span class="dl">'</span><span class="s1">crypto</span><span class="dl">'</span><span class="p">);</span>

<span class="kd">const</span> <span class="nx">BIG_VALUES</span> <span class="o">=</span> <span class="p">[</span>
	<span class="mi">6019811509317997855</span><span class="nx">n</span><span class="p">,</span>
	<span class="mi">8863454925401798656</span><span class="nx">n</span><span class="p">,</span>
	<span class="mi">13735527195181205504</span><span class="nx">n</span><span class="p">,</span>
	<span class="mi">10620837929843658752</span><span class="nx">n</span><span class="p">,</span>
	<span class="mi">5503223162953909248</span><span class="nx">n</span><span class="p">,</span>
<span class="p">];</span>

<span class="kd">const</span> <span class="nx">MIN_NUMBER_OF_BITS</span> <span class="o">=</span> <span class="nx">BIG_VALUES</span><span class="p">.</span><span class="nx">length</span><span class="p">.</span><span class="nf">toString</span><span class="p">(</span><span class="mi">2</span><span class="p">).</span><span class="nx">length</span><span class="p">;</span>
<span class="kd">const</span> <span class="nx">MAX_NUMBER_OF_BITS</span> <span class="o">=</span> <span class="mi">64</span><span class="p">;</span>
<span class="kd">const</span> <span class="nx">MAX_BIT_MASK</span> <span class="o">=</span> <span class="nc">BigInt</span><span class="p">(</span><span class="dl">'</span><span class="s1">0b</span><span class="dl">'</span> <span class="o">+</span> <span class="p">(</span><span class="k">new</span> <span class="nc">Array</span><span class="p">(</span><span class="nx">MAX_NUMBER_OF_BITS</span><span class="p">)).</span><span class="nf">fill</span><span class="p">(</span><span class="mi">1</span><span class="p">).</span><span class="nf">join</span><span class="p">(</span><span class="dl">''</span><span class="p">));</span>

<span class="kd">function</span> <span class="nf">FindMagicNumberV1</span><span class="p">(</span><span class="nx">outputNumberBitSize</span><span class="p">)</span> <span class="p">{</span>
	<span class="kd">const</span> <span class="nx">magicNum</span> <span class="o">=</span> <span class="nx">crypto</span><span class="p">.</span><span class="nf">generatePrimeSync</span><span class="p">(</span><span class="nx">MAX_NUMBER_OF_BITS</span><span class="p">,</span> <span class="p">{</span><span class="na">bigint</span><span class="p">:</span> <span class="kc">true</span><span class="p">})</span>

	<span class="kd">const</span> <span class="nx">mappedNumbers</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Set</span><span class="p">();</span>
	<span class="kd">let</span> <span class="nx">isValid</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>

	<span class="k">for </span><span class="p">(</span><span class="kd">let</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">BIG_VALUES</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="o">++</span><span class="nx">i</span><span class="p">)</span> <span class="p">{</span>
		<span class="kd">let</span> <span class="nx">currentNumber</span> <span class="o">=</span> <span class="p">((</span><span class="nx">BIG_VALUES</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span><span class="o">*</span><span class="nx">magicNum</span><span class="p">)</span> <span class="o">&amp;</span> <span class="nx">MAX_BIT_MASK</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="p">(</span><span class="mi">64</span><span class="nx">n</span> <span class="o">-</span> <span class="nc">BigInt</span><span class="p">(</span><span class="nx">outputNumberBitSize</span><span class="p">));</span>

		<span class="k">if </span><span class="p">(</span><span class="nx">mappedNumbers</span><span class="p">.</span><span class="nf">has</span><span class="p">(</span><span class="nx">currentNumber</span><span class="p">))</span> <span class="p">{</span>
			<span class="nx">isValid</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>
			<span class="k">break</span><span class="p">;</span>
		<span class="p">}</span>

		<span class="nx">mappedNumbers</span><span class="p">.</span><span class="nf">add</span><span class="p">(</span><span class="nx">currentNumber</span><span class="p">);</span>
	<span class="p">}</span>

	<span class="k">if </span><span class="p">(</span><span class="nx">isValid</span><span class="p">)</span> <span class="k">return</span> <span class="p">{</span>
		<span class="na">magicNumber</span><span class="p">:</span> <span class="nx">magicNum</span><span class="p">,</span>
		<span class="na">bitsUsed</span><span class="p">:</span> <span class="nx">outputNumberBitSize</span><span class="p">,</span>
	<span class="p">};</span>

	<span class="k">return</span> <span class="p">{</span> <span class="na">bitsUsed</span><span class="p">:</span> <span class="nb">Number</span><span class="p">.</span><span class="nx">MAX_SAFE_INTEGER</span> <span class="p">};</span>
<span class="p">}</span>

<span class="kd">let</span> <span class="nx">bestSoFar</span> <span class="o">=</span> <span class="p">{</span><span class="na">bitsUsed</span><span class="p">:</span> <span class="mi">32</span><span class="p">};</span>

<span class="k">for </span><span class="p">(</span><span class="kd">let</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="mi">100</span><span class="nx">_000_000</span><span class="p">;</span> <span class="o">++</span><span class="nx">i</span><span class="p">)</span> <span class="p">{</span>
	<span class="kd">const</span> <span class="nx">result</span> <span class="o">=</span> <span class="nc">FindMagicNumberV1</span><span class="p">(</span><span class="nx">bestSoFar</span><span class="p">.</span><span class="nx">bitsUsed</span> <span class="o">-</span> <span class="mi">1</span><span class="p">);</span>

	<span class="k">if </span><span class="p">(</span><span class="nx">result</span><span class="p">.</span><span class="nx">bitsUsed</span> <span class="o">&lt;</span> <span class="nx">bestSoFar</span><span class="p">.</span><span class="nx">bitsUsed</span><span class="p">)</span> <span class="p">{</span>
		<span class="nx">bestSoFar</span> <span class="o">=</span> <span class="nx">result</span><span class="p">;</span>
		<span class="nx">console</span><span class="p">.</span><span class="nf">log</span><span class="p">(</span><span class="dl">'</span><span class="s1">Best Found:</span><span class="dl">'</span><span class="p">,</span> <span class="nx">result</span><span class="p">);</span>
	<span class="p">}</span>

	<span class="k">if </span><span class="p">(</span><span class="nx">bestSoFar</span><span class="p">.</span><span class="nx">bitsUsed</span> <span class="o">===</span> <span class="nx">MIN_NUMBER_OF_BITS</span><span class="p">)</span> <span class="k">break</span><span class="p">;</span>
<span class="p">}</span>
</pre></table></code></div></div><p>The above code outputs the following:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
</pre><td class="rouge-code"><pre>Best Found: { magicNumber: 16098184039384438879n, bitsUsed: 31 }
Best Found: { magicNumber: 16325008153248595037n, bitsUsed: 30 }
Best Found: { magicNumber: 14368020153527046023n, bitsUsed: 29 }
Best Found: { magicNumber: 14621349544756933247n, bitsUsed: 28 }
Best Found: { magicNumber: 16540598574663265171n, bitsUsed: 27 }
Best Found: { magicNumber: 16228696490751924887n, bitsUsed: 26 }
Best Found: { magicNumber: 15100991816352779023n, bitsUsed: 25 }
Best Found: { magicNumber: 17324609008676439523n, bitsUsed: 24 }
Best Found: { magicNumber: 18256656583194581291n, bitsUsed: 23 }
Best Found: { magicNumber: 14520756546626378681n, bitsUsed: 22 }
Best Found: { magicNumber: 16048184102540498231n, bitsUsed: 21 }
Best Found: { magicNumber: 14838936919325713043n, bitsUsed: 20 }
Best Found: { magicNumber: 18217564146616633613n, bitsUsed: 19 }
Best Found: { magicNumber: 15466474175171765107n, bitsUsed: 18 }
Best Found: { magicNumber: 17960607931469292029n, bitsUsed: 17 }
Best Found: { magicNumber: 13931438973861982927n, bitsUsed: 16 }
Best Found: { magicNumber: 15085174118877062041n, bitsUsed: 15 }
Best Found: { magicNumber: 13841881654513396591n, bitsUsed: 14 }
Best Found: { magicNumber: 16802910703276585081n, bitsUsed: 13 }
Best Found: { magicNumber: 15454353913613611463n, bitsUsed: 12 }
Best Found: { magicNumber: 17444997694547404823n, bitsUsed: 11 }
Best Found: { magicNumber: 15415669514167943959n, bitsUsed: 10 }
Best Found: { magicNumber: 14189095924298317387n, bitsUsed: 9 }
Best Found: { magicNumber: 16644222002049844057n, bitsUsed: 8 }
Best Found: { magicNumber: 17759411055761750099n, bitsUsed: 7 }
Best Found: { magicNumber: 17934313906907920303n, bitsUsed: 6 }
Best Found: { magicNumber: 18241549279352968841n, bitsUsed: 5 }
Best Found: { magicNumber: 17266648670371355939n, bitsUsed: 4 }
Best Found: { magicNumber: 18006623335312784483n, bitsUsed: 3 }
</pre></table></code></div></div><p><br /></p><h1 id="rust-multi-threaded-code">Rust Multi-Threaded Code</h1><p>The below code uses 12 Threads to find a magic number. Each thread will start at a specified number of bits, search for a magic number, and when found, lower the bit count by 1.</p><div class="language-rust highlighter-rouge"><div class="code-header"> <span data-label-text="Rust"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
</pre><td class="rouge-code"><pre><span class="k">use</span> <span class="nn">std</span><span class="p">::</span><span class="nn">collections</span><span class="p">::</span><span class="n">BTreeSet</span><span class="p">;</span>
<span class="k">use</span> <span class="nn">rand</span><span class="p">::{</span><span class="n">Rng</span><span class="p">,</span> <span class="nn">rngs</span><span class="p">::</span><span class="n">ThreadRng</span><span class="p">};</span>
<span class="k">use</span> <span class="nn">std</span><span class="p">::</span><span class="n">thread</span><span class="p">;</span>

<span class="k">static</span> <span class="n">BIG_VALUES</span><span class="p">:</span> <span class="p">[</span><span class="nb">u64</span><span class="p">;</span> <span class="mi">5</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span>
	<span class="mi">6019811509317997855</span><span class="p">,</span>
	<span class="mi">8863454925401798656</span><span class="p">,</span>
	<span class="mi">13735527195181205504</span><span class="p">,</span>
	<span class="mi">10620837929843658752</span><span class="p">,</span>
	<span class="mi">5503223162953909248</span><span class="p">,</span>
<span class="p">];</span>

<span class="k">fn</span> <span class="nf">generate_magic_number</span><span class="p">(</span><span class="n">rng</span><span class="p">:</span> <span class="o">&amp;</span><span class="k">mut</span> <span class="n">ThreadRng</span><span class="p">,</span> <span class="n">bits_to_use</span><span class="p">:</span> <span class="nb">u8</span><span class="p">)</span> <span class="k">-&gt;</span> <span class="nb">u64</span> <span class="p">{</span>
    <span class="k">let</span> <span class="n">magic_number</span><span class="p">:</span> <span class="nb">u64</span> <span class="o">=</span> <span class="n">rng</span><span class="py">.gen</span><span class="p">::</span><span class="o">&lt;</span><span class="nb">u64</span><span class="o">&gt;</span><span class="p">();</span>

    <span class="k">let</span> <span class="k">mut</span> <span class="n">mapped_numbers</span><span class="p">:</span> <span class="n">BTreeSet</span><span class="o">&lt;</span><span class="nb">u64</span><span class="o">&gt;</span> <span class="o">=</span> <span class="nn">BTreeSet</span><span class="p">::</span><span class="nf">new</span><span class="p">();</span>

    <span class="k">for</span> <span class="n">i</span> <span class="k">in</span> <span class="mi">0</span><span class="o">..</span><span class="n">BIG_VALUES</span><span class="nf">.len</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">let</span> <span class="n">current_mapped_number</span> <span class="o">=</span> <span class="p">(</span><span class="n">BIG_VALUES</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">*</span> <span class="n">magic_number</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="p">(</span><span class="mi">64</span> <span class="o">-</span> <span class="n">bits_to_use</span><span class="p">);</span>

        <span class="k">if</span> <span class="n">mapped_numbers</span><span class="nf">.contains</span><span class="p">(</span><span class="o">&amp;</span><span class="n">current_mapped_number</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
        <span class="p">}</span>

        <span class="n">mapped_numbers</span><span class="nf">.insert</span><span class="p">(</span><span class="n">current_mapped_number</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="k">return</span> <span class="n">magic_number</span><span class="p">;</span>
<span class="p">}</span>


<span class="k">fn</span> <span class="nf">main</span><span class="p">()</span> <span class="p">{</span>
	<span class="nd">println!</span><span class="p">(</span><span class="s">""</span><span class="p">);</span>

	<span class="k">let</span> <span class="n">num_of_threads</span> <span class="o">=</span> <span class="mi">12</span><span class="p">;</span>
	<span class="k">let</span> <span class="k">mut</span> <span class="n">handles</span> <span class="o">=</span> <span class="nd">vec!</span><span class="p">[];</span>

	<span class="k">for</span> <span class="n">_</span> <span class="k">in</span> <span class="mi">0</span><span class="o">..</span><span class="n">num_of_threads</span> <span class="p">{</span>
		<span class="k">let</span> <span class="n">handle</span> <span class="o">=</span> <span class="nn">thread</span><span class="p">::</span><span class="nf">spawn</span><span class="p">(||</span> <span class="p">{</span>
			<span class="k">let</span> <span class="k">mut</span> <span class="n">rng</span> <span class="o">=</span> <span class="nn">rand</span><span class="p">::</span><span class="nf">thread_rng</span><span class="p">();</span>
			
			<span class="k">let</span> <span class="n">min_bits</span><span class="p">:</span> <span class="nb">u8</span> <span class="o">=</span> <span class="mi">3</span><span class="p">;</span>
			<span class="k">let</span> <span class="k">mut</span> <span class="n">bits</span><span class="p">:</span> <span class="nb">u8</span> <span class="o">=</span> <span class="mi">3</span><span class="p">;</span>
			<span class="k">let</span> <span class="k">mut</span> <span class="n">result</span><span class="p">:</span> <span class="nb">u64</span><span class="p">;</span>
		
			<span class="k">for</span> <span class="n">_</span> <span class="k">in</span> <span class="mi">0</span><span class="o">..</span><span class="mi">1_000_000_000</span> <span class="p">{</span>
				<span class="n">result</span> <span class="o">=</span> <span class="nf">generate_magic_number</span><span class="p">(</span><span class="o">&amp;</span><span class="k">mut</span> <span class="n">rng</span><span class="p">,</span> <span class="n">bits</span><span class="p">);</span>
			
				<span class="k">if</span> <span class="n">result</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="p">{</span>
					<span class="nd">println!</span><span class="p">(</span><span class="s">"Magic Number: ({}), Bits Used ({})"</span><span class="p">,</span> <span class="n">result</span><span class="p">,</span> <span class="n">bits</span><span class="p">);</span>
					<span class="n">bits</span> <span class="o">-=</span> <span class="mi">1</span><span class="p">;</span>

					<span class="k">if</span> <span class="n">bits</span> <span class="o">&lt;</span> <span class="n">min_bits</span> <span class="p">{</span> <span class="k">break</span><span class="p">;</span> <span class="p">}</span>
				<span class="p">}</span>
			<span class="p">}</span>
		<span class="p">});</span>

		<span class="n">handles</span><span class="nf">.push</span><span class="p">(</span><span class="n">handle</span><span class="p">);</span>
	<span class="p">}</span>

	<span class="k">for</span> <span class="n">handle</span> <span class="k">in</span> <span class="n">handles</span> <span class="p">{</span>
		<span class="n">handle</span><span class="nf">.join</span><span class="p">()</span><span class="nf">.unwrap</span><span class="p">();</span>
	<span class="p">}</span>

	<span class="nd">println!</span><span class="p">(</span><span class="s">"All Threads Completed."</span><span class="p">);</span>
<span class="p">}</span>
</pre></table></code></div></div><p>The above code outputs the following:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
</pre><td class="rouge-code"><pre>Magic Number: (7769583043006980941), Bits Used (3)
Magic Number: (16132918982763439544), Bits Used (3)
Magic Number: (16488419013824544368), Bits Used (3)
Magic Number: (12623179947970322489), Bits Used (3)
Magic Number: (12178518977004148095), Bits Used (3)
Magic Number: (15227566936866480215), Bits Used (3)
Magic Number: (3179281196491962013), Bits Used (3)
Magic Number: (17380414587344683173), Bits Used (3)
Magic Number: (9619816875933123805), Bits Used (3)
Magic Number: (5377167397578549298), Bits Used (3)
Magic Number: (2337733146222928516), Bits Used (3)
Magic Number: (10068657740713211807), Bits Used (3)
All Threads Completed.
</pre></table></code></div></div></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw me-1"></i> <a href="/categories/programming/">programming</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw me-1"></i> <a href="/tags/programming/" class="post-tag no-text-decoration" >programming</a> <a href="/tags/javascript/" class="post-tag no-text-decoration" >javascript</a> <a href="/tags/rust/" class="post-tag no-text-decoration" >rust</a></div><div class=" post-tail-bottom d-flex justify-content-between align-items-center mt-5 pb-2 " ><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper d-flex align-items-center"> <span class="share-label text-muted">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Magic%20Number%20Perfect%20Hash%20Function%20-%20Node%20Security&url=%2Fposts%2Fmagic-number-perfect-hash-function%2F" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Twitter" aria-label="Twitter"> <i class="fa-fw fa-brands fa-square-x-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=Magic%20Number%20Perfect%20Hash%20Function%20-%20Node%20Security&u=%2Fposts%2Fmagic-number-perfect-hash-function%2F" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Facebook" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://t.me/share/url?url=%2Fposts%2Fmagic-number-perfect-hash-function%2F&text=Magic%20Number%20Perfect%20Hash%20Function%20-%20Node%20Security" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Telegram" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <button id="copy-link" aria-label="Copy link" class="btn small" data-bs-toggle="tooltip" data-bs-placement="top" title="Copy link" data-title-succeed="Link copied successfully!" > <i class="fa-fw fas fa-link pe-none fs-6"></i> </button> </span></div></div></div></article></main><aside aria-label="Panel" id="panel-wrapper" class="col-xl-3 ps-2 mb-5 text-muted"><div class="access"><section id="access-lastmod"><h2 class="panel-heading">Recently Updated</h2><ul class="content list-unstyled ps-0 pb-1 ms-1 mt-2"><li class="text-truncate lh-lg"> <a href="/posts/pdf-combine/">PDF Combiner</a><li class="text-truncate lh-lg"> <a href="/posts/json-parse-and-filter/">JSON Parse & Filter</a><li class="text-truncate lh-lg"> <a href="/posts/password-word-list-generator/">Password Word List Generator</a><li class="text-truncate lh-lg"> <a href="/posts/rust-cheatsheet/">Rust Cheatsheet</a><li class="text-truncate lh-lg"> <a href="/posts/breaking-out-of-windows-environments/">Breaking out of Windows Environments</a></ul></section><section><h2 class="panel-heading">Trending Tags</h2><div class="d-flex flex-wrap mt-3 mb-1 me-3"> <a class="post-tag btn btn-outline-primary" href="/tags/security/">security</a> <a class="post-tag btn btn-outline-primary" href="/tags/javascript/">javascript</a> <a class="post-tag btn btn-outline-primary" href="/tags/cryptography/">cryptography</a> <a class="post-tag btn btn-outline-primary" href="/tags/web/">web</a> <a class="post-tag btn btn-outline-primary" href="/tags/http/">http</a> <a class="post-tag btn btn-outline-primary" href="/tags/https/">https</a> <a class="post-tag btn btn-outline-primary" href="/tags/programming/">programming</a> <a class="post-tag btn btn-outline-primary" href="/tags/algorithm/">algorithm</a> <a class="post-tag btn btn-outline-primary" href="/tags/windows/">windows</a> <a class="post-tag btn btn-outline-primary" href="/tags/nodejs/">nodejs</a></div></section></div><section id="toc-wrapper" class="d-none ps-0 pe-4"><h2 class="panel-heading ps-3 mb-2">Contents</h2><nav id="toc"></nav></section></aside></div><div class="row"><div id="tail-wrapper" class="col-12 col-lg-11 col-xl-9 px-md-4"><aside id="related-posts" aria-labelledby="related-label"><h3 class="mb-4" id="related-label">Further Reading</h3><nav class="row row-cols-1 row-cols-md-2 row-cols-xl-3 g-4 mb-4"><article class="col"> <a href="/posts/android-hooking-in-frida/" class="post-preview card h-100"><div class="card-body"> <time data-ts="1635517141" data-df="ll" > Oct 30, 2021 </time><h4 class="pt-0 my-2">Android Hooking in Frida</h4><div class="text-muted"><p>Intro guide on how to use Frida to hook Android applications at runtime to inject code and override methods. This guide already assumes you have frida installed and have frida-server installed on y...</p></div></div></a></article><article class="col"> <a href="/posts/frida-for-ios/" class="post-preview card h-100"><div class="card-body"> <time data-ts="1642143158" data-df="ll" > Jan 14, 2022 </time><h4 class="pt-0 my-2">Frida for iOS</h4><div class="text-muted"><p>Introductory guide on how to use Frida to analyse iOS applications at runtime to perform actions such as search for methods, hook methods, view &amp;amp; modify instructions, and view &amp;amp; modify regi...</p></div></div></a></article><article class="col"> <a href="/posts/rust-cheatsheet/" class="post-preview card h-100"><div class="card-body"> <time data-ts="1713003973" data-df="ll" > Apr 13, 2024 </time><h4 class="pt-0 my-2">Rust Cheatsheet</h4><div class="text-muted"><p>Useful Rust snippets and example code for commonly used patterns and features.</p></div></div></a></article></nav></aside><nav class="post-navigation d-flex justify-content-between" aria-label="Post Navigation"> <a href="/posts/proxmark3-mifare-classic-reading-and-cloning/" class="btn btn-outline-primary" aria-label="Older" ><p>Proxmark3 MIFARE Classic Reading and Cloning</p></a> <a href="/posts/rust-cheatsheet/" class="btn btn-outline-primary" aria-label="Newer" ><p>Rust Cheatsheet</p></a></nav><footer aria-label="Site Info" class=" d-flex flex-column justify-content-center text-muted flex-lg-row justify-content-lg-between align-items-lg-center pb-lg-3 " ><p>© <time>2025</time> <a href="https://twitter.com/todo">Alexander Wells</a>. <span data-bs-toggle="tooltip" data-bs-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author." >Some rights reserved.</span></p><p>Using the <a data-bs-toggle="tooltip" data-bs-placement="top" title="v7.1.1" href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener" >Chirpy</a> theme for <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a>.</p></footer></div></div><div id="search-result-wrapper" class="d-flex justify-content-center d-none"><div class="col-11 content"><div id="search-hints"><section><h2 class="panel-heading">Trending Tags</h2><div class="d-flex flex-wrap mt-3 mb-1 me-3"> <a class="post-tag btn btn-outline-primary" href="/tags/security/">security</a> <a class="post-tag btn btn-outline-primary" href="/tags/javascript/">javascript</a> <a class="post-tag btn btn-outline-primary" href="/tags/cryptography/">cryptography</a> <a class="post-tag btn btn-outline-primary" href="/tags/web/">web</a> <a class="post-tag btn btn-outline-primary" href="/tags/http/">http</a> <a class="post-tag btn btn-outline-primary" href="/tags/https/">https</a> <a class="post-tag btn btn-outline-primary" href="/tags/programming/">programming</a> <a class="post-tag btn btn-outline-primary" href="/tags/algorithm/">algorithm</a> <a class="post-tag btn btn-outline-primary" href="/tags/windows/">windows</a> <a class="post-tag btn btn-outline-primary" href="/tags/nodejs/">nodejs</a></div></section></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><aside aria-label="Scroll to Top"> <button id="back-to-top" type="button" class="btn btn-lg btn-box-shadow"> <i class="fas fa-angle-up"></i> </button></aside></div><div id="mask"></div><aside id="notification" class="toast" role="alert" aria-live="assertive" aria-atomic="true" data-bs-animation="true" data-bs-autohide="false" ><div class="toast-header"> <button type="button" class="btn-close ms-auto" data-bs-dismiss="toast" aria-label="Close" ></button></div><div class="toast-body text-center pt-0"><p class="px-2 mb-3">A new version of content is available.</p><button type="button" class="btn btn-primary" aria-label="Update"> Update </button></div></aside><script src="https://cdn.jsdelivr.net/combine/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js,npm/loading-attribute-polyfill@2.1.1/dist/loading-attribute-polyfill.umd.min.js,npm/glightbox@3.3.0/dist/js/glightbox.min.js,npm/clipboard@2.0.11/dist/clipboard.min.js,npm/dayjs@1.11.13/dayjs.min.js,npm/dayjs@1.11.13/locale/en.js,npm/dayjs@1.11.13/plugin/relativeTime.js,npm/dayjs@1.11.13/plugin/localizedFormat.js,npm/tocbot@4.29.0/dist/tocbot.min.js"></script> <script src="/assets/js/dist/post.min.js"></script> <script defer src="/app.min.js?baseurl=&register=true" ></script> <script>SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<article class="px-1 px-sm-2 px-lg-4 px-xl-0"><header><h2><a href="{url}">{title}</a></h2><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div></header><p>{snippet}</p></article>', noResultsText: '<p class="mt-5">Oops! No results found.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="me-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script>
