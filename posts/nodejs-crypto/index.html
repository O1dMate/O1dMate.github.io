<!DOCTYPE html><html lang="en-US" mode="dark" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="pv-cache-enabled" content="false"><meta name="generator" content="Jekyll v4.2.0" /><meta property="og:title" content="NodeJS Crypto Module" /><meta property="og:locale" content="en_US" /><meta name="description" content="In this post we’ll look at how to use some features of the crypto library built into NodeJS. We’ll look at how to do symmetric encryption (AES), hashing strings and files, and finally ECDH (Elliptic-Curve Diffie-Hellman)." /><meta property="og:description" content="In this post we’ll look at how to use some features of the crypto library built into NodeJS. We’ll look at how to do symmetric encryption (AES), hashing strings and files, and finally ECDH (Elliptic-Curve Diffie-Hellman)." /><link rel="canonical" href="https://node-security.com/posts/nodejs-crypto/" /><meta property="og:url" content="https://node-security.com/posts/nodejs-crypto/" /><meta property="og:site_name" content="Node Security" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2021-04-06T18:37:40+10:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="NodeJS Crypto Module" /><meta name="twitter:site" content="@twitter_username" /><meta name="google-site-verification" content="zCs6F-1y95azrfcOnbFvS60JAILGGXaeG4vY1-JFacs" /> <script type="application/ld+json"> {"url":"https://node-security.com/posts/nodejs-crypto/","@type":"BlogPosting","headline":"NodeJS Crypto Module","dateModified":"2021-04-06T18:37:40+10:00","datePublished":"2021-04-06T18:37:40+10:00","description":"In this post we’ll look at how to use some features of the crypto library built into NodeJS. We’ll look at how to do symmetric encryption (AES), hashing strings and files, and finally ECDH (Elliptic-Curve Diffie-Hellman).","mainEntityOfPage":{"@type":"WebPage","@id":"https://node-security.com/posts/nodejs-crypto/"},"@context":"https://schema.org"}</script><title>NodeJS Crypto Module | Node Security</title><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico" type="image/x-icon"><link rel="icon" href="/assets/img/favicons/favicon.ico" type="image/x-icon"><link rel="apple-touch-icon" href="/assets/img/favicons/apple-icon.png"><link rel="apple-touch-icon" href="/assets/img/favicons/apple-icon-precomposed.png"><link rel="apple-touch-icon" sizes="57x57" href="/assets/img/favicons/apple-icon-57x57.png"><link rel="apple-touch-icon" sizes="60x60" href="/assets/img/favicons/apple-icon-60x60.png"><link rel="apple-touch-icon" sizes="72x72" href="/assets/img/favicons/apple-icon-72x72.png"><link rel="apple-touch-icon" sizes="76x76" href="/assets/img/favicons/apple-icon-76x76.png"><link rel="apple-touch-icon" sizes="114x114" href="/assets/img/favicons/apple-icon-114x114.png"><link rel="apple-touch-icon" sizes="120x120" href="/assets/img/favicons/apple-icon-120x120.png"><link rel="apple-touch-icon" sizes="144x144" href="/assets/img/favicons/apple-icon-144x144.png"><link rel="apple-touch-icon" sizes="152x152" href="/assets/img/favicons/apple-icon-152x152.png"><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-icon-180x180.png"><link rel="icon" type="image/png" sizes="192x192" href="/assets/img/favicons/android-icon-192x192.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="96x96" href="/assets/img/favicons/favicon-96x96.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/manifest.json"><meta name='msapplication-config' content='/assets/img/favicons/browserconfig.xml'><meta name="msapplication-TileColor" content="#ffffff"><meta name="msapplication-TileImage" content="/assets/img/favicons/ms-icon-144x144.png"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://fonts.gstatic.com"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="preconnect" href="cdn.jsdelivr.net"><link rel="dns-prefetch" href="cdn.jsdelivr.net"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css" integrity="sha256-LA89z+k9fjgMKQ/kq4OO2Mrf8VltYml/VES+Rg0fh20=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css" integrity="sha256-+N4/V/SbAFiW1MPBCXnfnP9QSN3+Keu+NlB+0ev/YKQ=" crossorigin="anonymous"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script> <script defer src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.15.0,npm/bootstrap@4/dist/js/bootstrap.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script defer src="/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id=G-RCTP6RS6T4"></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', 'G-RCTP6RS6T4'); }); </script><body data-spy="scroll" data-target="#toc"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> <img src="/assets/icon.png" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">Node Security</a></div><div class="site-subtitle font-italic">Security & Programming Guides</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tags ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center"> <a href="https://github.com/O1dMate" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github-alt"></i> </a> <a href="https://twitter.com/twitter_username" aria-label="twitter" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['o1dmate','protonmail.com'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></div><div id="topbar-wrapper" class="row justify-content-center topbar-down"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Posts </a> </span> <span>NodeJS Crypto Module</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" placeholder="Search..."> <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="post-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>NodeJS Crypto Module</h1><div class="post-meta text-muted d-flex flex-column"><div> <span class="semi-bold"> Alexander Wells </span> <span class="timeago " data-toggle="tooltip" data-placement="bottom" title="Tue, Apr 6, 2021, 6:37 PM +1000" prep="on" > Apr 6 <i class="unloaded">2021-04-06T18:37:40+10:00</i> </span></div><div> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="874 words">4 min</span></div></div><div class="post-content"><p>In this post we’ll look at how to use some features of the <code class="language-plaintext highlighter-rouge">crypto</code> library built into NodeJS. We’ll look at how to do symmetric encryption (AES), hashing strings and files, and finally ECDH (Elliptic-Curve Diffie-Hellman).</p><ol><li><a href="#symmetric-encryption">Symmetric Encryption</a><ul><li><a href="#supported-ciphers">List Supported Ciphers</a><li><a href="#encrypt-string-with-aes-128-ecb">Encrypt String with AES-128-ECB</a><li><a href="#encrypt-string-with-aes-256-cbc">Encrypt String with AES-256-CBC</a><li><a href="#encrypt-string-with-aes-256-gcm">Encrypt String with AES-256-GCM</a></ul><li><a href="#hash-functions">Hash Functions</a><ul><li><a href="#hash-functions">List Supported Hash Functions</a><li><a href="#hashing-a-string-example">Hashing a String Example</a><li><a href="#hashing-a-file-example">Hashing a File Example</a></ul><li><a href="#elliptic-curve-diffie-hellman">Elliptic-Curve Diffie-Hellman</a><ul><li><a href="#supported-curves">List Supported Curves</a><li><a href="#ecdh-example">ECDH Example</a></ul></ol><h1 id="symmetric-encryption">Symmetric Encryption</h1><p>For a quick refresher, Symmetric Encryption is when only a single key is used. The same key is used for both encryption and decryption of the data.</p><h2 id="supported-ciphers">Supported Ciphers</h2><p>We can see which ciphers are supported in NodeJS by using the following code:</p><div class="language-javascript highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre><span class="kd">const</span> <span class="nx">crypto</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="dl">'</span><span class="s1">crypto</span><span class="dl">'</span><span class="p">);</span>  
  
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">crypto</span><span class="p">.</span><span class="nx">getCiphers</span><span class="p">());</span>  
</pre></table></code></div></div><p><code class="language-plaintext highlighter-rouge">crypto.getCiphers()</code> returns a list of strings of all the ciphers that are supported. From the list we’ll choose <code class="language-plaintext highlighter-rouge">aes-256-ctr</code>. Let’s now see how to encrypt &amp; decrypt some data using our chosen mode.</p><h2 id="encrypt-string-with-aes-128-ecb">Encrypt String with AES-128-ECB</h2><div class="language-javascript highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
</pre><td class="rouge-code"><pre><span class="kd">const</span> <span class="nx">crypto</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="dl">'</span><span class="s1">crypto</span><span class="dl">'</span><span class="p">);</span>

<span class="kd">let</span> <span class="nx">key</span> <span class="o">=</span> <span class="nx">Buffer</span><span class="p">.</span><span class="k">from</span><span class="p">(</span><span class="dl">'</span><span class="s1">ABCDEFGHIJKLMNOP</span><span class="dl">'</span><span class="p">,</span> <span class="dl">'</span><span class="s1">utf-8</span><span class="dl">'</span><span class="p">);</span>

<span class="c1">// The Secret Message</span>
<span class="kd">let</span> <span class="nx">secret_msg</span> <span class="o">=</span> <span class="nx">Buffer</span><span class="p">.</span><span class="k">from</span><span class="p">(</span><span class="dl">'</span><span class="s1">To be Encrypted!</span><span class="dl">'</span><span class="p">,</span> <span class="dl">'</span><span class="s1">utf-8</span><span class="dl">'</span><span class="p">);</span>

<span class="c1">// Encrypt</span>
<span class="kd">let</span> <span class="nx">cipher</span> <span class="o">=</span> <span class="nx">crypto</span><span class="p">.</span><span class="nx">createCipheriv</span><span class="p">(</span><span class="dl">'</span><span class="s1">aes-128-ecb</span><span class="dl">'</span><span class="p">,</span> <span class="nx">key</span><span class="p">,</span> <span class="kc">null</span><span class="p">);</span>
<span class="kd">let</span> <span class="nx">encryptedData</span> <span class="o">=</span> <span class="nx">Buffer</span><span class="p">.</span><span class="nx">concat</span><span class="p">([</span><span class="nx">cipher</span><span class="p">.</span><span class="nx">update</span><span class="p">(</span><span class="nx">secret_msg</span><span class="p">),</span> <span class="nx">cipher</span><span class="p">.</span><span class="nx">final</span><span class="p">()]);</span>

<span class="c1">// Decrypt</span>
<span class="kd">let</span> <span class="nx">decipher</span> <span class="o">=</span> <span class="nx">crypto</span><span class="p">.</span><span class="nx">createDecipheriv</span><span class="p">(</span><span class="dl">'</span><span class="s1">aes-128-ecb</span><span class="dl">'</span><span class="p">,</span> <span class="nx">key</span><span class="p">,</span> <span class="kc">null</span><span class="p">);</span>
<span class="kd">let</span> <span class="nx">decryptedData</span> <span class="o">=</span> <span class="nx">Buffer</span><span class="p">.</span><span class="nx">concat</span><span class="p">([</span><span class="nx">decipher</span><span class="p">.</span><span class="nx">update</span><span class="p">(</span><span class="nx">encryptedData</span><span class="p">),</span> <span class="nx">decipher</span><span class="p">.</span><span class="nx">final</span><span class="p">()]);</span>

<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">`\nEncryption Key: </span><span class="p">${</span><span class="nx">key</span><span class="p">.</span><span class="nx">toString</span><span class="p">(</span><span class="dl">'</span><span class="s1">hex</span><span class="dl">'</span><span class="p">)}</span><span class="s2">`</span><span class="p">)</span>

<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">`Plain-text: \t"</span><span class="p">${</span><span class="nx">secret_msg</span><span class="p">}</span><span class="s2">"`</span><span class="p">);</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">`Plain-text: \t</span><span class="p">${</span><span class="nx">secret_msg</span><span class="p">.</span><span class="nx">toString</span><span class="p">(</span><span class="dl">'</span><span class="s1">hex</span><span class="dl">'</span><span class="p">)}</span><span class="s2">`</span><span class="p">);</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">`Encrypted: \t</span><span class="p">${</span><span class="nx">encryptedData</span><span class="p">.</span><span class="nx">toString</span><span class="p">(</span><span class="dl">'</span><span class="s1">hex</span><span class="dl">'</span><span class="p">)}</span><span class="s2">`</span><span class="p">);</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">`Encrypted: \t</span><span class="p">${</span><span class="nx">encryptedData</span><span class="p">.</span><span class="nx">toString</span><span class="p">(</span><span class="dl">'</span><span class="s1">base64</span><span class="dl">'</span><span class="p">)}</span><span class="s2">`</span><span class="p">);</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">`Decrypted: \t</span><span class="p">${</span><span class="nx">decryptedData</span><span class="p">.</span><span class="nx">toString</span><span class="p">(</span><span class="dl">'</span><span class="s1">hex</span><span class="dl">'</span><span class="p">)}</span><span class="s2">`</span><span class="p">);</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">`Decrypted: \t"</span><span class="p">${</span><span class="nx">decryptedData</span><span class="p">.</span><span class="nx">toString</span><span class="p">(</span><span class="dl">'</span><span class="s1">utf-8</span><span class="dl">'</span><span class="p">)}</span><span class="s2">"`</span><span class="p">);</span>
</pre></table></code></div></div><ul><li>This is just an example, please don’t ever use ECB in practice.</ul><h2 id="encrypt-string-with-aes-256-cbc">Encrypt String with AES-256-CBC</h2><div class="language-javascript highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
</pre><td class="rouge-code"><pre><span class="kd">const</span> <span class="nx">crypto</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="dl">'</span><span class="s1">crypto</span><span class="dl">'</span><span class="p">);</span>

<span class="kd">let</span> <span class="nx">key</span> <span class="o">=</span> <span class="nx">Buffer</span><span class="p">.</span><span class="k">from</span><span class="p">(</span><span class="dl">'</span><span class="s1">ABCDEFGHIJKLMNOPabcdefghijklmnop</span><span class="dl">'</span><span class="p">,</span> <span class="dl">'</span><span class="s1">utf-8</span><span class="dl">'</span><span class="p">);</span>
<span class="kd">let</span> <span class="nx">iv</span> <span class="o">=</span> <span class="nx">Buffer</span><span class="p">.</span><span class="k">from</span><span class="p">(</span><span class="dl">'</span><span class="s1">000102030405060708090a0b0c0d0e0f</span><span class="dl">'</span><span class="p">,</span> <span class="dl">'</span><span class="s1">hex</span><span class="dl">'</span><span class="p">);</span>

<span class="c1">// The Secret Message</span>
<span class="kd">let</span> <span class="nx">secret_msg</span> <span class="o">=</span> <span class="nx">Buffer</span><span class="p">.</span><span class="k">from</span><span class="p">(</span><span class="dl">'</span><span class="s1">To be Encrypted!</span><span class="dl">'</span><span class="p">,</span> <span class="dl">'</span><span class="s1">utf-8</span><span class="dl">'</span><span class="p">);</span>

<span class="c1">// Encrypt</span>
<span class="kd">let</span> <span class="nx">cipher</span> <span class="o">=</span> <span class="nx">crypto</span><span class="p">.</span><span class="nx">createCipheriv</span><span class="p">(</span><span class="dl">'</span><span class="s1">aes-256-cbc</span><span class="dl">'</span><span class="p">,</span> <span class="nx">key</span><span class="p">,</span> <span class="nx">iv</span><span class="p">);</span>
<span class="kd">let</span> <span class="nx">encryptedData</span> <span class="o">=</span> <span class="nx">Buffer</span><span class="p">.</span><span class="nx">concat</span><span class="p">([</span><span class="nx">cipher</span><span class="p">.</span><span class="nx">update</span><span class="p">(</span><span class="nx">secret_msg</span><span class="p">),</span> <span class="nx">cipher</span><span class="p">.</span><span class="nx">final</span><span class="p">()]);</span>

<span class="c1">// Decrypt</span>
<span class="kd">let</span> <span class="nx">decipher</span> <span class="o">=</span> <span class="nx">crypto</span><span class="p">.</span><span class="nx">createDecipheriv</span><span class="p">(</span><span class="dl">'</span><span class="s1">aes-256-cbc</span><span class="dl">'</span><span class="p">,</span> <span class="nx">key</span><span class="p">,</span> <span class="nx">iv</span><span class="p">);</span>
<span class="kd">let</span> <span class="nx">decryptedData</span> <span class="o">=</span> <span class="nx">Buffer</span><span class="p">.</span><span class="nx">concat</span><span class="p">([</span><span class="nx">decipher</span><span class="p">.</span><span class="nx">update</span><span class="p">(</span><span class="nx">encryptedData</span><span class="p">),</span> <span class="nx">decipher</span><span class="p">.</span><span class="nx">final</span><span class="p">()]);</span>

<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">`\nEncryption Key: </span><span class="p">${</span><span class="nx">key</span><span class="p">.</span><span class="nx">toString</span><span class="p">(</span><span class="dl">'</span><span class="s1">hex</span><span class="dl">'</span><span class="p">)}</span><span class="s2">`</span><span class="p">)</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">`IV: \t\t</span><span class="p">${</span><span class="nx">iv</span><span class="p">.</span><span class="nx">toString</span><span class="p">(</span><span class="dl">'</span><span class="s1">hex</span><span class="dl">'</span><span class="p">)}</span><span class="s2">\n`</span><span class="p">)</span>

<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">`Plain-text: \t"</span><span class="p">${</span><span class="nx">secret_msg</span><span class="p">}</span><span class="s2">"`</span><span class="p">);</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">`Plain-text: \t</span><span class="p">${</span><span class="nx">secret_msg</span><span class="p">.</span><span class="nx">toString</span><span class="p">(</span><span class="dl">'</span><span class="s1">hex</span><span class="dl">'</span><span class="p">)}</span><span class="s2">`</span><span class="p">);</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">`Encrypted: \t</span><span class="p">${</span><span class="nx">encryptedData</span><span class="p">.</span><span class="nx">toString</span><span class="p">(</span><span class="dl">'</span><span class="s1">hex</span><span class="dl">'</span><span class="p">)}</span><span class="s2">`</span><span class="p">);</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">`Encrypted: \t</span><span class="p">${</span><span class="nx">encryptedData</span><span class="p">.</span><span class="nx">toString</span><span class="p">(</span><span class="dl">'</span><span class="s1">base64</span><span class="dl">'</span><span class="p">)}</span><span class="s2">`</span><span class="p">);</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">`Decrypted: \t</span><span class="p">${</span><span class="nx">decryptedData</span><span class="p">.</span><span class="nx">toString</span><span class="p">(</span><span class="dl">'</span><span class="s1">hex</span><span class="dl">'</span><span class="p">)}</span><span class="s2">`</span><span class="p">);</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">`Decrypted: \t"</span><span class="p">${</span><span class="nx">decryptedData</span><span class="p">.</span><span class="nx">toString</span><span class="p">(</span><span class="dl">'</span><span class="s1">utf-8</span><span class="dl">'</span><span class="p">)}</span><span class="s2">"`</span><span class="p">);</span>
</pre></table></code></div></div><h2 id="encrypt-string-with-aes-256-gcm">Encrypt String with AES-256-GCM</h2><div class="language-javascript highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
</pre><td class="rouge-code"><pre><span class="kd">const</span> <span class="nx">crypto</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="dl">'</span><span class="s1">crypto</span><span class="dl">'</span><span class="p">);</span>

<span class="kd">let</span> <span class="nx">key</span> <span class="o">=</span> <span class="nx">Buffer</span><span class="p">.</span><span class="k">from</span><span class="p">(</span><span class="dl">'</span><span class="s1">ABCDEFGHIJKLMNOPabcdefghijklmnop</span><span class="dl">'</span><span class="p">,</span> <span class="dl">'</span><span class="s1">utf-8</span><span class="dl">'</span><span class="p">);</span>
<span class="kd">let</span> <span class="nx">iv</span> <span class="o">=</span> <span class="nx">Buffer</span><span class="p">.</span><span class="k">from</span><span class="p">(</span><span class="dl">'</span><span class="s1">000102030405060708090a0b0c0d0e0f</span><span class="dl">'</span><span class="p">,</span> <span class="dl">'</span><span class="s1">hex</span><span class="dl">'</span><span class="p">);</span>
<span class="kd">let</span> <span class="nx">authTagLength</span> <span class="o">=</span> <span class="mi">16</span><span class="p">;</span>

<span class="c1">// The Secret Message</span>
<span class="kd">let</span> <span class="nx">secret_msg</span> <span class="o">=</span> <span class="nx">Buffer</span><span class="p">.</span><span class="k">from</span><span class="p">(</span><span class="dl">'</span><span class="s1">To be Encrypted!</span><span class="dl">'</span><span class="p">,</span> <span class="dl">'</span><span class="s1">utf-8</span><span class="dl">'</span><span class="p">);</span>

<span class="c1">// Encrypt</span>
<span class="kd">let</span> <span class="nx">cipher</span> <span class="o">=</span> <span class="nx">crypto</span><span class="p">.</span><span class="nx">createCipheriv</span><span class="p">(</span><span class="dl">'</span><span class="s1">aes-256-gcm</span><span class="dl">'</span><span class="p">,</span> <span class="nx">key</span><span class="p">,</span> <span class="nx">iv</span><span class="p">,</span> <span class="p">{</span> <span class="nx">authTagLength</span> <span class="p">});</span>
<span class="kd">let</span> <span class="nx">encryptedData</span> <span class="o">=</span> <span class="nx">Buffer</span><span class="p">.</span><span class="nx">concat</span><span class="p">([</span><span class="nx">cipher</span><span class="p">.</span><span class="nx">update</span><span class="p">(</span><span class="nx">secret_msg</span><span class="p">),</span> <span class="nx">cipher</span><span class="p">.</span><span class="nx">final</span><span class="p">(),</span> <span class="nx">cipher</span><span class="p">.</span><span class="nx">getAuthTag</span><span class="p">()]);</span>

<span class="c1">// Separate the encrypted data from the Auth Tag</span>
<span class="kd">let</span> <span class="nx">dataToDecrypt</span> <span class="o">=</span> <span class="nx">encryptedData</span><span class="p">.</span><span class="nx">slice</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nx">encryptedData</span><span class="p">.</span><span class="nx">length</span> <span class="o">-</span> <span class="nx">authTagLength</span><span class="p">);</span>
<span class="kd">let</span> <span class="nx">authTag</span> <span class="o">=</span> <span class="nx">encryptedData</span><span class="p">.</span><span class="nx">slice</span><span class="p">(</span><span class="nx">encryptedData</span><span class="p">.</span><span class="nx">length</span> <span class="o">-</span> <span class="nx">authTagLength</span><span class="p">,</span> <span class="nx">encryptedData</span><span class="p">.</span><span class="nx">length</span><span class="p">);</span>

<span class="c1">// Decrypt</span>
<span class="kd">let</span> <span class="nx">decipher</span> <span class="o">=</span> <span class="nx">crypto</span><span class="p">.</span><span class="nx">createDecipheriv</span><span class="p">(</span><span class="dl">'</span><span class="s1">aes-256-gcm</span><span class="dl">'</span><span class="p">,</span> <span class="nx">key</span><span class="p">,</span> <span class="nx">iv</span><span class="p">,</span> <span class="p">{</span> <span class="nx">authTagLength</span> <span class="p">});</span>
<span class="nx">decipher</span><span class="p">.</span><span class="nx">setAuthTag</span><span class="p">(</span><span class="nx">authTag</span><span class="p">);</span>
<span class="kd">let</span> <span class="nx">decryptedData</span> <span class="o">=</span> <span class="nx">Buffer</span><span class="p">.</span><span class="nx">concat</span><span class="p">([</span><span class="nx">decipher</span><span class="p">.</span><span class="nx">update</span><span class="p">(</span><span class="nx">dataToDecrypt</span><span class="p">),</span> <span class="nx">decipher</span><span class="p">.</span><span class="nx">final</span><span class="p">()]);</span>

<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">`\nEncryption Key: </span><span class="p">${</span><span class="nx">key</span><span class="p">.</span><span class="nx">toString</span><span class="p">(</span><span class="dl">'</span><span class="s1">hex</span><span class="dl">'</span><span class="p">)}</span><span class="s2">`</span><span class="p">)</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">`IV: \t\t</span><span class="p">${</span><span class="nx">iv</span><span class="p">.</span><span class="nx">toString</span><span class="p">(</span><span class="dl">'</span><span class="s1">hex</span><span class="dl">'</span><span class="p">)}</span><span class="s2">\n`</span><span class="p">)</span>

<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">`Plain-text: \t"</span><span class="p">${</span><span class="nx">secret_msg</span><span class="p">}</span><span class="s2">"`</span><span class="p">);</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">`Plain-text: \t</span><span class="p">${</span><span class="nx">secret_msg</span><span class="p">.</span><span class="nx">toString</span><span class="p">(</span><span class="dl">'</span><span class="s1">hex</span><span class="dl">'</span><span class="p">)}</span><span class="s2">`</span><span class="p">);</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">`Encrypted: \t</span><span class="p">${</span><span class="nx">encryptedData</span><span class="p">.</span><span class="nx">toString</span><span class="p">(</span><span class="dl">'</span><span class="s1">hex</span><span class="dl">'</span><span class="p">)}</span><span class="s2">`</span><span class="p">);</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">`Encrypted: \t</span><span class="p">${</span><span class="nx">encryptedData</span><span class="p">.</span><span class="nx">toString</span><span class="p">(</span><span class="dl">'</span><span class="s1">base64</span><span class="dl">'</span><span class="p">)}</span><span class="s2">`</span><span class="p">);</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">`Decrypted: \t</span><span class="p">${</span><span class="nx">decryptedData</span><span class="p">.</span><span class="nx">toString</span><span class="p">(</span><span class="dl">'</span><span class="s1">hex</span><span class="dl">'</span><span class="p">)}</span><span class="s2">`</span><span class="p">);</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">`Decrypted: \t"</span><span class="p">${</span><span class="nx">decryptedData</span><span class="p">.</span><span class="nx">toString</span><span class="p">(</span><span class="dl">'</span><span class="s1">utf-8</span><span class="dl">'</span><span class="p">)}</span><span class="s2">"`</span><span class="p">);</span>
</pre></table></code></div></div><p><br /></p><h1 id="hash-functions">Hash Functions</h1><h2 id="list-supported-hash-functions">List Supported Hash Functions</h2><p>We can see which hash functions are supported in NodeJS by using the following code:</p><div class="language-javascript highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre><span class="kd">const</span> <span class="nx">crypto</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="dl">'</span><span class="s1">crypto</span><span class="dl">'</span><span class="p">);</span>

<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">crypto</span><span class="p">.</span><span class="nx">getHashes</span><span class="p">());</span>
</pre></table></code></div></div><p><code class="language-plaintext highlighter-rouge">crypto.getHashes()</code> returns a list of strings of all the hash functions that are supported.</p><h2 id="hashing-a-string-example">Hashing a String Example</h2><div class="language-javascript highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
</pre><td class="rouge-code"><pre><span class="kd">const</span> <span class="nx">crypto</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="dl">'</span><span class="s1">crypto</span><span class="dl">'</span><span class="p">);</span>

<span class="c1">// String to be hashed</span>
<span class="kd">let</span> <span class="nx">msgToHash</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">Password1</span><span class="dl">'</span><span class="p">;</span>

<span class="c1">// Create Hash Functions</span>
<span class="kd">let</span> <span class="nx">MD4_HashFunction</span> <span class="o">=</span> <span class="nx">crypto</span><span class="p">.</span><span class="nx">createHash</span><span class="p">(</span><span class="dl">'</span><span class="s1">md4</span><span class="dl">'</span><span class="p">);</span>
<span class="kd">let</span> <span class="nx">NTLM_HashFunction</span> <span class="o">=</span> <span class="nx">crypto</span><span class="p">.</span><span class="nx">createHash</span><span class="p">(</span><span class="dl">'</span><span class="s1">md4</span><span class="dl">'</span><span class="p">);</span>
<span class="kd">let</span> <span class="nx">SHA256_HashFunction</span> <span class="o">=</span> <span class="nx">crypto</span><span class="p">.</span><span class="nx">createHash</span><span class="p">(</span><span class="dl">'</span><span class="s1">sha256</span><span class="dl">'</span><span class="p">);</span>
<span class="kd">let</span> <span class="nx">SHA3_256_HashFunction</span> <span class="o">=</span> <span class="nx">crypto</span><span class="p">.</span><span class="nx">createHash</span><span class="p">(</span><span class="dl">'</span><span class="s1">sha3-256</span><span class="dl">'</span><span class="p">);</span>

<span class="c1">// Add data to the hash function</span>
<span class="nx">MD4_HashFunction</span><span class="p">.</span><span class="nx">update</span><span class="p">(</span><span class="nx">msgToHash</span><span class="p">);</span>
<span class="nx">NTLM_HashFunction</span><span class="p">.</span><span class="nx">update</span><span class="p">(</span><span class="nx">Buffer</span><span class="p">.</span><span class="k">from</span><span class="p">(</span><span class="nx">msgToHash</span><span class="p">,</span> <span class="dl">'</span><span class="s1">utf16le</span><span class="dl">'</span><span class="p">));</span>
<span class="nx">SHA256_HashFunction</span><span class="p">.</span><span class="nx">update</span><span class="p">(</span><span class="nx">msgToHash</span><span class="p">);</span>
<span class="nx">SHA3_256_HashFunction</span><span class="p">.</span><span class="nx">update</span><span class="p">(</span><span class="nx">msgToHash</span><span class="p">);</span>

<span class="c1">// Get the result</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">'</span><span class="s1">MD4:</span><span class="se">\t\t</span><span class="dl">'</span><span class="p">,</span> <span class="nx">MD4_HashFunction</span><span class="p">.</span><span class="nx">digest</span><span class="p">(</span><span class="dl">'</span><span class="s1">hex</span><span class="dl">'</span><span class="p">));</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">'</span><span class="s1">NTLM:</span><span class="se">\t\t</span><span class="dl">'</span><span class="p">,</span> <span class="nx">NTLM_HashFunction</span><span class="p">.</span><span class="nx">digest</span><span class="p">(</span><span class="dl">'</span><span class="s1">hex</span><span class="dl">'</span><span class="p">));</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">'</span><span class="s1">SHA256:</span><span class="se">\t\t</span><span class="dl">'</span><span class="p">,</span> <span class="nx">SHA256_HashFunction</span><span class="p">.</span><span class="nx">digest</span><span class="p">(</span><span class="dl">'</span><span class="s1">hex</span><span class="dl">'</span><span class="p">));</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">'</span><span class="s1">SHA3-256:</span><span class="se">\t</span><span class="dl">'</span><span class="p">,</span> <span class="nx">SHA3_256_HashFunction</span><span class="p">.</span><span class="nx">digest</span><span class="p">(</span><span class="dl">'</span><span class="s1">hex</span><span class="dl">'</span><span class="p">));</span>
</pre></table></code></div></div><p>The <code class="language-plaintext highlighter-rouge">update</code> function can be called multiple times before getting the output hash. For example:</p><div class="language-javascript highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="nx">SHA256_HashFunction</span><span class="p">.</span><span class="nx">update</span><span class="p">(</span><span class="dl">"</span><span class="s2">Pass</span><span class="dl">"</span><span class="p">);</span>
<span class="nx">SHA256_HashFunction</span><span class="p">.</span><span class="nx">update</span><span class="p">(</span><span class="dl">"</span><span class="s2">word1</span><span class="dl">"</span><span class="p">);</span>
</pre></table></code></div></div><p>is the same as:</p><div class="language-javascript highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nx">SHA256_HashFunction</span><span class="p">.</span><span class="nx">update</span><span class="p">(</span><span class="dl">"</span><span class="s2">Password1</span><span class="dl">"</span><span class="p">);</span>
</pre></table></code></div></div><h2 id="hashing-a-file-example">Hashing a File Example</h2><div class="language-javascript highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
</pre><td class="rouge-code"><pre><span class="kd">const</span> <span class="nx">fs</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="dl">'</span><span class="s1">fs</span><span class="dl">'</span><span class="p">);</span>
<span class="kd">const</span> <span class="nx">path</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="dl">'</span><span class="s1">path</span><span class="dl">'</span><span class="p">);</span>
<span class="kd">const</span> <span class="nx">crypto</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="dl">'</span><span class="s1">crypto</span><span class="dl">'</span><span class="p">);</span>

<span class="c1">// Target file that we what to calculate the hash of</span>
<span class="kd">const</span> <span class="nx">targetFile</span> <span class="o">=</span> <span class="nx">path</span><span class="p">.</span><span class="nx">join</span><span class="p">(</span><span class="nx">__dirname</span><span class="p">,</span> <span class="dl">'</span><span class="s1">input-file.txt</span><span class="dl">'</span><span class="p">);</span>

<span class="c1">// Create Hash Function</span>
<span class="kd">const</span> <span class="nx">SHA256_HashFunction</span> <span class="o">=</span> <span class="nx">crypto</span><span class="p">.</span><span class="nx">createHash</span><span class="p">(</span><span class="dl">'</span><span class="s1">sha256</span><span class="dl">'</span><span class="p">);</span>
<span class="nx">SHA256_HashFunction</span><span class="p">.</span><span class="nx">setEncoding</span><span class="p">(</span><span class="dl">'</span><span class="s1">hex</span><span class="dl">'</span><span class="p">);</span>

<span class="c1">// Create a read stream with the target file</span>
<span class="kd">const</span> <span class="nx">inputFileStream</span> <span class="o">=</span> <span class="nx">fs</span><span class="p">.</span><span class="nx">createReadStream</span><span class="p">(</span><span class="nx">targetFile</span><span class="p">);</span>

<span class="c1">// Callback for when Hashing is complete</span>
<span class="nx">inputFileStream</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="dl">'</span><span class="s1">end</span><span class="dl">'</span><span class="p">,</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="nx">SHA256_HashFunction</span><span class="p">.</span><span class="nx">end</span><span class="p">();</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">SHA256_HashFunction</span><span class="p">.</span><span class="nx">read</span><span class="p">());</span>
<span class="p">});</span>

<span class="c1">// Read the file contents and pipe it into the hash object</span>
<span class="nx">inputFileStream</span><span class="p">.</span><span class="nx">pipe</span><span class="p">(</span><span class="nx">SHA256_HashFunction</span><span class="p">);</span>
</pre></table></code></div></div><p><br /></p><h1 id="elliptic-curve-diffie-hellman">Elliptic-Curve Diffie-Hellman</h1><h2 id="supported-curves">Supported Curves</h2><p>We can see which curves are supported in NodeJS by using the following code:</p><div class="language-javascript highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre><span class="kd">const</span> <span class="nx">crypto</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="dl">'</span><span class="s1">crypto</span><span class="dl">'</span><span class="p">);</span>

<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">crypto</span><span class="p">.</span><span class="nx">getCurves</span><span class="p">());</span>
</pre></table></code></div></div><p><code class="language-plaintext highlighter-rouge">crypto.getCurves()</code> returns a list of strings of all the elliptic curves that are supported. We’ll use the <code class="language-plaintext highlighter-rouge">sect571k1</code> curve in the below example.</p><h2 id="ecdh-example">ECDH Example</h2><div class="language-javascript highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
</pre><td class="rouge-code"><pre><span class="kd">const</span> <span class="nx">crypto</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="dl">'</span><span class="s1">crypto</span><span class="dl">'</span><span class="p">);</span>

<span class="kd">const</span> <span class="nx">alice</span> <span class="o">=</span> <span class="nx">crypto</span><span class="p">.</span><span class="nx">createECDH</span><span class="p">(</span><span class="dl">'</span><span class="s1">sect571k1</span><span class="dl">'</span><span class="p">);</span>
<span class="nx">alice</span><span class="p">.</span><span class="nx">generateKeys</span><span class="p">();</span>

<span class="kd">const</span> <span class="nx">bob</span> <span class="o">=</span> <span class="nx">crypto</span><span class="p">.</span><span class="nx">createECDH</span><span class="p">(</span><span class="dl">'</span><span class="s1">sect571k1</span><span class="dl">'</span><span class="p">);</span>
<span class="nx">bob</span><span class="p">.</span><span class="nx">generateKeys</span><span class="p">();</span>

<span class="c1">// Alice's Data</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">"</span><span class="se">\n</span><span class="s2">Alice Public:</span><span class="dl">"</span><span class="p">,</span> <span class="nx">alice</span><span class="p">.</span><span class="nx">getPublicKey</span><span class="p">().</span><span class="nx">toString</span><span class="p">(</span><span class="dl">'</span><span class="s1">base64</span><span class="dl">'</span><span class="p">));</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">"</span><span class="s2">Alice Private:</span><span class="dl">"</span><span class="p">,</span> <span class="nx">alice</span><span class="p">.</span><span class="nx">getPrivateKey</span><span class="p">().</span><span class="nx">toString</span><span class="p">(</span><span class="dl">'</span><span class="s1">base64</span><span class="dl">'</span><span class="p">),</span> <span class="dl">"</span><span class="se">\n</span><span class="dl">"</span><span class="p">);</span>

<span class="c1">// Bob's Data</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">"</span><span class="s2">Bob Public:</span><span class="dl">"</span><span class="p">,</span> <span class="nx">bob</span><span class="p">.</span><span class="nx">getPublicKey</span><span class="p">().</span><span class="nx">toString</span><span class="p">(</span><span class="dl">'</span><span class="s1">base64</span><span class="dl">'</span><span class="p">));</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">"</span><span class="s2">Bob Private:</span><span class="dl">"</span><span class="p">,</span> <span class="nx">bob</span><span class="p">.</span><span class="nx">getPrivateKey</span><span class="p">().</span><span class="nx">toString</span><span class="p">(</span><span class="dl">'</span><span class="s1">base64</span><span class="dl">'</span><span class="p">),</span> <span class="dl">"</span><span class="se">\n</span><span class="dl">"</span><span class="p">);</span>

<span class="c1">// The Shared Secret will be the same</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">"</span><span class="s2">Shared Secret: </span><span class="dl">"</span><span class="p">,</span> <span class="nx">alice</span><span class="p">.</span><span class="nx">computeSecret</span><span class="p">(</span><span class="nx">bob</span><span class="p">.</span><span class="nx">getPublicKey</span><span class="p">(),</span> <span class="kc">null</span><span class="p">,</span> <span class="dl">'</span><span class="s1">base64</span><span class="dl">'</span><span class="p">));</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">"</span><span class="s2">Shared Secret: </span><span class="dl">"</span><span class="p">,</span> <span class="nx">bob</span><span class="p">.</span><span class="nx">computeSecret</span><span class="p">(</span><span class="nx">alice</span><span class="p">.</span><span class="nx">getPublicKey</span><span class="p">(),</span> <span class="kc">null</span><span class="p">,</span> <span class="dl">'</span><span class="s1">base64</span><span class="dl">'</span><span class="p">),</span> <span class="dl">"</span><span class="se">\n</span><span class="dl">"</span><span class="p">);</span>
</pre></table></code></div></div></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/javascript/'>javascript</a>, <a href='/categories/nodejs/'>nodejs</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/javascript/" class="post-tag no-text-decoration" >javascript</a> <a href="/tags/nodejs/" class="post-tag no-text-decoration" >nodejs</a> <a href="/tags/security/" class="post-tag no-text-decoration" >security</a> <a href="/tags/cryptography/" class="post-tag no-text-decoration" >cryptography</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/">CC BY 4.0</a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=NodeJS Crypto Module - Node Security&url=https://node-security.com/posts/nodejs-crypto/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=NodeJS Crypto Module - Node Security&u=https://node-security.com/posts/nodejs-crypto/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://telegram.me/share?text=NodeJS Crypto Module - Node Security&url=https://node-security.com/posts/nodejs-crypto/" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i class="fa-fw fas fa-link small" onclick="copyLink()" data-toggle="tooltip" data-placement="top" title="Copy link"></i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted topbar-down"><div class="access"><div id="access-lastmod" class="post"> <span>Recent Update</span><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/javascript-tips-and-tricks-2/">JavaScript Tips & Tricks 2</a><li><a href="/posts/secure-electron-ipc/">Secure Electron IPC</a><li><a href="/posts/jwt-fuzzing/">JWT Fuzzing</a><li><a href="/posts/filter-and-map/">Filter and Map</a><li><a href="/posts/javascript-tips-and-tricks/">JavaScript Tips & Tricks</a></ul></div><div id="access-tags"> <span>Trending Tags</span><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/security/">security</a> <a class="post-tag" href="/tags/javascript/">javascript</a> <a class="post-tag" href="/tags/nodejs/">nodejs</a> <a class="post-tag" href="/tags/https/">https</a> <a class="post-tag" href="/tags/windows/">windows</a> <a class="post-tag" href="/tags/cryptography/">cryptography</a> <a class="post-tag" href="/tags/http/">http</a> <a class="post-tag" href="/tags/web/">web</a> <a class="post-tag" href="/tags/programming/">programming</a> <a class="post-tag" href="/tags/algorithm/">algorithm</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"> <span class="pl-3 pt-2 mb-2">Contents</span><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="post-extend-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/secure-electron-ipc/"><div class="card-body"> <span class="timeago small" > Aug 27 <i class="unloaded">2021-08-27T17:26:57+10:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Secure Electron IPC</h3><div class="text-muted small"><p> In this post we’ll look at how to do secure IPC (Inter-Process-Communication) in Electron. Why does it matter? The RCE Problem Server Side electron.js prel...</p></div></div></a></div><div class="card"> <a href="/posts/express-http-server/"><div class="card-body"> <span class="timeago small" > Apr 9 <i class="unloaded">2021-04-09T17:32:40+10:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>NodeJS Express HTTP Server</h3><div class="text-muted small"><p> In this post we’ll look at how to build a simple HTTP server in NodeJS using the express framework. Server Setup Required Packages Basic Setup Express Basics ...</p></div></div></a></div><div class="card"> <a href="/posts/express-https-server/"><div class="card-body"> <span class="timeago small" > Apr 10 <i class="unloaded">2021-04-10T12:30:07+10:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>NodeJS Express HTTPS Server</h3><div class="text-muted small"><p> In this post we’ll look at how to add TLS to an NodeJS express HTTP server. This post will assume that you already know how to setup a HTTP server using express. If you don’t know how to, you can ...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <span class="btn btn-outline-primary disabled" prompt="Older"><p>-</p></span> <a href="/posts/openssl-testing-cipher-suite/" class="btn btn-outline-primary" prompt="Newer"><p>OpenSSL Testing a Cipher Suite</p></a></div></div></div></div><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center"><div class="footer-left"><p class="mb-0"> © 2021 <a href="https://twitter.com/twitter_username">Alexander Wells</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><h4 class="text-muted mb-4">Trending Tags</h4><a class="post-tag" href="/tags/security/">security</a> <a class="post-tag" href="/tags/javascript/">javascript</a> <a class="post-tag" href="/tags/nodejs/">nodejs</a> <a class="post-tag" href="/tags/https/">https</a> <a class="post-tag" href="/tags/windows/">windows</a> <a class="post-tag" href="/tags/cryptography/">cryptography</a> <a class="post-tag" href="/tags/http/">http</a> <a class="post-tag" href="/tags/web/">web</a> <a class="post-tag" href="/tags/programming/">programming</a> <a class="post-tag" href="/tags/algorithm/">algorithm</a></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.7.3/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="https://node-security.com{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script>
