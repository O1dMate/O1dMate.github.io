<!doctype html><html lang="en" data-mode="dark"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="theme-color" media="(prefers-color-scheme: light)" content="#f7f7f7"><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1b1b1e"><meta name="mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="black-translucent"><meta name="viewport" content="width=device-width, user-scalable=no initial-scale=1, shrink-to-fit=no, viewport-fit=cover" ><meta name="generator" content="Jekyll v4.3.4" /><meta property="og:title" content="Docx Templating in JavaScript" /><meta property="og:locale" content="en" /><meta name="description" content="In this guide we’ll look at how to create a docx template and fill out that document using JavaScript. We’ll do this by using the docxtemplater package. This works in both NodeJS and React." /><meta property="og:description" content="In this guide we’ll look at how to create a docx template and fill out that document using JavaScript. We’ll do this by using the docxtemplater package. This works in both NodeJS and React." /><link rel="canonical" href="/posts/docx-templating-in-javascript/" /><meta property="og:url" content="/posts/docx-templating-in-javascript/" /><meta property="og:site_name" content="Node Security" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2021-04-30T14:10:46+10:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="Docx Templating in JavaScript" /><meta name="twitter:site" content="@todo" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2022-01-23T02:40:07+10:00","datePublished":"2021-04-30T14:10:46+10:00","description":"In this guide we’ll look at how to create a docx template and fill out that document using JavaScript. We’ll do this by using the docxtemplater package. This works in both NodeJS and React.","headline":"Docx Templating in JavaScript","mainEntityOfPage":{"@type":"WebPage","@id":"/posts/docx-templating-in-javascript/"},"url":"/posts/docx-templating-in-javascript/"}</script><title>Docx Templating in JavaScript | Node Security</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="Node Security"><meta name="application-name" content="Node Security"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="stylesheet" href="/assets/css/jekyll-theme-chirpy.css"><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.6.0/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/tocbot@4.29.0/dist/tocbot.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/loading-attribute-polyfill@2.1.1/dist/loading-attribute-polyfill.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/glightbox@3.3.0/dist/css/glightbox.min.css"><body><aside aria-label="Sidebar" id="sidebar" class="d-flex flex-column align-items-end"><header class="profile-wrapper"> <a href="/" id="avatar" class="rounded-circle"><img src="/assets/icon.webp" width="112" height="112" alt="avatar" onerror="this.style.display='none'"></a><h1 class="site-title"> <a href="/">Node Security</a></h1><p class="site-subtitle fst-italic mb-0">Security & Programming Guides</p></header><nav class="flex-column flex-grow-1 w-100 ps-0"><ul class="nav"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/tools/" class="nav-link"> <i class="fa-fw fas fa-tools"></i> <span>TOOLS</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tags"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle"></i> <span>ABOUT</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive"></i> <span>ARCHIVES</span> </a></ul></nav><div class="sidebar-bottom d-flex flex-wrap align-items-center w-100"> <a href="https://github.com/O1dMate" aria-label="github" target="_blank" rel="noopener noreferrer" > <i class="fab fa-github"></i> </a> <a href="https://twitter.com/todo" aria-label="twitter" target="_blank" rel="noopener noreferrer" > <i class="fa-brands fa-x-twitter"></i> </a> <a href="javascript:location.href = 'mailto:' + ['o1dmate','protonmail.com'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></aside><div id="main-wrapper" class="d-flex justify-content-center"><div class="container d-flex flex-column px-xxl-5"><header id="topbar-wrapper" aria-label="Top Bar"><div id="topbar" class="d-flex align-items-center justify-content-between px-lg-3 h-100" ><nav id="breadcrumb" aria-label="Breadcrumb"> <span> <a href="/">Home</a> </span> <span>Docx Templating in JavaScript</span></nav><button type="button" id="sidebar-trigger" class="btn btn-link"> <i class="fas fa-bars fa-fw"></i> </button><div id="topbar-title"> Post</div><button type="button" id="search-trigger" class="btn btn-link"> <i class="fas fa-search fa-fw"></i> </button> <search id="search" class="align-items-center ms-3 ms-lg-0"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..." > </search> <button type="button" class="btn btn-link text-decoration-none" id="search-cancel">Cancel</button></div></header><div class="row flex-grow-1"><main aria-label="Main Content" class="col-12 col-lg-11 col-xl-9 px-md-4"><article class="px-1"><header><h1 data-toc-skip>Docx Templating in JavaScript</h1><div class="post-meta text-muted"> <span> Posted <time data-ts="1619755846" data-df="ll" data-bs-toggle="tooltip" data-bs-placement="bottom" > Apr 30, 2021 </time> </span> <span> Updated <time data-ts="1642869607" data-df="ll" data-bs-toggle="tooltip" data-bs-placement="bottom" > Jan 23, 2022 </time> </span><div class="d-flex justify-content-between"> <span> By <em> <a href="https://twitter.com/todo">Alexander Wells</a> </em> </span><div> <span class="readtime" data-bs-toggle="tooltip" data-bs-placement="bottom" title="994 words" > <em>5 min</em> read</span></div></div></div></header><div class="content"><p>In this guide we’ll look at how to create a docx template and fill out that document using JavaScript. We’ll do this by using the <a href="https://www.npmjs.com/package/docxtemplater">docxtemplater</a> package. This works in both NodeJS and React.</p><ol><li><a href="#installing-requirements">Installing Requirements</a><li><a href="#the-code">The Code</a><li><a href="#filling-out-the-template-with-javascript">Filling out the Template with JavaScript</a><li><a href="#direct-values">Direct Values</a><li><a href="#styling">Styling</a><li><a href="#lists">Lists</a><li><a href="#table-rows">Table Rows</a><li><a href="#conditional-rendering">Conditional Rendering</a><li><a href="#helpful-tips">Helpful Tips</a><ul><li><a href="#too-much-spacing">Too Much Spacing</a><li><a href="#error-finding-1">Error Finding 1</a><li><a href="#error-finding-2">Error Finding 2</a><li><a href="#tag-names">Tag Names</a></ul></ol><h1 id="installing-requirements">Installing Requirements</h1><p>Install the <code class="language-plaintext highlighter-rouge">docxtemplater</code> &amp; <code class="language-plaintext highlighter-rouge">pizzip</code> packages using the following command:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>npm i docxtemplater pizzip
</pre></table></code></div></div><p><br /></p><h1 id="the-code">The Code</h1><p>The main code for all the below examples will stay the same. The only thing that will be changing is the <code class="language-plaintext highlighter-rouge">dataToAdd</code> Object (line 14). All other lines will stay the same.</p><div class="language-javascript highlighter-rouge"><div class="code-header"> <span data-label-text="JavaScript"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
</pre><td class="rouge-code"><pre><span class="kd">const</span> <span class="nx">fs</span> <span class="o">=</span> <span class="nf">require</span><span class="p">(</span><span class="dl">'</span><span class="s1">fs</span><span class="dl">'</span><span class="p">);</span>
<span class="kd">const</span> <span class="nx">path</span> <span class="o">=</span> <span class="nf">require</span><span class="p">(</span><span class="dl">'</span><span class="s1">path</span><span class="dl">'</span><span class="p">);</span>
<span class="kd">const</span> <span class="nx">PizZip</span> <span class="o">=</span> <span class="nf">require</span><span class="p">(</span><span class="dl">'</span><span class="s1">pizzip</span><span class="dl">'</span><span class="p">);</span>
<span class="kd">const</span> <span class="nx">Docxtemplater</span> <span class="o">=</span> <span class="nf">require</span><span class="p">(</span><span class="dl">'</span><span class="s1">docxtemplater</span><span class="dl">'</span><span class="p">);</span>

<span class="c1">// Load the templated docx file</span>
<span class="kd">const</span> <span class="nx">templateFile</span> <span class="o">=</span> <span class="nx">fs</span><span class="p">.</span><span class="nf">readFileSync</span><span class="p">(</span><span class="nx">path</span><span class="p">.</span><span class="nf">resolve</span><span class="p">(</span><span class="nx">__dirname</span><span class="p">,</span> <span class="dl">'</span><span class="s1">template.docx</span><span class="dl">'</span><span class="p">),</span> <span class="dl">'</span><span class="s1">binary</span><span class="dl">'</span><span class="p">);</span>
<span class="kd">const</span> <span class="nx">zip</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">PizZip</span><span class="p">(</span><span class="nx">templateFile</span><span class="p">);</span>

<span class="k">try</span> <span class="p">{</span>
	<span class="c1">// Attempt to read all the templated tags</span>
	<span class="kd">let</span> <span class="nx">outputDocument</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Docxtemplater</span><span class="p">(</span><span class="nx">zip</span><span class="p">);</span>

	<span class="kd">const</span> <span class="nx">dataToAdd</span> <span class="o">=</span> <span class="p">{};</span>

	<span class="c1">// Set the data we wish to add to the document</span>
	<span class="nx">outputDocument</span><span class="p">.</span><span class="nf">setData</span><span class="p">(</span><span class="nx">dataToAdd</span><span class="p">);</span>

	<span class="k">try</span> <span class="p">{</span>
		<span class="c1">// Attempt to render the document (Add data to the template)</span>
		<span class="nx">outputDocument</span><span class="p">.</span><span class="nf">render</span><span class="p">()</span>

		<span class="c1">// Create a buffer to store the output data</span>
		<span class="kd">let</span> <span class="nx">outputDocumentBuffer</span> <span class="o">=</span> <span class="nx">outputDocument</span><span class="p">.</span><span class="nf">getZip</span><span class="p">().</span><span class="nf">generate</span><span class="p">({</span> <span class="na">type</span><span class="p">:</span> <span class="dl">'</span><span class="s1">nodebuffer</span><span class="dl">'</span> <span class="p">});</span>

		<span class="c1">// Save the buffer to a file</span>
		<span class="nx">fs</span><span class="p">.</span><span class="nf">writeFileSync</span><span class="p">(</span><span class="nx">path</span><span class="p">.</span><span class="nf">resolve</span><span class="p">(</span><span class="nx">__dirname</span><span class="p">,</span> <span class="dl">'</span><span class="s1">OUTPUT.docx</span><span class="dl">'</span><span class="p">),</span> <span class="nx">outputDocumentBuffer</span><span class="p">);</span>
	<span class="p">}</span>
	<span class="k">catch </span><span class="p">(</span><span class="nx">error</span><span class="p">)</span> <span class="p">{</span>
		<span class="nx">console</span><span class="p">.</span><span class="nf">error</span><span class="p">(</span><span class="s2">`ERROR Filling out Template:`</span><span class="p">);</span>
		<span class="nx">console</span><span class="p">.</span><span class="nf">error</span><span class="p">(</span><span class="nx">error</span><span class="p">)</span>
	<span class="p">}</span>
<span class="p">}</span> <span class="k">catch</span><span class="p">(</span><span class="nx">error</span><span class="p">)</span> <span class="p">{</span>
	<span class="nx">console</span><span class="p">.</span><span class="nf">error</span><span class="p">(</span><span class="s2">`ERROR Loading Template:`</span><span class="p">);</span>
	<span class="nx">console</span><span class="p">.</span><span class="nf">error</span><span class="p">(</span><span class="nx">error</span><span class="p">);</span>
<span class="p">}</span>
</pre></table></code></div></div><p><br /></p><h1 id="filling-out-the-template-with-javascript">Filling out the Template with JavaScript</h1><p>All of the data that will be added to the template will be contained within a single Object called <code class="language-plaintext highlighter-rouge">dataToAdd</code>.</p><p>Each key in the <code class="language-plaintext highlighter-rouge">dataToAdd</code> Object refers to a tag that was placed in the docx file. Let’s see how to do this:</p><h1 id="direct-values">Direct Values</h1><p>Direct values simply mean static values that we wish to insert into the document. Some examples would be the date, author, title. Simple text values you wish to add that may change with each document.</p><h2 id="docx-file"><span class="me-2">Docx File</span><a href="#docx-file" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p><a href="/assets/programming/docx/docx-3.png" class="popup img-link shimmer"><img src="/assets/programming/docx/docx-3.png" alt="" loading="lazy"></a></p><h2 id="the-code-1"><span class="me-2">The Code</span><a href="#the-code-1" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><div class="language-javascript highlighter-rouge"><div class="code-header"> <span data-label-text="JavaScript"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre><span class="kd">const</span> <span class="nx">dataToAdd</span> <span class="o">=</span> <span class="p">{</span>
    <span class="na">document_creation_date</span><span class="p">:</span> <span class="p">(</span><span class="k">new</span> <span class="nc">Date</span><span class="p">()).</span><span class="nf">toLocaleDateString</span><span class="p">()</span>
<span class="p">};</span>
</pre></table></code></div></div><h2 id="results"><span class="me-2">Results</span><a href="#results" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p><a href="/assets/programming/docx/docx-4.png" class="popup img-link shimmer"><img src="/assets/programming/docx/docx-4.png" alt="" loading="lazy"></a></p><p><br /></p><h1 id="styling">Styling</h1><p>The style that is applied to the tag in the document will be inherited by the value that is inserted:</p><h2 id="docx-file-1"><span class="me-2">Docx File</span><a href="#docx-file-1" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p><a href="/assets/programming/docx/docx-5.png" class="popup img-link shimmer"><img src="/assets/programming/docx/docx-5.png" alt="" loading="lazy"></a></p><h2 id="the-code-2"><span class="me-2">The Code</span><a href="#the-code-2" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><div class="language-javascript highlighter-rouge"><div class="code-header"> <span data-label-text="JavaScript"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre><span class="kd">const</span> <span class="nx">dataToAdd</span> <span class="o">=</span> <span class="p">{</span>
    <span class="na">document_creation_date</span><span class="p">:</span> <span class="p">(</span><span class="k">new</span> <span class="nc">Date</span><span class="p">()).</span><span class="nf">toLocaleDateString</span><span class="p">(),</span>
    <span class="na">document_author</span><span class="p">:</span> <span class="dl">'</span><span class="s1">Alexander Wells</span><span class="dl">'</span><span class="p">,</span>
<span class="p">};</span>
</pre></table></code></div></div><h2 id="results-1"><span class="me-2">Results</span><a href="#results-1" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p><a href="/assets/programming/docx/docx-6.png" class="popup img-link shimmer"><img src="/assets/programming/docx/docx-6.png" alt="" loading="lazy"></a></p><p><br /></p><h1 id="lists">Lists</h1><p>A very useful feature is to be able to template repetitive sections. Perhaps the document is suppose to contain the profiles of some employees. Let’s see how we can use lists to do this:</p><h2 id="docx-file-2"><span class="me-2">Docx File</span><a href="#docx-file-2" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p><a href="/assets/programming/docx/docx-7.png" class="popup img-link shimmer"><img src="/assets/programming/docx/docx-7.png" alt="" loading="lazy"></a></p><ul><li>Lists are prefixed with the <code class="language-plaintext highlighter-rouge">#</code> character to start the list scope, and the <code class="language-plaintext highlighter-rouge">/</code> character to end the list scope.</ul><h2 id="the-code-3"><span class="me-2">The Code</span><a href="#the-code-3" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><div class="language-javascript highlighter-rouge"><div class="code-header"> <span data-label-text="JavaScript"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre><td class="rouge-code"><pre><span class="kd">const</span> <span class="nx">dataToAdd</span> <span class="o">=</span> <span class="p">{</span>
    <span class="na">employeeList</span><span class="p">:</span> <span class="p">[</span>
        <span class="p">{</span> <span class="na">id</span><span class="p">:</span> <span class="mi">28521</span><span class="p">,</span> <span class="na">name</span><span class="p">:</span> <span class="dl">'</span><span class="s1">Frank</span><span class="dl">'</span><span class="p">,</span> <span class="na">age</span><span class="p">:</span> <span class="mi">34</span><span class="p">,</span> <span class="na">city</span><span class="p">:</span> <span class="dl">'</span><span class="s1">Melbourne</span><span class="dl">'</span> <span class="p">},</span>
        <span class="p">{</span> <span class="na">id</span><span class="p">:</span> <span class="mi">84973</span><span class="p">,</span> <span class="na">name</span><span class="p">:</span> <span class="dl">'</span><span class="s1">Chloe</span><span class="dl">'</span><span class="p">,</span> <span class="na">age</span><span class="p">:</span> <span class="mi">28</span><span class="p">,</span> <span class="na">city</span><span class="p">:</span> <span class="dl">'</span><span class="s1">Perth</span><span class="dl">'</span> <span class="p">},</span>
    <span class="p">]</span>
<span class="p">};</span>
</pre></table></code></div></div><ul><li>When using lists, the value should be a list of Objects.<li>The keys of each Object will refer to the tags used inside the List in the docx file (id, name, age, city).</ul><h2 id="results-2"><span class="me-2">Results</span><a href="#results-2" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p><a href="/assets/programming/docx/docx-8.png" class="popup img-link shimmer"><img src="/assets/programming/docx/docx-8.png" alt="" loading="lazy"></a></p><p><br /></p><h1 id="table-rows">Table Rows</h1><p>We can also use lists to create additional rows of a table. Let’s use the employee example again, but this time let’s use a table to represent the data:</p><h2 id="docx-file-3"><span class="me-2">Docx File</span><a href="#docx-file-3" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p><a href="/assets/programming/docx/docx-9.png" class="popup img-link shimmer"><img src="/assets/programming/docx/docx-9.png" alt="" loading="lazy"></a></p><h2 id="the-code-4"><span class="me-2">The Code</span><a href="#the-code-4" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><div class="language-javascript highlighter-rouge"><div class="code-header"> <span data-label-text="JavaScript"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre><td class="rouge-code"><pre><span class="kd">const</span> <span class="nx">dataToAdd</span> <span class="o">=</span> <span class="p">{</span>
    <span class="na">employeeList</span><span class="p">:</span> <span class="p">[</span>
        <span class="p">{</span> <span class="na">id</span><span class="p">:</span> <span class="mi">28521</span><span class="p">,</span> <span class="na">name</span><span class="p">:</span> <span class="dl">'</span><span class="s1">Frank</span><span class="dl">'</span><span class="p">,</span> <span class="na">age</span><span class="p">:</span> <span class="mi">34</span><span class="p">,</span> <span class="na">city</span><span class="p">:</span> <span class="dl">'</span><span class="s1">Melbourne</span><span class="dl">'</span> <span class="p">},</span>
        <span class="p">{</span> <span class="na">id</span><span class="p">:</span> <span class="mi">84973</span><span class="p">,</span> <span class="na">name</span><span class="p">:</span> <span class="dl">'</span><span class="s1">Chloe</span><span class="dl">'</span><span class="p">,</span> <span class="na">age</span><span class="p">:</span> <span class="mi">28</span><span class="p">,</span> <span class="na">city</span><span class="p">:</span> <span class="dl">'</span><span class="s1">Perth</span><span class="dl">'</span> <span class="p">},</span>
        <span class="p">{</span> <span class="na">id</span><span class="p">:</span> <span class="mi">10349</span><span class="p">,</span> <span class="na">name</span><span class="p">:</span> <span class="dl">'</span><span class="s1">Hank</span><span class="dl">'</span><span class="p">,</span> <span class="na">age</span><span class="p">:</span> <span class="mi">68</span><span class="p">,</span> <span class="na">city</span><span class="p">:</span> <span class="dl">'</span><span class="s1">Hobart</span><span class="dl">'</span> <span class="p">},</span>
        <span class="p">{</span> <span class="na">id</span><span class="p">:</span> <span class="mi">44586</span><span class="p">,</span> <span class="na">name</span><span class="p">:</span> <span class="dl">'</span><span class="s1">Gordon</span><span class="dl">'</span><span class="p">,</span> <span class="na">age</span><span class="p">:</span> <span class="mi">47</span><span class="p">,</span> <span class="na">city</span><span class="p">:</span> <span class="dl">'</span><span class="s1">Melbourne</span><span class="dl">'</span> <span class="p">},</span>
    <span class="p">]</span>
<span class="p">};</span>
</pre></table></code></div></div><h2 id="results-3"><span class="me-2">Results</span><a href="#results-3" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p><a href="/assets/programming/docx/docx-10.png" class="popup img-link shimmer"><img src="/assets/programming/docx/docx-10.png" alt="" loading="lazy"></a></p><p><br /></p><h1 id="conditional-rendering">Conditional Rendering</h1><h2 id="docx-file-4"><span class="me-2">Docx File</span><a href="#docx-file-4" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>Another useful feature would be if we could only render certain things if a condition is met. Let’s see how we can do that:</p><p><a href="/assets/programming/docx/docx-11.png" class="popup img-link shimmer"><img src="/assets/programming/docx/docx-11.png" alt="" loading="lazy"></a></p><h2 id="the-code-5"><span class="me-2">The Code</span><a href="#the-code-5" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><div class="language-javascript highlighter-rouge"><div class="code-header"> <span data-label-text="JavaScript"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre><span class="kd">const</span> <span class="nx">dataToAdd</span> <span class="o">=</span> <span class="p">{</span>
    <span class="na">showDocumentAuthor</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
    <span class="na">document_author</span><span class="p">:</span> <span class="dl">'</span><span class="s1">Alexander Wells</span><span class="dl">'</span><span class="p">,</span>
<span class="p">};</span>
</pre></table></code></div></div><h2 id="results-4"><span class="me-2">Results</span><a href="#results-4" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p><a href="/assets/programming/docx/docx-12.png" class="popup img-link shimmer"><img src="/assets/programming/docx/docx-12.png" alt="" loading="lazy"></a></p><p>Changing <code class="language-plaintext highlighter-rouge">showDocumentAuthor</code> to <code class="language-plaintext highlighter-rouge">false</code> means the data inside the conditional statement won’t be rendered.</p><p><a href="/assets/programming/docx/docx-13.png" class="popup img-link shimmer"><img src="/assets/programming/docx/docx-13.png" alt="" loading="lazy"></a></p><p><br /></p><h1 id="helpful-tips">Helpful Tips</h1><h2 id="too-much-spacing"><span class="me-2">Too Much Spacing</span><a href="#too-much-spacing" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>You may notice if you use loops that extra spacing gets added where you don’t want. Let’s look at an example where this is very clear:</p><p><a href="/assets/programming/docx/docx-14.png" class="popup img-link shimmer"><img src="/assets/programming/docx/docx-14.png" alt="" loading="lazy"></a></p><div class="language-javascript highlighter-rouge"><div class="code-header"> <span data-label-text="JavaScript"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre><td class="rouge-code"><pre><span class="kd">const</span> <span class="nx">dataToAdd</span> <span class="o">=</span> <span class="p">{</span>
    <span class="na">groceryList</span><span class="p">:</span> <span class="p">[</span>
        <span class="p">{</span> <span class="na">item</span><span class="p">:</span> <span class="dl">'</span><span class="s1">Eggs</span><span class="dl">'</span> <span class="p">},</span>
        <span class="p">{</span> <span class="na">item</span><span class="p">:</span> <span class="dl">'</span><span class="s1">Steak</span><span class="dl">'</span> <span class="p">},</span>
        <span class="p">{</span> <span class="na">item</span><span class="p">:</span> <span class="dl">'</span><span class="s1">Apples</span><span class="dl">'</span> <span class="p">}</span>
    <span class="p">],</span>
<span class="p">};</span>
</pre></table></code></div></div><p><a href="/assets/programming/docx/docx-15.png" class="popup img-link shimmer"><img src="/assets/programming/docx/docx-15.png" alt="" loading="lazy"></a></p><ul><li>With visible formatting enabled we can see the issue.<li>An extra line has been inserted between each list element.</ul><p>We can fix this by enabling by enabling <code class="language-plaintext highlighter-rouge">paragraphLoop</code> option when creating our output document:</p><div class="language-javascript highlighter-rouge"><div class="code-header"> <span data-label-text="JavaScript"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="kd">let</span> <span class="nx">outputDocument</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Docxtemplater</span><span class="p">(</span><span class="nx">zip</span><span class="p">,</span> <span class="p">{</span> <span class="na">paragraphLoop</span><span class="p">:</span> <span class="kc">true</span> <span class="p">});</span>
</pre></table></code></div></div><p><a href="/assets/programming/docx/docx-16.png" class="popup img-link shimmer"><img src="/assets/programming/docx/docx-16.png" alt="" loading="lazy"></a></p><h2 id="error-finding-1"><span class="me-2">Error Finding 1</span><a href="#error-finding-1" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><ul><li>One downside of this library is that error locations is actually a paid feature (yes I’m serious), look <a href="https://docxtemplater.com/demo/#error-location">here</a>.<li>This is an inconvenience and nothing more.<li>I <strong>STRONGLY</strong> suggest that you do templating in small batches. Add a few tags, test, add a few more, then test again.<li>Please do not spend hours (or even an hour) templating before testing. It will save you a massive headache when the program just says <code class="language-plaintext highlighter-rouge">error</code>, and you have to hunt through your document to find the issue.</ul><h2 id="error-finding-2"><span class="me-2">Error Finding 2</span><a href="#error-finding-2" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><ul><li>Ensure that your tags in the docx file do not contain spaces at the start or end.<li>If you have a list tag called <code class="language-plaintext highlighter-rouge">{#employeeList}</code>, ensure there is no whitespace like this <code class="language-plaintext highlighter-rouge">{#employeeList }</code>, as this can cause the program to fail.<li>Microsoft Word can automatically add spaces so be aware of that.</ul><h2 id="tag-names"><span class="me-2">Tag Names</span><a href="#tag-names" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><ul><li>USE GOOD TAG NAMES!<li>Just like when programming you try and use good variable names, same goes here.<li>A large document may have dozens or hundreds of tags. Using <code class="language-plaintext highlighter-rouge">date</code> for a tag name is <strong>BAD</strong>!<li>Using <code class="language-plaintext highlighter-rouge">document_creation_date</code> is much better as it’s clear exactly what date it’s referring to.</ul></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw me-1"></i> <a href="/categories/javascript/">javascript</a>, <a href="/categories/programming/">programming</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw me-1"></i> <a href="/tags/javascript/" class="post-tag no-text-decoration" >javascript</a> <a href="/tags/programming/" class="post-tag no-text-decoration" >programming</a> <a href="/tags/docx/" class="post-tag no-text-decoration" >docx</a> <a href="/tags/nodejs/" class="post-tag no-text-decoration" >nodejs</a> <a href="/tags/react/" class="post-tag no-text-decoration" >react</a></div><div class=" post-tail-bottom d-flex justify-content-between align-items-center mt-5 pb-2 " ><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper d-flex align-items-center"> <span class="share-label text-muted">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Docx%20Templating%20in%20JavaScript%20-%20Node%20Security&url=%2Fposts%2Fdocx-templating-in-javascript%2F" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Twitter" aria-label="Twitter"> <i class="fa-fw fa-brands fa-square-x-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=Docx%20Templating%20in%20JavaScript%20-%20Node%20Security&u=%2Fposts%2Fdocx-templating-in-javascript%2F" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Facebook" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://t.me/share/url?url=%2Fposts%2Fdocx-templating-in-javascript%2F&text=Docx%20Templating%20in%20JavaScript%20-%20Node%20Security" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Telegram" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <button id="copy-link" aria-label="Copy link" class="btn small" data-bs-toggle="tooltip" data-bs-placement="top" title="Copy link" data-title-succeed="Link copied successfully!" > <i class="fa-fw fas fa-link pe-none fs-6"></i> </button> </span></div></div></div></article></main><aside aria-label="Panel" id="panel-wrapper" class="col-xl-3 ps-2 mb-5 text-muted"><div class="access"><section id="access-lastmod"><h2 class="panel-heading">Recently Updated</h2><ul class="content list-unstyled ps-0 pb-1 ms-1 mt-2"><li class="text-truncate lh-lg"> <a href="/posts/json-parse-and-filter/">JSON Parse & Filter</a><li class="text-truncate lh-lg"> <a href="/posts/password-word-list-generator/">Password Word List Generator</a><li class="text-truncate lh-lg"> <a href="/posts/rust-cheatsheet/">Rust Cheatsheet</a><li class="text-truncate lh-lg"> <a href="/posts/breaking-out-of-windows-environments/">Breaking out of Windows Environments</a><li class="text-truncate lh-lg"> <a href="/posts/custom-right-click-menu-option/">Windows Custom Right Click Menu Option</a></ul></section><section><h2 class="panel-heading">Trending Tags</h2><div class="d-flex flex-wrap mt-3 mb-1 me-3"> <a class="post-tag btn btn-outline-primary" href="/tags/security/">security</a> <a class="post-tag btn btn-outline-primary" href="/tags/javascript/">javascript</a> <a class="post-tag btn btn-outline-primary" href="/tags/cryptography/">cryptography</a> <a class="post-tag btn btn-outline-primary" href="/tags/web/">web</a> <a class="post-tag btn btn-outline-primary" href="/tags/http/">http</a> <a class="post-tag btn btn-outline-primary" href="/tags/https/">https</a> <a class="post-tag btn btn-outline-primary" href="/tags/algorithm/">algorithm</a> <a class="post-tag btn btn-outline-primary" href="/tags/programming/">programming</a> <a class="post-tag btn btn-outline-primary" href="/tags/windows/">windows</a> <a class="post-tag btn btn-outline-primary" href="/tags/nodejs/">nodejs</a></div></section></div><section id="toc-wrapper" class="d-none ps-0 pe-4"><h2 class="panel-heading ps-3 mb-2">Contents</h2><nav id="toc"></nav></section></aside></div><div class="row"><div id="tail-wrapper" class="col-12 col-lg-11 col-xl-9 px-md-4"><aside id="related-posts" aria-labelledby="related-label"><h3 class="mb-4" id="related-label">Further Reading</h3><nav class="row row-cols-1 row-cols-md-2 row-cols-xl-3 g-4 mb-4"><article class="col"> <a href="/posts/creating-xlsx-documents-in-javascript-advanced/" class="post-preview card h-100"><div class="card-body"> <time data-ts="1619249980" data-df="ll" > Apr 24, 2021 </time><h4 class="pt-0 my-2">Creating XLSX Documents in Javascript (Advanced)</h4><div class="text-muted"><p>In this post we’ll look at how to create XLSX documents in JavaScript with more advanced features such as custom styling and formulas using the xlsx &amp;amp; js-xlsx packages. This works in both NodeJ...</p></div></div></a></article><article class="col"> <a href="/posts/creating-xlsx-documents-in-javascript-basic/" class="post-preview card h-100"><div class="card-body"> <time data-ts="1619236396" data-df="ll" > Apr 24, 2021 </time><h4 class="pt-0 my-2">Creating XLSX Documents in Javascript (Basic)</h4><div class="text-muted"><p>In this post we’ll look at how to create basic XLSX documents in JavaScript using the xlsx package. This works in both NodeJS and React. What we are Making Installing Requirements The Code ...</p></div></div></a></article><article class="col"> <a href="/posts/secure-electron-ipc/" class="post-preview card h-100"><div class="card-body"> <time data-ts="1630049217" data-df="ll" > Aug 27, 2021 </time><h4 class="pt-0 my-2">Secure Electron IPC</h4><div class="text-muted"><p>In this post we’ll look at how to do secure IPC (Inter-Process-Communication) in Electron. PLEASE NOTE this is NOT a tutorial on Electron or Electron IPC, it will assume you already know how to us...</p></div></div></a></article></nav></aside><nav class="post-navigation d-flex justify-content-between" aria-label="Post Navigation"> <a href="/posts/web-workers/" class="btn btn-outline-primary" aria-label="Older" ><p>Web Workers</p></a> <a href="/posts/express-sni/" class="btn btn-outline-primary" aria-label="Newer" ><p>NodeJS Express SNI</p></a></nav><footer aria-label="Site Info" class=" d-flex flex-column justify-content-center text-muted flex-lg-row justify-content-lg-between align-items-lg-center pb-lg-3 " ><p>© <time>2025</time> <a href="https://twitter.com/todo">Alexander Wells</a>. <span data-bs-toggle="tooltip" data-bs-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author." >Some rights reserved.</span></p><p>Using the <a data-bs-toggle="tooltip" data-bs-placement="top" title="v7.1.1" href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener" >Chirpy</a> theme for <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a>.</p></footer></div></div><div id="search-result-wrapper" class="d-flex justify-content-center d-none"><div class="col-11 content"><div id="search-hints"><section><h2 class="panel-heading">Trending Tags</h2><div class="d-flex flex-wrap mt-3 mb-1 me-3"> <a class="post-tag btn btn-outline-primary" href="/tags/security/">security</a> <a class="post-tag btn btn-outline-primary" href="/tags/javascript/">javascript</a> <a class="post-tag btn btn-outline-primary" href="/tags/cryptography/">cryptography</a> <a class="post-tag btn btn-outline-primary" href="/tags/web/">web</a> <a class="post-tag btn btn-outline-primary" href="/tags/http/">http</a> <a class="post-tag btn btn-outline-primary" href="/tags/https/">https</a> <a class="post-tag btn btn-outline-primary" href="/tags/algorithm/">algorithm</a> <a class="post-tag btn btn-outline-primary" href="/tags/programming/">programming</a> <a class="post-tag btn btn-outline-primary" href="/tags/windows/">windows</a> <a class="post-tag btn btn-outline-primary" href="/tags/nodejs/">nodejs</a></div></section></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><aside aria-label="Scroll to Top"> <button id="back-to-top" type="button" class="btn btn-lg btn-box-shadow"> <i class="fas fa-angle-up"></i> </button></aside></div><div id="mask"></div><aside id="notification" class="toast" role="alert" aria-live="assertive" aria-atomic="true" data-bs-animation="true" data-bs-autohide="false" ><div class="toast-header"> <button type="button" class="btn-close ms-auto" data-bs-dismiss="toast" aria-label="Close" ></button></div><div class="toast-body text-center pt-0"><p class="px-2 mb-3">A new version of content is available.</p><button type="button" class="btn btn-primary" aria-label="Update"> Update </button></div></aside><script src="https://cdn.jsdelivr.net/combine/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js,npm/loading-attribute-polyfill@2.1.1/dist/loading-attribute-polyfill.umd.min.js,npm/glightbox@3.3.0/dist/js/glightbox.min.js,npm/clipboard@2.0.11/dist/clipboard.min.js,npm/dayjs@1.11.13/dayjs.min.js,npm/dayjs@1.11.13/locale/en.js,npm/dayjs@1.11.13/plugin/relativeTime.js,npm/dayjs@1.11.13/plugin/localizedFormat.js,npm/tocbot@4.29.0/dist/tocbot.min.js"></script> <script src="/assets/js/dist/post.min.js"></script> <script defer src="/app.min.js?baseurl=&register=true" ></script> <script>SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<article class="px-1 px-sm-2 px-lg-4 px-xl-0"><header><h2><a href="{url}">{title}</a></h2><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div></header><p>{snippet}</p></article>', noResultsText: '<p class="mt-5">Oops! No results found.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="me-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script>
