<!doctype html><html lang="en" data-mode="dark"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="theme-color" media="(prefers-color-scheme: light)" content="#f7f7f7"><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1b1b1e"><meta name="mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="black-translucent"><meta name="viewport" content="width=device-width, user-scalable=no initial-scale=1, shrink-to-fit=no, viewport-fit=cover" ><meta name="generator" content="Jekyll v4.3.4" /><meta property="og:title" content="Secure Electron IPC" /><meta property="og:locale" content="en" /><meta name="description" content="In this post we’ll look at how to do secure IPC (Inter-Process-Communication) in Electron." /><meta property="og:description" content="In this post we’ll look at how to do secure IPC (Inter-Process-Communication) in Electron." /><link rel="canonical" href="/posts/secure-electron-ipc/" /><meta property="og:url" content="/posts/secure-electron-ipc/" /><meta property="og:site_name" content="Node Security" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2021-08-27T17:26:57+10:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="Secure Electron IPC" /><meta name="twitter:site" content="@todo" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2021-09-29T00:55:26+10:00","datePublished":"2021-08-27T17:26:57+10:00","description":"In this post we’ll look at how to do secure IPC (Inter-Process-Communication) in Electron.","headline":"Secure Electron IPC","mainEntityOfPage":{"@type":"WebPage","@id":"/posts/secure-electron-ipc/"},"url":"/posts/secure-electron-ipc/"}</script><title>Secure Electron IPC | Node Security</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="Node Security"><meta name="application-name" content="Node Security"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="stylesheet" href="/assets/css/jekyll-theme-chirpy.css"><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.6.0/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/tocbot@4.29.0/dist/tocbot.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/loading-attribute-polyfill@2.1.1/dist/loading-attribute-polyfill.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/glightbox@3.3.0/dist/css/glightbox.min.css"><body><aside aria-label="Sidebar" id="sidebar" class="d-flex flex-column align-items-end"><header class="profile-wrapper"> <a href="/" id="avatar" class="rounded-circle"><img src="/assets/icon.webp" width="112" height="112" alt="avatar" onerror="this.style.display='none'"></a><h1 class="site-title"> <a href="/">Node Security</a></h1><p class="site-subtitle fst-italic mb-0">Security & Programming Guides</p></header><nav class="flex-column flex-grow-1 w-100 ps-0"><ul class="nav"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/tools/" class="nav-link"> <i class="fa-fw fas fa-tools"></i> <span>TOOLS</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tags"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle"></i> <span>ABOUT</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive"></i> <span>ARCHIVES</span> </a></ul></nav><div class="sidebar-bottom d-flex flex-wrap align-items-center w-100"> <a href="https://github.com/O1dMate" aria-label="github" target="_blank" rel="noopener noreferrer" > <i class="fab fa-github"></i> </a> <a href="https://twitter.com/todo" aria-label="twitter" target="_blank" rel="noopener noreferrer" > <i class="fa-brands fa-x-twitter"></i> </a> <a href="javascript:location.href = 'mailto:' + ['o1dmate','protonmail.com'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></aside><div id="main-wrapper" class="d-flex justify-content-center"><div class="container d-flex flex-column px-xxl-5"><header id="topbar-wrapper" aria-label="Top Bar"><div id="topbar" class="d-flex align-items-center justify-content-between px-lg-3 h-100" ><nav id="breadcrumb" aria-label="Breadcrumb"> <span> <a href="/">Home</a> </span> <span>Secure Electron IPC</span></nav><button type="button" id="sidebar-trigger" class="btn btn-link"> <i class="fas fa-bars fa-fw"></i> </button><div id="topbar-title"> Post</div><button type="button" id="search-trigger" class="btn btn-link"> <i class="fas fa-search fa-fw"></i> </button> <search id="search" class="align-items-center ms-3 ms-lg-0"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..." > </search> <button type="button" class="btn btn-link text-decoration-none" id="search-cancel">Cancel</button></div></header><div class="row flex-grow-1"><main aria-label="Main Content" class="col-12 col-lg-11 col-xl-9 px-md-4"><article class="px-1"><header><h1 data-toc-skip>Secure Electron IPC</h1><div class="post-meta text-muted"> <span> Posted <time data-ts="1630049217" data-df="ll" data-bs-toggle="tooltip" data-bs-placement="bottom" > Aug 27, 2021 </time> </span> <span> Updated <time data-ts="1632840926" data-df="ll" data-bs-toggle="tooltip" data-bs-placement="bottom" > Sep 29, 2021 </time> </span><div class="d-flex justify-content-between"> <span> By <em> <a href="https://twitter.com/todo">Alexander Wells</a> </em> </span><div> <span class="readtime" data-bs-toggle="tooltip" data-bs-placement="bottom" title="798 words" > <em>4 min</em> read</span></div></div></div></header><div class="content"><p>In this post we’ll look at how to do secure IPC (Inter-Process-Communication) in Electron.</p><p><strong>PLEASE NOTE</strong> this is NOT a tutorial on Electron or Electron IPC, it will assume you already know how to use Electron and how IPC works.</p><ol><li><a href="#why-does-it-matter">Why does it matter?</a><ul><li><a href="#the-rce-problem">The RCE Problem</a></ul><li><a href="#server-side">Server Side</a><ul><li><a href="#electronjs">electron.js</a><li><a href="#preloadjs">preload.js</a></ul><li><a href="#client-side">Client Side</a></ol><h1 id="why-does-it-matter">Why does it matter?</h1><p>To keep it short, insecure IPC can lead to full blown RCE (Remote Code Execute).</p><p>How? If you misconfigure the following two settings:</p><ul><li><code class="language-plaintext highlighter-rouge">contextIsolation</code> set to <code class="language-plaintext highlighter-rouge">false</code><li><code class="language-plaintext highlighter-rouge">nodeIntegration</code> set to <code class="language-plaintext highlighter-rouge">true</code></ul><p>With the above settings, it’s possible to do the following on the front-end in JavaScript:</p><div class="language-javascript highlighter-rouge"><div class="code-header"> <span data-label-text="JavaScript"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre><span class="kd">const</span> <span class="p">{</span> <span class="nx">ipcRenderer</span> <span class="p">}</span> <span class="o">=</span> <span class="nb">window</span><span class="p">.</span><span class="nf">require</span><span class="p">(</span><span class="dl">'</span><span class="s1">electron</span><span class="dl">'</span><span class="p">);</span>

<span class="nx">ipcRenderer</span><span class="p">.</span><span class="nf">send</span><span class="p">(</span><span class="dl">'</span><span class="s1">send-ipc-msg-server</span><span class="dl">'</span><span class="p">,</span> <span class="dl">'</span><span class="s1">Hello</span><span class="dl">'</span><span class="p">);</span>
</pre></table></code></div></div><ul><li>And this should work perfectly fine.</ul><h2 id="the-rce-problem"><span class="me-2">The RCE Problem</span><a href="#the-rce-problem" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>While the above solution might work for IPC, we’ve just opened the back-end up to the front-end.</p><p>If someone were to get XSS on the front-end, they could run a command like this:</p><div class="language-javascript highlighter-rouge"><div class="code-header"> <span data-label-text="JavaScript"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nb">window</span><span class="p">.</span><span class="nf">require</span><span class="p">(</span><span class="dl">'</span><span class="s1">child_process</span><span class="dl">'</span><span class="p">).</span><span class="nf">execSync</span><span class="p">(</span><span class="dl">'</span><span class="s1">calc</span><span class="dl">'</span><span class="p">);</span>
</pre></table></code></div></div><p><a href="/assets/programming/secure-ipc/rce-1.png" class="popup img-link shimmer"><img src="/assets/programming/secure-ipc/rce-1.png" alt="" loading="lazy"></a></p><p>For a little bit more fun:</p><div class="language-javascript highlighter-rouge"><div class="code-header"> <span data-label-text="JavaScript"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nb">window</span><span class="p">.</span><span class="nf">require</span><span class="p">(</span><span class="dl">'</span><span class="s1">fs</span><span class="dl">'</span><span class="p">).</span><span class="nf">readdirSync</span><span class="p">(</span><span class="dl">'</span><span class="s1">C:</span><span class="se">\\</span><span class="dl">'</span><span class="p">);</span>
</pre></table></code></div></div><p><a href="/assets/programming/secure-ipc/rce-2.png" class="popup img-link shimmer"><img src="/assets/programming/secure-ipc/rce-2.png" alt="" loading="lazy"></a></p><p>So yeah, this is not a good solution. Fortunately, there is a better way to do IPC.</p><h1 id="server-side">Server Side</h1><h2 id="electronjs"><span class="me-2">electron.js</span><a href="#electronjs" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>Our first step will be to ensure <code class="language-plaintext highlighter-rouge">BrowserWindow</code> doesn’t have any insecure option enabled.</p><ul><li><code class="language-plaintext highlighter-rouge">contextIsolation</code> should be <code class="language-plaintext highlighter-rouge">true</code>.<li><code class="language-plaintext highlighter-rouge">enableRemoteModule</code> should be <code class="language-plaintext highlighter-rouge">false</code>.</ul><p>The second step will to specify the location of our <code class="language-plaintext highlighter-rouge">preload.js</code> file. If you don’t already have a <code class="language-plaintext highlighter-rouge">preload.js</code> file, create one and specify the path:</p><div class="language-javascript highlighter-rouge"><div class="code-header"> <span data-label-text="JavaScript"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
</pre><td class="rouge-code"><pre><span class="kd">const</span> <span class="nx">electron</span> <span class="o">=</span> <span class="nf">require</span><span class="p">(</span><span class="dl">'</span><span class="s1">electron</span><span class="dl">'</span><span class="p">);</span>
<span class="kd">const</span> <span class="nx">BrowserWindow</span> <span class="o">=</span> <span class="nx">electron</span><span class="p">.</span><span class="nx">BrowserWindow</span><span class="p">;</span>
<span class="kd">const</span> <span class="nx">path</span> <span class="o">=</span> <span class="nf">require</span><span class="p">(</span><span class="dl">'</span><span class="s1">path</span><span class="dl">'</span><span class="p">);</span>

<span class="kd">const</span> <span class="nx">win</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">BrowserWindow</span><span class="p">({</span>
	<span class="na">width</span><span class="p">:</span> <span class="mi">1800</span><span class="p">,</span>
	<span class="na">height</span><span class="p">:</span> <span class="mi">1000</span><span class="p">,</span>
	<span class="na">webPreferences</span><span class="p">:</span> <span class="p">{</span>
		<span class="na">contextIsolation</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
		<span class="na">enableRemoteModule</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span>
		<span class="na">preload</span><span class="p">:</span> <span class="nx">path</span><span class="p">.</span><span class="nf">join</span><span class="p">(</span><span class="nx">__dirname</span><span class="p">,</span> <span class="dl">"</span><span class="s2">preload.js</span><span class="dl">"</span><span class="p">)</span>
	<span class="p">}</span>
<span class="p">});</span>
</pre></table></code></div></div><p>Finally we will also need to setup an IPC listener on the back-side. This can be done in <code class="language-plaintext highlighter-rouge">electron.js</code> or another back-side file:</p><div class="language-javascript highlighter-rouge"><div class="code-header"> <span data-label-text="JavaScript"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
</pre><td class="rouge-code"><pre><span class="kd">const</span> <span class="p">{</span> <span class="nx">ipcMain</span> <span class="p">}</span> <span class="o">=</span> <span class="nf">require</span><span class="p">(</span><span class="dl">'</span><span class="s1">electron</span><span class="dl">'</span><span class="p">);</span>

<span class="c1">// Event handler for incoming IPC messages</span>
<span class="nx">ipcMain</span><span class="p">.</span><span class="nf">on</span><span class="p">(</span><span class="dl">'</span><span class="s1">send-ipc-msg-server</span><span class="dl">'</span><span class="p">,</span> <span class="p">(</span><span class="nx">event</span><span class="p">,</span> <span class="nx">arg</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
	<span class="nx">console</span><span class="p">.</span><span class="nf">log</span><span class="p">(</span><span class="dl">'</span><span class="s1">From CLIENT:</span><span class="dl">'</span><span class="p">);</span>
	<span class="nx">console</span><span class="p">.</span><span class="nf">log</span><span class="p">(</span><span class="nx">arg</span><span class="p">);</span>

	<span class="c1">// Send a message back to the client</span>
	<span class="nx">event</span><span class="p">.</span><span class="nx">sender</span><span class="p">.</span><span class="nf">send</span><span class="p">(</span><span class="dl">'</span><span class="s1">send-ipc-msg-client</span><span class="dl">'</span><span class="p">,</span> <span class="s2">`Return Message: </span><span class="p">${(</span><span class="k">new</span> <span class="nc">Date</span><span class="p">()).</span><span class="nf">toLocaleString</span><span class="p">()}</span><span class="s2">`</span><span class="p">)</span>
<span class="p">});</span>
</pre></table></code></div></div><h2 id="preloadjs"><span class="me-2">preload.js</span><a href="#preloadjs" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>In the <code class="language-plaintext highlighter-rouge">preload.js</code> file, the following code will be required:</p><div class="language-javascript highlighter-rouge"><div class="code-header"> <span data-label-text="JavaScript"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
</pre><td class="rouge-code"><pre><span class="kd">const</span> <span class="p">{</span>	<span class="nx">contextBridge</span><span class="p">,</span> <span class="nx">ipcRenderer</span> <span class="p">}</span> <span class="o">=</span> <span class="nf">require</span><span class="p">(</span><span class="dl">"</span><span class="s2">electron</span><span class="dl">"</span><span class="p">);</span>

<span class="nx">contextBridge</span><span class="p">.</span><span class="nf">exposeInMainWorld</span><span class="p">(</span>
	<span class="dl">"</span><span class="s2">ipcComm</span><span class="dl">"</span><span class="p">,</span> <span class="p">{</span>
		<span class="na">send</span><span class="p">:</span> <span class="p">(</span><span class="nx">channel</span><span class="p">,</span> <span class="nx">data</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
			<span class="nx">ipcRenderer</span><span class="p">.</span><span class="nf">send</span><span class="p">(</span><span class="nx">channel</span><span class="p">,</span> <span class="nx">data</span><span class="p">);</span>
		<span class="p">},</span>
		<span class="na">on</span><span class="p">:</span> <span class="p">(</span><span class="nx">channel</span><span class="p">,</span> <span class="nx">callback</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
			<span class="c1">// Remove `event` parameter (the underscore parameter) as the UI doesn't need it</span>
			<span class="nx">ipcRenderer</span><span class="p">.</span><span class="nf">on</span><span class="p">(</span><span class="nx">channel</span><span class="p">,</span> <span class="p">(</span><span class="nx">_</span><span class="p">,</span> <span class="p">...</span><span class="nx">args</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
				<span class="nf">callback</span><span class="p">(...</span><span class="nx">args</span><span class="p">);</span>
			<span class="p">});</span>
		<span class="p">},</span>
		<span class="na">removeAllListeners</span><span class="p">:</span> <span class="p">(</span><span class="nx">channel</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
			<span class="nx">ipcRenderer</span><span class="p">.</span><span class="nf">removeAllListeners</span><span class="p">(</span><span class="nx">channel</span><span class="p">);</span>
		<span class="p">}</span>
	<span class="p">}</span>
<span class="p">);</span>
</pre></table></code></div></div><p>What does this do? This creates a safe “bridge” for our front-end to talk to the back-end. Any communication with the back-end must go through this bridge.</p><p><code class="language-plaintext highlighter-rouge">contextBridge.exposeInMainWorld(apiName, obj)</code> takes 2 parameters:</p><ul><li><code class="language-plaintext highlighter-rouge">apiName</code> is the key that will be added to the front-end <code class="language-plaintext highlighter-rouge">window</code> Object. You can access it using <code class="language-plaintext highlighter-rouge">window[apiName]</code>.<li><code class="language-plaintext highlighter-rouge">obj</code> is the Object or Value that will be returned when you access <code class="language-plaintext highlighter-rouge">window[apiName]</code>.</ul><p>The name <code class="language-plaintext highlighter-rouge">ipcComm</code> is arbitrary and you can call it what you like.</p><p>The keys inside the provided Object have been setup as follows:</p><ul><li><code class="language-plaintext highlighter-rouge">send</code> a function to send messages to the back-end on a certain channel.<li><code class="language-plaintext highlighter-rouge">on</code> a function to setup a listener on a channel for when the server sends messages back.<li><code class="language-plaintext highlighter-rouge">removeAllListeners</code> a function to remove all the listeners on a channel.</ul><h3 id="why-should-you-do-it-like-this"><span class="me-2">Why should you do it like this?</span><a href="#why-should-you-do-it-like-this" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>The reason for using this system is so that the front-end can’t import back-end modules directly, nor can it use the <code class="language-plaintext highlighter-rouge">contextBridge</code> or <code class="language-plaintext highlighter-rouge">ipcRenderer</code> modules directly.</p><p><br /></p><h1 id="client-side">Client Side</h1><p>Now that we have our bridge setup, let’s see how to use it. In a Component let’s add the following code:</p><div class="language-javascript highlighter-rouge"><div class="code-header"> <span data-label-text="JavaScript"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
</pre><td class="rouge-code"><pre><span class="nf">useEffect</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="p">{</span>
	<span class="nb">window</span><span class="p">.</span><span class="nx">ipcComm</span><span class="p">.</span><span class="nf">on</span><span class="p">(</span><span class="dl">'</span><span class="s1">send-ipc-msg-client</span><span class="dl">'</span><span class="p">,</span> <span class="p">(</span><span class="nx">returnValue</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
		<span class="nx">console</span><span class="p">.</span><span class="nf">log</span><span class="p">(</span><span class="dl">"</span><span class="s2">From SERVER:</span><span class="dl">"</span><span class="p">);</span>
		<span class="nx">console</span><span class="p">.</span><span class="nf">log</span><span class="p">(</span><span class="nx">returnValue</span><span class="p">);</span>
	<span class="p">});</span>

	<span class="nb">window</span><span class="p">.</span><span class="nx">ipcComm</span><span class="p">.</span><span class="nf">send</span><span class="p">(</span><span class="dl">'</span><span class="s1">send-ipc-msg-server</span><span class="dl">'</span><span class="p">,</span> <span class="dl">'</span><span class="s1">Hello</span><span class="dl">'</span><span class="p">);</span>

	<span class="k">return </span><span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
		<span class="nb">window</span><span class="p">.</span><span class="nx">ipcComm</span><span class="p">.</span><span class="nf">removeAllListeners</span><span class="p">(</span><span class="dl">'</span><span class="s1">send-ipc-msg-client</span><span class="dl">'</span><span class="p">);</span>
	<span class="p">}</span>
<span class="c1">// eslint-disable-next-line</span>
<span class="p">},</span> <span class="p">[</span><span class="mi">0</span><span class="p">]);</span>
</pre></table></code></div></div><p>Break down of the code above:</p><ul><li><code class="language-plaintext highlighter-rouge">Line 2-5</code> setup a listener on the <code class="language-plaintext highlighter-rouge">send-ipc-msg-client</code> channel with a callback for when a message is received.<li><code class="language-plaintext highlighter-rouge">Line 7</code> send the message <code class="language-plaintext highlighter-rouge">Hello</code> to the server on the <code class="language-plaintext highlighter-rouge">send-ipc-msg-server</code> channel.<li><code class="language-plaintext highlighter-rouge">Line 9-11</code> return a function that will remove all listeners on the <code class="language-plaintext highlighter-rouge">send-ipc-msg-client</code> channel when the Component is unmounted.<li><code class="language-plaintext highlighter-rouge">Line 12-13</code> Provide a static value to <code class="language-plaintext highlighter-rouge">useEffect</code> so that the code is only run once when the Component is mounted and NOT after every update.</ul><p>If you are using a class based Component, then you can setup the listener and send the message in <code class="language-plaintext highlighter-rouge">componentDidMount</code>, and remove the listener in <code class="language-plaintext highlighter-rouge">componentWillUnmount</code>:</p><div class="language-javascript highlighter-rouge"><div class="code-header"> <span data-label-text="JavaScript"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
</pre><td class="rouge-code"><pre><span class="nf">componentDidMount</span><span class="p">()</span> <span class="p">{</span>
	<span class="nb">window</span><span class="p">.</span><span class="nx">ipcComm</span><span class="p">.</span><span class="nf">on</span><span class="p">(</span><span class="dl">'</span><span class="s1">send-ipc-msg-client</span><span class="dl">'</span><span class="p">,</span> <span class="p">(</span><span class="nx">returnValue</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
		<span class="nx">console</span><span class="p">.</span><span class="nf">log</span><span class="p">(</span><span class="dl">"</span><span class="s2">From SERVER:</span><span class="dl">"</span><span class="p">);</span>
		<span class="nx">console</span><span class="p">.</span><span class="nf">log</span><span class="p">(</span><span class="nx">returnValue</span><span class="p">);</span>
	<span class="p">});</span>

	<span class="nb">window</span><span class="p">.</span><span class="nx">ipcComm</span><span class="p">.</span><span class="nf">send</span><span class="p">(</span><span class="dl">'</span><span class="s1">send-ipc-msg-server</span><span class="dl">'</span><span class="p">,</span> <span class="dl">'</span><span class="s1">Hello</span><span class="dl">'</span><span class="p">);</span>
<span class="p">}</span>

<span class="nf">componentWillUnmount</span><span class="p">()</span> <span class="p">{</span>
	<span class="nb">window</span><span class="p">.</span><span class="nx">ipcComm</span><span class="p">.</span><span class="nf">removeAllListeners</span><span class="p">(</span><span class="dl">'</span><span class="s1">send-ipc-msg-client</span><span class="dl">'</span><span class="p">);</span>
<span class="p">}</span>
</pre></table></code></div></div><h1 id="references-and-more-info">References and More Info</h1><ul><li><a href="https://www.electronjs.org/docs/api/context-bridge">ElectronJS - contextBridge</a><li><a href="https://www.youtube.com/watch?v=jkJWA_CWrQs">Electron RCE via XSS</a></ul></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw me-1"></i> <a href="/categories/javascript/">javascript</a>, <a href="/categories/nodejs/">nodejs</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw me-1"></i> <a href="/tags/electron/" class="post-tag no-text-decoration" >electron</a> <a href="/tags/security/" class="post-tag no-text-decoration" >security</a> <a href="/tags/javascript/" class="post-tag no-text-decoration" >javascript</a> <a href="/tags/nodejs/" class="post-tag no-text-decoration" >nodejs</a> <a href="/tags/ipc/" class="post-tag no-text-decoration" >ipc</a> <a href="/tags/react/" class="post-tag no-text-decoration" >react</a></div><div class=" post-tail-bottom d-flex justify-content-between align-items-center mt-5 pb-2 " ><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper d-flex align-items-center"> <span class="share-label text-muted">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Secure%20Electron%20IPC%20-%20Node%20Security&url=%2Fposts%2Fsecure-electron-ipc%2F" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Twitter" aria-label="Twitter"> <i class="fa-fw fa-brands fa-square-x-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=Secure%20Electron%20IPC%20-%20Node%20Security&u=%2Fposts%2Fsecure-electron-ipc%2F" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Facebook" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://t.me/share/url?url=%2Fposts%2Fsecure-electron-ipc%2F&text=Secure%20Electron%20IPC%20-%20Node%20Security" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Telegram" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <button id="copy-link" aria-label="Copy link" class="btn small" data-bs-toggle="tooltip" data-bs-placement="top" title="Copy link" data-title-succeed="Link copied successfully!" > <i class="fa-fw fas fa-link pe-none fs-6"></i> </button> </span></div></div></div></article></main><aside aria-label="Panel" id="panel-wrapper" class="col-xl-3 ps-2 mb-5 text-muted"><div class="access"><section id="access-lastmod"><h2 class="panel-heading">Recently Updated</h2><ul class="content list-unstyled ps-0 pb-1 ms-1 mt-2"><li class="text-truncate lh-lg"> <a href="/posts/general-encoder-&-decoder/">General Encoder & Decoder</a><li class="text-truncate lh-lg"> <a href="/posts/breaking-out-of-windows-environments/">Breaking out of Windows Environments</a><li class="text-truncate lh-lg"> <a href="/posts/custom-right-click-menu-option/">Windows Custom Right Click Menu Option</a><li class="text-truncate lh-lg"> <a href="/posts/random-windows-commands/">Random Windows Commands</a><li class="text-truncate lh-lg"> <a href="/posts/magic-number-perfect-hash-function/">Magic Number Perfect Hash Function</a></ul></section><section><h2 class="panel-heading">Trending Tags</h2><div class="d-flex flex-wrap mt-3 mb-1 me-3"> <a class="post-tag btn btn-outline-primary" href="/tags/security/">security</a> <a class="post-tag btn btn-outline-primary" href="/tags/javascript/">javascript</a> <a class="post-tag btn btn-outline-primary" href="/tags/cryptography/">cryptography</a> <a class="post-tag btn btn-outline-primary" href="/tags/web/">web</a> <a class="post-tag btn btn-outline-primary" href="/tags/http/">http</a> <a class="post-tag btn btn-outline-primary" href="/tags/https/">https</a> <a class="post-tag btn btn-outline-primary" href="/tags/algorithm/">algorithm</a> <a class="post-tag btn btn-outline-primary" href="/tags/programming/">programming</a> <a class="post-tag btn btn-outline-primary" href="/tags/windows/">windows</a> <a class="post-tag btn btn-outline-primary" href="/tags/nodejs/">nodejs</a></div></section></div><section id="toc-wrapper" class="d-none ps-0 pe-4"><h2 class="panel-heading ps-3 mb-2">Contents</h2><nav id="toc"></nav></section></aside></div><div class="row"><div id="tail-wrapper" class="col-12 col-lg-11 col-xl-9 px-md-4"><aside id="related-posts" aria-labelledby="related-label"><h3 class="mb-4" id="related-label">Further Reading</h3><nav class="row row-cols-1 row-cols-md-2 row-cols-xl-3 g-4 mb-4"><article class="col"> <a href="/posts/express-cert-based-mutual-auth/" class="post-preview card h-100"><div class="card-body"> <time data-ts="1630963538" data-df="ll" > Sep 7, 2021 </time><h4 class="pt-0 my-2">NodeJS Express Cert Based Mutual Auth</h4><div class="text-muted"><p>In this post we’ll look at how to add Certificate Based Mutual Authentication to an express HTTPS server. This will allow us to require a User Certificate before being able to communicate with out ...</p></div></div></a></article><article class="col"> <a href="/posts/websockets-socketio/" class="post-preview card h-100"><div class="card-body"> <time data-ts="1619677982" data-df="ll" > Apr 29, 2021 </time><h4 class="pt-0 my-2">Web-Sockets - Socket.IO</h4><div class="text-muted"><p>This guide will demonstrate how to setup an express webserver that uses Socket.IO for communication. Installing Requirements Backend Code Frontend Code Standard HTML Page R...</p></div></div></a></article><article class="col"> <a href="/posts/nodejs-crypto/" class="post-preview card h-100"><div class="card-body"> <time data-ts="1617698260" data-df="ll" > Apr 6, 2021 </time><h4 class="pt-0 my-2">NodeJS Crypto Module</h4><div class="text-muted"><p>In this post we’ll look at how to use some features of the crypto library built into NodeJS. We’ll look at how to do symmetric encryption (AES), hashing strings and files, and finally ECDH (Ellipti...</p></div></div></a></article></nav></aside><nav class="post-navigation d-flex justify-content-between" aria-label="Post Navigation"> <a href="/posts/javascript-tips-and-tricks-2/" class="btn btn-outline-primary" aria-label="Older" ><p>JavaScript Tips & Tricks 2</p></a> <a href="/posts/express-cert-based-mutual-auth/" class="btn btn-outline-primary" aria-label="Newer" ><p>NodeJS Express Cert Based Mutual Auth</p></a></nav><footer aria-label="Site Info" class=" d-flex flex-column justify-content-center text-muted flex-lg-row justify-content-lg-between align-items-lg-center pb-lg-3 " ><p>© <time>2024</time> <a href="https://twitter.com/todo">Alexander Wells</a>. <span data-bs-toggle="tooltip" data-bs-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author." >Some rights reserved.</span></p><p>Using the <a data-bs-toggle="tooltip" data-bs-placement="top" title="v7.1.1" href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener" >Chirpy</a> theme for <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a>.</p></footer></div></div><div id="search-result-wrapper" class="d-flex justify-content-center d-none"><div class="col-11 content"><div id="search-hints"><section><h2 class="panel-heading">Trending Tags</h2><div class="d-flex flex-wrap mt-3 mb-1 me-3"> <a class="post-tag btn btn-outline-primary" href="/tags/security/">security</a> <a class="post-tag btn btn-outline-primary" href="/tags/javascript/">javascript</a> <a class="post-tag btn btn-outline-primary" href="/tags/cryptography/">cryptography</a> <a class="post-tag btn btn-outline-primary" href="/tags/web/">web</a> <a class="post-tag btn btn-outline-primary" href="/tags/http/">http</a> <a class="post-tag btn btn-outline-primary" href="/tags/https/">https</a> <a class="post-tag btn btn-outline-primary" href="/tags/algorithm/">algorithm</a> <a class="post-tag btn btn-outline-primary" href="/tags/programming/">programming</a> <a class="post-tag btn btn-outline-primary" href="/tags/windows/">windows</a> <a class="post-tag btn btn-outline-primary" href="/tags/nodejs/">nodejs</a></div></section></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><aside aria-label="Scroll to Top"> <button id="back-to-top" type="button" class="btn btn-lg btn-box-shadow"> <i class="fas fa-angle-up"></i> </button></aside></div><div id="mask"></div><aside id="notification" class="toast" role="alert" aria-live="assertive" aria-atomic="true" data-bs-animation="true" data-bs-autohide="false" ><div class="toast-header"> <button type="button" class="btn-close ms-auto" data-bs-dismiss="toast" aria-label="Close" ></button></div><div class="toast-body text-center pt-0"><p class="px-2 mb-3">A new version of content is available.</p><button type="button" class="btn btn-primary" aria-label="Update"> Update </button></div></aside><script src="https://cdn.jsdelivr.net/combine/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js,npm/loading-attribute-polyfill@2.1.1/dist/loading-attribute-polyfill.umd.min.js,npm/glightbox@3.3.0/dist/js/glightbox.min.js,npm/clipboard@2.0.11/dist/clipboard.min.js,npm/dayjs@1.11.13/dayjs.min.js,npm/dayjs@1.11.13/locale/en.js,npm/dayjs@1.11.13/plugin/relativeTime.js,npm/dayjs@1.11.13/plugin/localizedFormat.js,npm/tocbot@4.29.0/dist/tocbot.min.js"></script> <script src="/assets/js/dist/post.min.js"></script> <script defer src="/app.min.js?baseurl=&register=true" ></script> <script>SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<article class="px-1 px-sm-2 px-lg-4 px-xl-0"><header><h2><a href="{url}">{title}</a></h2><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div></header><p>{snippet}</p></article>', noResultsText: '<p class="mt-5">Oops! No results found.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="me-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script>
